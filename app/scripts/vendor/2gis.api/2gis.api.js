/*
 Maps api created at 2GIS. Build on Leaflet.
 (c) 2013-2015, 2GIS
*/

!function(window,document,undefined){function expose(){var t=window.L;L.noConflict=function(){return window.L=t,this},window.L=L}var L={version:"1.0.0-beta.2"};"object"==typeof module&&"object"==typeof module.exports?module.exports=L:"function"==typeof define&&define.amd&&define(L),"undefined"!=typeof window&&expose(),L.Util={extend:function(t){var e,i,n,o;for(i=1,n=arguments.length;n>i;i++){o=arguments[i];for(e in o)t[e]=o[e]}return t},create:Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),bind:function(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}},stamp:function(t){return t._leaflet_id=t._leaflet_id||++L.Util.lastId,t._leaflet_id},lastId:0,throttle:function(t,e,i){var n,o,r,s;return s=function(){n=!1,o&&(r.apply(i,o),o=!1)},r=function(){n?o=arguments:(t.apply(i,arguments),setTimeout(s,e),n=!0)}},wrapNum:function(t,e,i){var n=e[1],o=e[0],r=n-o;return t===n&&i?t:((t-o)%r+r)%r+o},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return L.Util.trim(t).split(/\s+/)},setOptions:function(t,e){t.hasOwnProperty("options")||(t.options=t.options?L.Util.create(t.options):{});for(var i in e)t.options[i]=e[i];return t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,e){return t.replace(L.Util.templateRe,function(t,i){var n=e[i];if(n===undefined)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n})},templateRe:/\{ *([\w_]+) *\}/g,isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},indexOf:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function e(t){var e=+new Date,n=Math.max(0,16-(e-i));return i=e+n,window.setTimeout(t,n)}var i=0,n=window.requestAnimationFrame||t("RequestAnimationFrame")||e,o=window.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};L.Util.requestAnimFrame=function(t,i,o){return o&&n===e?void t.call(i):n.call(window,L.bind(t,i))},L.Util.cancelAnimFrame=function(t){t&&o.call(window,t)}}(),L.extend=L.Util.extend,L.bind=L.Util.bind,L.stamp=L.Util.stamp,L.setOptions=L.Util.setOptions,L.Class=function(){},L.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,n=L.Util.create(i);n.constructor=e,e.prototype=n;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);return t.statics&&(L.extend(e,t.statics),delete t.statics),t.includes&&(L.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),n.options&&(t.options=L.Util.extend(L.Util.create(n.options),t.options)),L.extend(n,t),n._initHooks=[],n.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;e>t;t++)n._initHooks[t].call(this)}},e},L.Class.include=function(t){L.extend(this.prototype,t)},L.Class.mergeOptions=function(t){L.extend(this.prototype.options,t)},L.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i)},L.Evented=L.Class.extend({on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else{t=L.Util.splitWords(t);for(var o=0,r=t.length;r>o;o++)this._on(t[o],e,i)}return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else{t=L.Util.splitWords(t);for(var o=0,r=t.length;r>o;o++)this._off(t[o],e,i)}else delete this._events;return this},_on:function(t,e,i){var n=this._events=this._events||{},o=i&&i!==this&&L.stamp(i);if(o){var r=t+"_idx",s=t+"_len",a=n[r]=n[r]||{},l=L.stamp(e)+"_"+o;a[l]||(a[l]={fn:e,ctx:i},n[s]=(n[s]||0)+1)}else n[t]=n[t]||[],n[t].push({fn:e})},_off:function(t,e,i){var n=this._events,o=t+"_idx",r=t+"_len";if(n){if(!e)return delete n[t],delete n[o],void delete n[r];var s,a,l,u,c,h=i&&i!==this&&L.stamp(i);if(h)c=L.stamp(e)+"_"+h,s=n[o],s&&s[c]&&(u=s[c],delete s[c],n[r]--);else if(s=n[t])for(a=0,l=s.length;l>a;a++)if(s[a].fn===e){u=s[a],s.splice(a,1);break}u&&(u.fn=L.Util.falseFn)}},fire:function(t,e,i){if(!this.listens(t,i))return this;var n=L.Util.extend({},e,{type:t,target:this}),o=this._events;if(o){var r,s,a,l,u=o[t+"_idx"];if(o[t])for(a=o[t].slice(),r=0,s=a.length;s>r;r++)a[r].fn.call(this,n);for(l in u)u[l].fn.call(u[l].ctx,n)}return i&&this._propagateEvent(n),this},listens:function(t,e){var i=this._events;if(i&&(i[t]||i[t+"_len"]))return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var n in t)this.once(n,t[n],e);return this}var o=L.bind(function(){this.off(t,e,i).off(t,o,i)},this);return this.on(t,e,i).on(t,o,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[L.stamp(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[L.stamp(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,L.extend({layer:t.target},t),!0)}});var proto=L.Evented.prototype;proto.addEventListener=proto.on,proto.removeEventListener=proto.clearAllEventListeners=proto.off,proto.addOneTimeEventListener=proto.once,proto.fireEvent=proto.fire,proto.hasEventListeners=proto.listens,L.Mixin={Events:proto},function(){var t=navigator.userAgent.toLowerCase(),e=document.documentElement,i="ActiveXObject"in window,n=-1!==t.indexOf("webkit"),o=-1!==t.indexOf("phantom"),r=-1!==t.search("android [23]"),s=-1!==t.indexOf("chrome"),a=-1!==t.indexOf("gecko")&&!n&&!window.opera&&!i,l="undefined"!=typeof orientation||-1!==t.indexOf("mobile"),u=!window.PointerEvent&&window.MSPointerEvent,c=window.PointerEvent&&navigator.pointerEnabled||u,h=i&&"transition"in e.style,d="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!r,p="MozPerspective"in e.style,_="OTransition"in e.style,m=!window.L_NO_TOUCH&&!o&&(c||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch);L.Browser={ie:i,ielt9:i&&!document.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in document),webkit:n,gecko:a,android:-1!==t.indexOf("android"),android23:r,chrome:s,safari:!s&&-1!==t.indexOf("safari"),ie3d:h,webkit3d:d,gecko3d:p,opera12:_,any3d:!window.L_DISABLE_3D&&(h||d||p)&&!_&&!o,mobile:l,mobileWebkit:l&&n,mobileWebkit3d:l&&d,mobileOpera:l&&window.opera,mobileGecko:l&&a,touch:!!m,msPointer:!!u,pointer:!!c,retina:(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1}}(),L.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},L.Point.prototype={clone:function(){return new L.Point(this.x,this.y)},add:function(t){return this.clone()._add(L.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(L.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new L.Point(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new L.Point(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){t=L.point(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=L.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=L.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+L.Util.formatNum(this.x)+", "+L.Util.formatNum(this.y)+")"}},L.point=function(t,e,i){return t instanceof L.Point?t:L.Util.isArray(t)?new L.Point(t[0],t[1]):t===undefined||null===t?t:new L.Point(t,e,i)},L.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;o>n;n++)this.extend(i[n])},L.Bounds.prototype={extend:function(t){return t=L.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new L.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new L.Point(this.min.x,this.max.y)},getTopRight:function(){return new L.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof L.Point?L.point(t):L.bounds(t),t instanceof L.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=L.bounds(t);var e=this.min,i=this.max,n=t.min,o=t.max,r=o.x>=e.x&&n.x<=i.x,s=o.y>=e.y&&n.y<=i.y;return r&&s},overlaps:function(t){t=L.bounds(t);var e=this.min,i=this.max,n=t.min,o=t.max,r=o.x>e.x&&n.x<i.x,s=o.y>e.y&&n.y<i.y;return r&&s},isValid:function(){return!(!this.min||!this.max)}},L.bounds=function(t,e){return!t||t instanceof L.Bounds?t:new L.Bounds(t,e)},L.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},L.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new L.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},L.DomUtil={get:function(t){return"string"==typeof t?document.getElementById(t):t},getStyle:function(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i},create:function(t,e,i){var n=document.createElement(t);return n.className=e,i&&i.appendChild(n),n},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(t.classList!==undefined)return t.classList.contains(e);var i=L.DomUtil.getClass(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)},addClass:function(t,e){if(t.classList!==undefined)for(var i=L.Util.splitWords(e),n=0,o=i.length;o>n;n++)t.classList.add(i[n]);else if(!L.DomUtil.hasClass(t,e)){var r=L.DomUtil.getClass(t);L.DomUtil.setClass(t,(r?r+" ":"")+e)}},removeClass:function(t,e){t.classList!==undefined?t.classList.remove(e):L.DomUtil.setClass(t,L.Util.trim((" "+L.DomUtil.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){t.className.baseVal===undefined?t.className=e:t.className.baseVal=e},getClass:function(t){return t.className.baseVal===undefined?t.className:t.className.baseVal},setOpacity:function(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&L.DomUtil._setOpacityIE(t,e)},_setOpacityIE:function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(o){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"},testProp:function(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},setTransform:function(t,e,i){var n=e||new L.Point(0,0);t.style[L.DomUtil.TRANSFORM]=(L.Browser.ie3d?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")},setPosition:function(t,e){t._leaflet_pos=e,L.Browser.any3d?L.DomUtil.setTransform(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos||new L.Point(0,0)}},function(){L.DomUtil.TRANSFORM=L.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var t=L.DomUtil.TRANSITION=L.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(L.DomUtil.TRANSITION_END="webkitTransition"===t||"OTransition"===t?t+"End":"transitionend","onselectstart"in document)L.DomUtil.disableTextSelection=function(){L.DomEvent.on(window,"selectstart",L.DomEvent.preventDefault)},L.DomUtil.enableTextSelection=function(){L.DomEvent.off(window,"selectstart",L.DomEvent.preventDefault)};else{var e=L.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);L.DomUtil.disableTextSelection=function(){if(e){var t=document.documentElement.style;this._userSelect=t[e],t[e]="none"}},L.DomUtil.enableTextSelection=function(){e&&(document.documentElement.style[e]=this._userSelect,delete this._userSelect)}}L.DomUtil.disableImageDrag=function(){L.DomEvent.on(window,"dragstart",L.DomEvent.preventDefault)},L.DomUtil.enableImageDrag=function(){L.DomEvent.off(window,"dragstart",L.DomEvent.preventDefault)},L.DomUtil.preventOutline=function(t){for(;-1===t.tabIndex;)t=t.parentNode;t&&t.style&&(L.DomUtil.restoreOutline(),this._outlineElement=t,this._outlineStyle=t.style.outline,t.style.outline="none",L.DomEvent.on(window,"keydown",L.DomUtil.restoreOutline,this))},L.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,L.DomEvent.off(window,"keydown",L.DomUtil.restoreOutline,this))}}(),L.LatLng=function(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,i!==undefined&&(this.alt=+i)},L.LatLng.prototype={equals:function(t,e){if(!t)return!1;t=L.latLng(t);var i=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return(e===undefined?1e-9:e)>=i},toString:function(t){return"LatLng("+L.Util.formatNum(this.lat,t)+", "+L.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){return L.CRS.Earth.distance(this,L.latLng(t))},wrap:function(){return L.CRS.Earth.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return L.latLngBounds([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new L.LatLng(this.lat,this.lng,this.alt)}},L.latLng=function(t,e,i){return t instanceof L.LatLng?t:L.Util.isArray(t)&&"object"!=typeof t[0]?3===t.length?new L.LatLng(t[0],t[1],t[2]):2===t.length?new L.LatLng(t[0],t[1]):null:t===undefined||null===t?t:"object"==typeof t&&"lat"in t?new L.LatLng(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===undefined?null:new L.LatLng(t,e,i)},L.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;o>n;n++)this.extend(i[n])},L.LatLngBounds.prototype={extend:function(t){var e,i,n=this._southWest,o=this._northEast;if(t instanceof L.LatLng)e=t,i=t;else{if(!(t instanceof L.LatLngBounds))return t?this.extend(L.latLng(t)||L.latLngBounds(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||o?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),o.lat=Math.max(i.lat,o.lat),o.lng=Math.max(i.lng,o.lng)):(this._southWest=new L.LatLng(e.lat,e.lng),this._northEast=new L.LatLng(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,o=Math.abs(e.lng-i.lng)*t;return new L.LatLngBounds(new L.LatLng(e.lat-n,e.lng-o),new L.LatLng(i.lat+n,i.lng+o))},getCenter:function(){return new L.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new L.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new L.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof L.LatLng?L.latLng(t):L.latLngBounds(t);var e,i,n=this._southWest,o=this._northEast;return t instanceof L.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=o.lat&&e.lng>=n.lng&&i.lng<=o.lng},intersects:function(t){t=L.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>=e.lat&&n.lat<=i.lat,s=o.lng>=e.lng&&n.lng<=i.lng;return r&&s},overlaps:function(t){t=L.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>e.lat&&n.lat<i.lat,s=o.lng>e.lng&&n.lng<i.lng;return r&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=L.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},L.latLngBounds=function(t,e){return!t||t instanceof L.LatLngBounds?t:new L.LatLngBounds(t,e)},L.Projection={},L.Projection.LonLat={project:function(t){return new L.Point(t.lng,t.lat)},unproject:function(t){return new L.LatLng(t.y,t.x)},bounds:L.bounds([-180,-90],[180,90])},L.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),o=Math.sin(n*e);return new L.Point(this.R*t.lng*e,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(t){var e=180/Math.PI;return new L.LatLng((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return L.bounds([-t,-t],[t,t])}()},L.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t),n=this.transformation.transform(e.min,i),o=this.transformation.transform(e.max,i);return L.bounds(n,o)},wrapLatLng:function(t){var e=this.wrapLng?L.Util.wrapNum(t.lng,this.wrapLng,!0):t.lng,i=this.wrapLat?L.Util.wrapNum(t.lat,this.wrapLat,!0):t.lat,n=t.alt;return L.latLng(i,e,n)}},L.CRS.Simple=L.extend({},L.CRS,{projection:L.Projection.LonLat,transformation:new L.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0}),L.CRS.Earth=L.extend({},L.CRS,{wrapLng:[-180,180],R:6378137,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i,r=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((e.lng-t.lng)*i);return this.R*Math.acos(Math.min(r,1))}}),L.CRS.EPSG3857=L.extend({},L.CRS.Earth,{code:"EPSG:3857",projection:L.Projection.SphericalMercator,transformation:function(){var t=.5/(Math.PI*L.Projection.SphericalMercator.R);return new L.Transformation(t,.5,-t,.5)}()}),L.CRS.EPSG900913=L.extend({},L.CRS.EPSG3857,{code:"EPSG:900913"}),L.CRS.EPSG4326=L.extend({},L.CRS.Earth,{code:"EPSG:4326",projection:L.Projection.LonLat,transformation:new L.Transformation(1/180,1,-1/180,.5)}),L.Map=L.Evented.extend({options:{crs:L.CRS.EPSG3857,fadeAnimation:!0,trackResize:!0,markerZoomAnimation:!0,maxBoundsViscosity:0,transform3DLimit:8388608},initialize:function(t,e){e=L.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=L.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==undefined&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==undefined&&this.setView(L.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._addLayers(this.options.layers)},setView:function(t,e){return e=e===undefined?this.getZoom():e,this._resetView(L.latLng(t),e),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),o=this.getSize().divideBy(2),r=t instanceof L.Point?t:this.latLngToContainerPoint(t),s=r.subtract(o).multiplyBy(1-1/n),a=this.containerPointToLatLng(o.add(s));return this.setView(a,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():L.latLngBounds(t);var i=L.point(e.paddingTopLeft||e.padding||[0,0]),n=L.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,i.add(n));o="number"==typeof e.maxZoom?Math.min(e.maxZoom,o):o;var r=n.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),o),a=this.project(t.getNorthEast(),o),l=this.unproject(s.add(a).divideBy(2).add(r),o);return{center:l,zoom:o}},fitBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(L.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return(t=L.latLngBounds(t))?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):this.off("moveend",this._panInsideMaxBounds)},setMinZoom:function(t){return this.options.minZoom=t,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(t):this},setMaxZoom:function(t){return this.options.maxZoom=t,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,L.latLngBounds(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=L.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),o=i.divideBy(2).round(),r=n.subtract(o);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(L.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return L.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){this._initEvents(!0);try{delete this._container._leaflet}catch(t){this._container._leaflet=undefined}L.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");for(var e in this._layers)this._layers[e].remove();return this},createPane:function(t,e){var i="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),n=L.DomUtil.create("div",i,e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new L.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===undefined?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===undefined?this._layersMaxZoom===undefined?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=L.latLngBounds(t);var n,o=this.getMinZoom()-(e?1:0),r=this.getMaxZoom(),s=this.getSize(),a=t.getNorthWest(),l=t.getSouthEast(),u=!0;i=L.point(i||[0,0]);do o++,n=this.project(l,o).subtract(this.project(a,o)).add(i).floor(),u=e?n.x<s.x||n.y<s.y:s.contains(n);while(u&&r>=o);return u&&e?null:e?o:o-1},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new L.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new L.Bounds(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===undefined?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=e===undefined?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;return e=e===undefined?this._zoom:e,i.zoom(t*i.scale(e))},project:function(t,e){return e=e===undefined?this._zoom:e,this.options.crs.latLngToPoint(L.latLng(t),e)},unproject:function(t,e){return e=e===undefined?this._zoom:e,this.options.crs.pointToLatLng(L.point(t),e)},layerPointToLatLng:function(t){var e=L.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(L.latLng(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(L.latLng(t))},distance:function(t,e){return this.options.crs.distance(L.latLng(t),L.latLng(e))},containerPointToLayerPoint:function(t){return L.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return L.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(L.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(t)))},mouseEventToContainerPoint:function(t){return L.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=L.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");L.DomEvent.addListener(e,"scroll",this._onScroll,this),e._leaflet=!0},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&L.Browser.any3d,L.DomUtil.addClass(t,"leaflet-container"+(L.Browser.touch?" leaflet-touch":"")+(L.Browser.retina?" leaflet-retina":"")+(L.Browser.ielt9?" leaflet-oldie":"")+(L.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=L.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),L.DomUtil.setPosition(this._mapPane,new L.Point(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(L.DomUtil.addClass(t.markerPane,"leaflet-zoom-hide"),L.DomUtil.addClass(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){L.DomUtil.setPosition(this._mapPane,new L.Point(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e);var n=this._zoom!==e;this._moveStart(n)._move(t,e)._moveEnd(n),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t){return t&&this.fire("zoomstart"),this.fire("movestart")},_move:function(t,e,i){e===undefined&&(e=this._zoom);var n=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),n&&this.fire("zoom",i),this.fire("move",i)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_rawPanBy:function(t){L.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){if(L.DomEvent){this._targets={},this._targets[L.stamp(this._container)]=this;var e=t?"off":"on";L.DomEvent[e](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&L.DomEvent[e](window,"resize",this._onResize,this),L.Browser.any3d&&this.options.transform3DLimit&&this[e]("moveend",this._onMoveEnd)}},_onResize:function(){L.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=L.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,n=[],o="mouseout"===e||"mouseover"===e,r=t.target||t.srcElement,s=!1;r;){if(i=this._targets[L.stamp(r)],i&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){s=!0;break}if(i&&i.listens(e,!0)){if(o&&!L.DomEvent._isExternalTarget(r,t))break;if(n.push(i),o)break}if(r===this._container)break;r=r.parentNode}return n.length||s||o||!L.DomEvent._isExternalTarget(r,t)||(n=[this]),n},_handleDOMEvent:function(t){if(this._loaded&&!L.DomEvent._skipped(t)){var e="keypress"===t.type&&13===t.keyCode?"click":t.type;if("click"===t.type){var i=L.Util.extend({},t);i.type="preclick",this._handleDOMEvent(i)}"mousedown"===e&&L.DomUtil.preventOutline(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_fireDOMEvent:function(t,e,i){if(!t._stopped&&(i=(i||[]).concat(this._findEventTargets(t,e)),i.length)){var n=i[0];"contextmenu"===e&&n.listens(e,!0)&&L.DomEvent.preventDefault(t);var o={originalEvent:t};if("keypress"!==t.type){var r=n instanceof L.Marker;o.containerPoint=r?this.latLngToContainerPoint(n.getLatLng()):this.mouseEventToContainerPoint(t),o.layerPoint=this.containerPointToLayerPoint(o.containerPoint),o.latlng=r?n.getLatLng():this.layerPointToLatLng(o.layerPoint)}for(var s=0;s<i.length;s++)if(i[s].fire(e,o,!0),o.originalEvent._stopped||i[s].options.nonBubblingEvents&&-1!==L.Util.indexOf(i[s].options.nonBubblingEvents,e))return}},_draggableMoved:function(t){return t=t.options.draggable?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable();
},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return L.DomUtil.getPosition(this._mapPane)||new L.Point(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var i=t&&e!==undefined?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return i.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),o=this.getSize().divideBy(2),r=new L.Bounds(n.subtract(o),n.add(o)),s=this._getBoundsOffset(r,i,e);return s.round().equals([0,0])?t:this.unproject(n.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new L.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=L.bounds(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),o=n.min.subtract(t.min),r=n.max.subtract(t.max),s=this._rebound(o.x,-r.x),a=this._rebound(o.y,-r.y);return new L.Point(s,a)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom();return L.Browser.any3d||(t=Math.round(t)),Math.max(e,Math.min(i,t))}}),L.map=function(t,e){return new L.Map(t,e)},L.Layer=L.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[]},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[L.stamp(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[L.stamp(t)],this},_layerAdd:function(t){var e=t.target;e.hasLayer(this)&&(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents&&e.on(this.getEvents(),this),this.onAdd(e),this.getAttribution&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this}))}}),L.Map.include({addLayer:function(t){var e=L.stamp(t);return this._layers[e]?t:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=L.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),t.getEvents&&this.off(t.getEvents(),t),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&L.stamp(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){t=t?L.Util.isArray(t)?t:[t]:[];for(var e=0,i=t.length;i>e;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[L.stamp(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=L.stamp(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-(1/0),i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var o=this._zoomBoundLayers[n].options;t=o.minZoom===undefined?t:Math.min(t,o.minZoom),e=o.maxZoom===undefined?e:Math.max(e,o.maxZoom)}this._layersMaxZoom=e===-(1/0)?undefined:e,this._layersMinZoom=t===1/0?undefined:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange")}}),L.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:L.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,o=this.R_MINOR/i,r=Math.sqrt(1-o*o),s=r*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-s)/(1+s),r/2);return n=-i*Math.log(Math.max(a,1e-10)),new L.Point(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,o=this.R_MINOR/n,r=Math.sqrt(1-o*o),s=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(s),l=0,u=.1;15>l&&Math.abs(u)>1e-7;l++)e=r*Math.sin(a),e=Math.pow((1-e)/(1+e),r/2),u=Math.PI/2-2*Math.atan(s*e)-a,a+=u;return new L.LatLng(a*i,t.x*i/n)}},L.CRS.EPSG3395=L.extend({},L.CRS.Earth,{code:"EPSG:3395",projection:L.Projection.Mercator,transformation:function(){var t=.5/(Math.PI*L.Projection.Mercator.R);return new L.Transformation(t,.5,-t,.5)}()}),L.GridLayer=L.Layer.extend({options:{pane:"tilePane",tileSize:256,opacity:1,zIndex:1,updateWhenIdle:L.Browser.mobile,updateInterval:200,attribution:null,bounds:null,minZoom:0},initialize:function(t){t=L.setOptions(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),L.DomUtil.remove(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(L.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(L.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewreset:this._resetAll,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=L.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof L.Point?t:new L.Point(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==undefined&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-(1/0),1/0),o=0,r=i.length;r>o;o++)e=i[o].style.zIndex,i[o]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!L.Browser.ielt9&&this._map._fadeAnimated){L.DomUtil.setOpacity(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var o=this._tiles[n];if(o.current&&o.loaded){var r=Math.min(1,(t-o.loaded)/200);L.DomUtil.setOpacity(o.el,r),1>r?e=!0:(o.active&&(i=!0),o.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(L.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=L.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=L.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t===undefined)return undefined;for(var i in this._levels)this._levels[i].el.children.length||i===t?this._levels[i].el.style.zIndex=e-Math.abs(t-i):(L.DomUtil.remove(this._levels[i].el),this._removeTilesAtZoom(i),delete this._levels[i]);var n=this._levels[t],o=this._map;return n||(n=this._levels[t]={},n.el=L.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=e,n.origin=o.project(o.unproject(o.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,o.getCenter(),o.getZoom()),L.Util.falseFn(n.el.offsetWidth)),this._level=n,n},_pruneTiles:function(){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)return this._removeAllTiles();for(t in this._tiles)e=this._tiles[t],e.retain=e.current;for(t in this._tiles)if(e=this._tiles[t],e.current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_resetAll:function(){for(var t in this._levels)L.DomUtil.remove(this._levels[t].el),delete this._levels[t];this._removeAllTiles(),this._tileZoom=null,this._resetView()},_retainParent:function(t,e,i,n){var o=Math.floor(t/2),r=Math.floor(e/2),s=i-1,a=new L.Point(+o,+r);a.z=+s;var l=this._tileCoordsToKey(a),u=this._tiles[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),s>n?this._retainParent(o,r,s,n):!1)},_retainChildren:function(t,e,i,n){for(var o=2*t;2*t+2>o;o++)for(var r=2*e;2*e+2>r;r++){var s=new L.Point(o,r);s.z=i+1;var a=this._tileCoordsToKey(s),l=this._tiles[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n>i+1&&this._retainChildren(o,r,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_setView:function(t,e,i,n){var o=Math.round(e);(this.options.maxZoom!==undefined&&o>this.options.maxZoom||this.options.minZoom!==undefined&&o<this.options.minZoom)&&(o=undefined);var r=o!==this._tileZoom;n&&!r||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),o!==undefined&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),o=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();L.Browser.any3d?L.DomUtil.setTransform(t.el,o,n):L.DomUtil.setPosition(t.el,o)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._resetView()},_getTiledPixelBounds:function(t){var e=this._map,i=e.getZoomScale(e.getZoom(),this._tileZoom),n=e.project(t,this._tileZoom).floor(),o=e.getSize().divideBy(2*i);return new L.Bounds(n.subtract(o),n.add(o))},_update:function(t){var e=this._map;if(e){var i=e.getZoom();if(t===undefined&&(t=e.getCenter()),this._tileZoom!==undefined){var n=this._getTiledPixelBounds(t),o=this._pxBoundsToTileRange(n),r=o.getCenter(),s=[];for(var a in this._tiles)this._tiles[a].current=!1;if(Math.abs(i-this._tileZoom)>1)return void this._setView(t,i);for(var l=o.min.y;l<=o.max.y;l++)for(var u=o.min.x;u<=o.max.x;u++){var c=new L.Point(u,l);if(c.z=this._tileZoom,this._isValidTile(c)){var h=this._tiles[this._tileCoordsToKey(c)];h?h.current=!0:s.push(c)}}if(s.sort(function(t,e){return t.distanceTo(r)-e.distanceTo(r)}),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var d=document.createDocumentFragment();for(u=0;u<s.length;u++)this._addTile(s[u],d);this._level.el.appendChild(d)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return L.latLngBounds(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToBounds:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),o=n.add(i),r=e.wrapLatLng(e.unproject(n,t.z)),s=e.wrapLatLng(e.unproject(o,t.z));return new L.LatLngBounds(r,s)},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new L.Point(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(L.DomUtil.remove(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){L.DomUtil.addClass(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=L.Util.falseFn,t.onmousemove=L.Util.falseFn,L.Browser.ielt9&&this.options.opacity<1&&L.DomUtil.setOpacity(t,this.options.opacity),L.Browser.android&&!L.Browser.android23&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t),n=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),L.bind(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&L.Util.requestAnimFrame(L.bind(this._tileReady,this,t,null,o)),L.DomUtil.setPosition(o,i),this._tiles[n]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,i){if(this._map){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var n=this._tileCoordsToKey(t);i=this._tiles[n],i&&(i.loaded=+new Date,this._map._fadeAnimated?(L.DomUtil.setOpacity(i.el,0),L.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=L.Util.requestAnimFrame(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),L.DomUtil.addClass(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t}),this._noTilesToLoad()&&(this._loading=!1,this.fire("load")))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new L.Point(this._wrapX?L.Util.wrapNum(t.x,this._wrapX):t.x,this._wrapY?L.Util.wrapNum(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new L.Bounds(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),L.gridLayer=function(t){return new L.GridLayer(t)},L.TileLayer=L.GridLayer.extend({options:{maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,maxNativeZoom:null,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,e=L.setOptions(this,e),e.detectRetina&&L.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom=Math.max(0,e.minZoom),e.maxZoom--),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),L.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return L.DomEvent.on(i,"load",L.bind(this._tileOnLoad,this,e,i)),L.DomEvent.on(i,"error",L.bind(this._tileOnError,this,e,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",i.src=this.getTileUrl(t),i},getTileUrl:function(t){return L.Util.template(this._url,L.extend({r:L.Browser.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:this.options.tms?this._globalTileRange.max.y-t.y:t.y,z:this._getZoomForUrl()},this.options))},_tileOnLoad:function(t,e){L.Browser.ielt9?setTimeout(L.bind(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&(e.src=n),t(i,e)},getTileSize:function(){var t=this._map,e=L.GridLayer.prototype.getTileSize.call(this),i=this._tileZoom+this.options.zoomOffset,n=this.options.maxNativeZoom;return null!==n&&i>n?e.divideBy(t.getZoomScale(n,i)).round():e},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this.options,e=this._tileZoom;return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,null!==t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&(e=this._tiles[t].el,e.onload=L.Util.falseFn,e.onerror=L.Util.falseFn,e.complete||(e.src=L.Util.emptyImageUrl,L.DomUtil.remove(e)))}}),L.tileLayer=function(t,e){return new L.TileLayer(t,e)},L.TileLayer.WMS=L.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=L.extend({},this.defaultWmsParams);for(var n in e)n in this.options||(i[n]=e[n]);e=L.setOptions(this,e),i.width=i.height=e.tileSize*(e.detectRetina&&L.Browser.retina?2:1),this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,L.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToBounds(t),i=this._crs.project(e.getNorthWest()),n=this._crs.project(e.getSouthEast()),o=(this._wmsVersion>=1.3&&this._crs===L.CRS.EPSG4326?[n.y,i.x,i.y,n.x]:[i.x,n.y,n.x,i.y]).join(","),r=L.TileLayer.prototype.getTileUrl.call(this,t);return r+L.Util.getParamString(this.wmsParams,r,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+o},setParams:function(t,e){return L.extend(this.wmsParams,t),e||this.redraw(),this}}),L.tileLayer.wms=function(t,e){return new L.TileLayer.WMS(t,e)},L.ImageOverlay=L.Layer.extend({options:{opacity:1,alt:"",interactive:!1},initialize:function(t,e,i){this._url=t,this._bounds=L.latLngBounds(e),L.setOptions(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(L.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){L.DomUtil.remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&L.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&L.DomUtil.toBack(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=t,this._map&&this._reset(),this},getAttribution:function(){return this.options.attribution},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._image=L.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));t.onselectstart=L.Util.falseFn,t.onmousemove=L.Util.falseFn,t.onload=L.bind(this.fire,this,"load"),this.options.crossOrigin&&(t.crossOrigin=""),t.src=this._url,t.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(),t.zoom,t.center);L.DomUtil.setTransform(this._image,i,e)},_reset:function(){var t=this._image,e=new L.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();L.DomUtil.setPosition(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){L.DomUtil.setOpacity(this._image,this.options.opacity)}}),L.imageOverlay=function(t,e,i){return new L.ImageOverlay(t,e,i)},L.Icon=L.Class.extend({initialize:function(t){L.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=L.point(i[e+"Size"]),o=L.point("shadow"===e&&i.shadowAnchor||i.iconAnchor||n&&n.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),n&&(t.style.width=n.x+"px",t.style.height=n.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return L.Browser.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),L.icon=function(t){return new L.Icon(t)},L.Icon.Default=L.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];var i=L.Icon.Default.imagePath;if(!i)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return i+"/marker-"+t+(L.Browser.retina&&"icon"===t?"-2x":"")+".png"}}),L.Icon.Default.imagePath=function(){var t,e,i,n,o=document.getElementsByTagName("script"),r=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=o.length;e>t;t++)if(i=o[t].src||"",i.match(r))return n=i.split(r)[0],(n?n+"/":"")+"images"}(),L.Marker=L.Layer.extend({options:{pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"],icon:new L.Icon.Default,interactive:!0,keyboard:!0,zIndexOffset:0,opacity:1,riseOffset:250},initialize:function(t,e){L.setOptions(this,e),this._latlng=L.latLng(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._initIcon(),this.update()},onRemove:function(){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),this._removeIcon(),this._removeShadow()},getEvents:function(){var t={zoom:this.update,viewreset:this.update};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=L.latLng(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),t.alt&&(i.alt=t.alt)),L.DomUtil.addClass(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var o=t.icon.createShadow(this._shadow),r=!1;o!==this._shadow&&(this._removeShadow(),r=!0),o&&L.DomUtil.addClass(o,e),this._shadow=o,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&r&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),L.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&L.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(t){L.DomUtil.setPosition(this._icon,t),this._shadow&&L.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(L.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),L.Handler.MarkerDrag)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new L.Handler.MarkerDrag(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;L.DomUtil.setOpacity(this._icon,t),this._shadow&&L.DomUtil.setOpacity(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),L.marker=function(t,e){return new L.Marker(t,e)},L.DivIcon=L.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;if(e.innerHTML=i.html!==!1?i.html:"",i.bgPos){var n=L.point(i.bgPos);e.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),L.divIcon=function(t){return new L.DivIcon(t)},L.Map.mergeOptions({closePopupOnClick:!0}),L.Popup=L.Layer.extend({options:{pane:"popupPane",minWidth:50,maxWidth:300,offset:[0,7],autoPan:!0,autoPanPadding:[5,5],closeButton:!0,autoClose:!0,zoomAnimation:!0},initialize:function(t,e){L.setOptions(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&this.options.zoomAnimation,this._container||this._initLayout(),t._fadeAnimated&&L.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&L.DomUtil.setOpacity(this._container,1),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source.on("preclick",L.DomEvent.stopPropagation))},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._fadeAnimated?(L.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(L.bind(L.DomUtil.remove,L.DomUtil,this._container),200)):L.DomUtil.remove(this._container),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source.off("preclick",L.DomEvent.stopPropagation))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=L.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&L.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&L.DomUtil.toBack(this._container),this},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=L.DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"));if(this.options.closeButton){var i=this._closeButton=L.DomUtil.create("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",L.DomEvent.on(i,"click",this._onCloseButtonClick,this)}var n=this._wrapper=L.DomUtil.create("div",t+"-content-wrapper",e);this._contentNode=L.DomUtil.create("div",t+"-content",n),L.DomEvent.disableClickPropagation(n).disableScrollPropagation(this._contentNode).on(n,"contextmenu",L.DomEvent.stopPropagation),this._tipContainer=L.DomUtil.create("div",t+"-tip-container",e),this._tip=L.DomUtil.create("div",t+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&n>o?(e.height=o+"px",L.DomUtil.addClass(t,r)):L.DomUtil.removeClass(t,r),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=L.point(this.options.offset);this._zoomAnimated?L.DomUtil.setPosition(this._container,t):e=e.add(t);var i=this._containerBottom=-e.y,n=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=n+"px"}},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);L.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=this._container.offsetHeight,i=this._containerWidth,n=new L.Point(this._containerLeft,-e-this._containerBottom);this._zoomAnimated&&n._add(L.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(n),r=L.point(this.options.autoPanPadding),s=L.point(this.options.autoPanPaddingTopLeft||r),a=L.point(this.options.autoPanPaddingBottomRight||r),l=t.getSize(),u=0,c=0;o.x+i+a.x>l.x&&(u=o.x+i-l.x+a.x),o.x-u-s.x<0&&(u=o.x-s.x),o.y+e+a.y>l.y&&(c=o.y+e-l.y+a.y),o.y-c-s.y<0&&(c=o.y-s.y),(u||c)&&t.fire("autopanstart").panBy([u,c])}},_onCloseButtonClick:function(t){this._close(),L.DomEvent.stop(t)}}),L.popup=function(t,e){return new L.Popup(t,e)},L.Map.include({openPopup:function(t,e,i){return t instanceof L.Popup||(t=new L.Popup(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),L.Layer.include({bindPopup:function(t,e){return t instanceof L.Popup?(L.setOptions(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new L.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this._originalPopupOffset=this._popup.options.offset,this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof L.Layer||(e=t,t=this),t instanceof L.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup.options.offset=this._popupAnchor(t),this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),
this},isPopupOpen:function(){return this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;if(this._popup&&this._map)return e instanceof L.Path?void this.openPopup(t.layer||t.target,t.latlng):void(this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_popupAnchor:function(t){var e=t._getPopupAnchor?t._getPopupAnchor():[0,0],i=this._originalPopupOffset||L.Popup.prototype.options.offset;return L.point(e).add(i)},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),L.Marker.include({_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]}}),L.LayerGroup=L.Layer.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;i>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return L.stamp(t)}}),L.layerGroup=function(t){return new L.LayerGroup(t)},L.FeatureGroup=L.LayerGroup.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),L.LayerGroup.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),L.LayerGroup.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new L.LatLngBounds;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),L.featureGroup=function(t){return new L.FeatureGroup(t)},L.Renderer=L.Layer.extend({options:{padding:.1},initialize:function(t){L.setOptions(this,t),L.stamp(this)},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&L.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update()},onRemove:function(){L.DomUtil.remove(this._container)},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=L.DomUtil.getPosition(this._container),o=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,e),s=this._map.project(t,e),a=s.subtract(r),l=o.multiplyBy(-i).add(n).add(o).subtract(a);L.DomUtil.setTransform(this._container,l,i)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom)},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new L.Bounds(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),L.Map.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&L.canvas()||L.svg()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||t===undefined)return!1;var e=this._paneRenderers[t];return e===undefined&&(e=L.SVG&&L.svg({pane:t})||L.Canvas&&L.canvas({pane:t}),this._paneRenderers[t]=e),e}}),L.Path=L.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},getEvents:function(){return{zoomend:this._project,moveend:this._update,viewreset:this._reset}},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return L.setOptions(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(L.Browser.touch?10:0)}}),L.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var i=t.length,n=typeof Uint8Array!=undefined+""?Uint8Array:Array,o=new n(i);o[0]=o[i-1]=1,this._simplifyDPStep(t,o,e,0,i-1);var r,s=[];for(r=0;i>r;r++)o[r]&&s.push(t[r]);return s},_simplifyDPStep:function(t,e,i,n,o){var r,s,a,l=0;for(s=n+1;o-1>=s;s++)a=this._sqClosestPointOnSegment(t[s],t[n],t[o],!0),a>l&&(r=s,l=a);l>i&&(e[r]=1,this._simplifyDPStep(t,e,i,n,r),this._simplifyDPStep(t,e,i,r,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,r=t.length;r>n;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return r-1>o&&i.push(t[r-1]),i},clipSegment:function(t,e,i,n,o){var r,s,a,l=n?this._lastCode:this._getBitCode(t,i),u=this._getBitCode(e,i);for(this._lastCode=u;;){if(!(l|u))return[t,e];if(l&u)return!1;r=l||u,s=this._getEdgeIntersection(t,e,r,i,o),a=this._getBitCode(s,i),r===l?(t=s,l=a):(e=s,u=a)}},_getEdgeIntersection:function(t,e,i,n,o){var r,s,a=e.x-t.x,l=e.y-t.y,u=n.min,c=n.max;return 8&i?(r=t.x+a*(c.y-t.y)/l,s=c.y):4&i?(r=t.x+a*(u.y-t.y)/l,s=u.y):2&i?(r=c.x,s=t.y+l*(c.x-t.x)/a):1&i&&(r=u.x,s=t.y+l*(u.x-t.x)/a),new L.Point(r,s,o)},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var o,r=e.x,s=e.y,a=i.x-r,l=i.y-s,u=a*a+l*l;return u>0&&(o=((t.x-r)*a+(t.y-s)*l)/u,o>1?(r=i.x,s=i.y):o>0&&(r+=a*o,s+=l*o)),a=t.x-r,l=t.y-s,n?a*a+l*l:new L.Point(r,s)}},L.Polyline=L.Path.extend({options:{smoothFactor:1},initialize:function(t,e){L.setOptions(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,o=null,r=L.LineUtil._sqClosestPointOnSegment,s=0,a=this._parts.length;a>s;s++)for(var l=this._parts[s],u=1,c=l.length;c>u;u++){e=l[u-1],i=l[u];var h=r(t,e,i,!0);n>h&&(n=h,o=r(t,e,i))}return o&&(o.distance=Math.sqrt(n)),o},getCenter:function(){var t,e,i,n,o,r,s,a=this._rings[0],l=a.length;if(!l)return null;for(t=0,e=0;l-1>t;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,n=0;l-1>t;t++)if(o=a[t],r=a[t+1],i=o.distanceTo(r),n+=i,n>e)return s=(n-e)/i,this._map.layerPointToLatLng([r.x-s*(r.x-o.x),r.y-s*(r.y-o.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=L.latLng(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new L.LatLngBounds,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=L.Polyline._flat(t),n=0,o=t.length;o>n;n++)i?(e[n]=L.latLng(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new L.Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),i=new L.Point(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(i),t.max._add(i),this._pxBounds=t)},_projectLatlngs:function(t,e,i){var n,o,r=t[0]instanceof L.LatLng,s=t.length;if(r){for(o=[],n=0;s>n;n++)o[n]=this._map.latLngToLayerPoint(t[n]),i.extend(o[n]);e.push(o)}else for(n=0;s>n;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);var e,i,n,o,r,s,a,l=this._parts;for(e=0,n=0,o=this._rings.length;o>e;e++)for(a=this._rings[e],i=0,r=a.length;r-1>i;i++)s=L.LineUtil.clipSegment(a[i],a[i+1],t,i,!0),s&&(l[n]=l[n]||[],l[n].push(s[0]),s[1]===a[i+1]&&i!==r-2||(l[n].push(s[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;n>i;i++)t[i]=L.LineUtil.simplify(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),L.polyline=function(t,e){return new L.Polyline(t,e)},L.Polyline._flat=function(t){return!L.Util.isArray(t[0])||"object"!=typeof t[0][0]&&"undefined"!=typeof t[0][0]},L.PolyUtil={},L.PolyUtil.clipPolygon=function(t,e,i){var n,o,r,s,a,l,u,c,h,d=[1,4,2,8],p=L.LineUtil;for(o=0,u=t.length;u>o;o++)t[o]._code=p._getBitCode(t[o],e);for(s=0;4>s;s++){for(c=d[s],n=[],o=0,u=t.length,r=u-1;u>o;r=o++)a=t[o],l=t[r],a._code&c?l._code&c||(h=p._getEdgeIntersection(l,a,c,e,i),h._code=p._getBitCode(h,e),n.push(h)):(l._code&c&&(h=p._getEdgeIntersection(l,a,c,e,i),h._code=p._getBitCode(h,e),n.push(h)),n.push(a));t=n}return t},L.Polygon=L.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){var t,e,i,n,o,r,s,a,l,u=this._rings[0],c=u.length;if(!c)return null;for(r=s=a=0,t=0,e=c-1;c>t;e=t++)i=u[t],n=u[e],o=i.y*n.x-n.y*i.x,s+=(i.x+n.x)*o,a+=(i.y+n.y)*o,r+=3*o;return l=0===r?u[0]:[s/r,a/r],this._map.layerPointToLatLng(l)},_convertLatLngs:function(t){var e=L.Polyline.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof L.LatLng&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){L.Polyline.prototype._setLatLngs.call(this,t),L.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return L.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new L.Point(e,e);if(t=new L.Bounds(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);for(var n,o=0,r=this._rings.length;r>o;o++)n=L.PolyUtil.clipPolygon(this._rings[o],t,!0),n.length&&this._parts.push(n)}},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),L.polygon=function(t,e){return new L.Polygon(t,e)},L.Rectangle=L.Polygon.extend({initialize:function(t,e){L.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=L.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),L.rectangle=function(t,e){return new L.Rectangle(t,e)},L.CircleMarker=L.Path.extend({options:{fill:!0,radius:10},initialize:function(t,e){L.setOptions(this,e),this._latlng=L.latLng(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=L.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return L.Path.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new L.Bounds(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),L.circleMarker=function(t,e){return new L.CircleMarker(t,e)},L.Circle=L.CircleMarker.extend({initialize:function(t,e){L.setOptions(this,e),this._latlng=L.latLng(t),this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new L.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:L.Path.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===L.CRS.Earth.distance){var o=Math.PI/180,r=this._mRadius/L.CRS.Earth.R/o,s=i.project([e+r,t]),a=i.project([e-r,t]),l=s.add(a).divideBy(2),u=i.unproject(l).lat,c=Math.acos((Math.cos(r*o)-Math.sin(e*o)*Math.sin(u*o))/(Math.cos(e*o)*Math.cos(u*o)))/o;(isNaN(c)||0===c)&&(c=r/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(c)?0:Math.max(Math.round(l.x-i.project([u,t-c]).x),1),this._radiusY=Math.max(Math.round(l.y-s.y),1)}else{var h=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(h).x}this._updateBounds()}}),L.circle=function(t,e,i){return"number"==typeof e&&(e=L.extend({},i,{radius:e})),new L.Circle(t,e)},L.SVG=L.Renderer.extend({getEvents:function(){var t=L.Renderer.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=L.SVG.create("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=L.SVG.create("g"),this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){L.Renderer.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),L.DomUtil.setPosition(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" "))}},_initPath:function(t){var e=t._path=L.SVG.create("path");t.options.className&&L.DomUtil.addClass(e,t.options.className),t.options.interactive&&L.DomUtil.addClass(e,"leaflet-interactive"),this._updateStyle(t)},_addPath:function(t){this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){L.DomUtil.remove(t._path),t.removeInteractiveTarget(t._path)},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"),e.setAttribute("pointer-events",i.pointerEvents||(i.interactive?"visiblePainted":"none")))},_updatePoly:function(t,e){this._setPath(t,L.SVG.pointsToPath(t._parts,e))},_updateCircle:function(t){var e=t._point,i=t._radius,n=t._radiusY||i,o="a"+i+","+n+" 0 1,0 ",r=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+o+2*i+",0 "+o+2*-i+",0 ";this._setPath(t,r)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){L.DomUtil.toFront(t._path)},_bringToBack:function(t){L.DomUtil.toBack(t._path)}}),L.extend(L.SVG,{create:function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)},pointsToPath:function(t,e){var i,n,o,r,s,a,l="";for(i=0,o=t.length;o>i;i++){for(s=t[i],n=0,r=s.length;r>n;n++)a=s[n],l+=(n?"L":"M")+a.x+" "+a.y;l+=e?L.Browser.svg?"z":"x":""}return l||"M0 0"}}),L.Browser.svg=!(!document.createElementNS||!L.SVG.create("svg").createSVGRect),L.svg=function(t){return L.Browser.svg||L.Browser.vml?new L.SVG(t):null},L.Browser.vml=!L.Browser.svg&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(i){return!1}}(),L.SVG.include(L.Browser.vml?{_initContainer:function(){this._container=L.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||L.Renderer.prototype._update.call(this)},_initPath:function(t){var e=t._container=L.SVG.create("shape");L.DomUtil.addClass(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=L.SVG.create("path"),e.appendChild(t._path),this._updateStyle(t)},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;L.DomUtil.remove(e),t.removeInteractiveTarget(e)},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,o=t._container;o.stroked=!!n.stroke,o.filled=!!n.fill,n.stroke?(e||(e=t._stroke=L.SVG.create("stroke")),o.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=L.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(o.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=L.SVG.create("fill")),o.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(o.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){L.DomUtil.toFront(t._container)},_bringToBack:function(t){L.DomUtil.toBack(t._container)}}:{}),L.Browser.vml&&(L.SVG.create=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),L.Canvas=L.Renderer.extend({onAdd:function(){L.Renderer.prototype.onAdd.call(this),this._layers=this._layers||{},this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");L.DomEvent.on(t,"mousemove",L.Util.throttle(this._onMouseMove,32,this),this).on(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},L.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=L.Browser.retina?2:1;L.DomUtil.setPosition(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",L.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y)}},_initPath:function(t){this._layers[L.stamp(t)]=t},_addPath:L.Util.falseFn,_removePath:function(t){t._removed=!0,this._requestRedraw(t)},_updatePath:function(t){this._redrawBounds=t._pxBounds,this._draw(!0),t._project(),t._update(),this._draw(),this._redrawBounds=null},_updateStyle:function(t){this._requestRedraw(t)},_requestRedraw:function(t){if(this._map){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new L.Bounds,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e])),this._redrawRequest=this._redrawRequest||L.Util.requestAnimFrame(this._redraw,this)}},_redraw:function(){this._redrawRequest=null,this._draw(!0),this._draw(),this._redrawBounds=null},_draw:function(t){this._clear=t;var e,i=this._redrawBounds;this._ctx.save(),i&&(this._ctx.beginPath(),this._ctx.rect(i.min.x,i.min.y,i.max.x-i.min.x,i.max.y-i.min.y),this._ctx.clip());for(var n in this._layers)e=this._layers[n],i&&!e._pxBounds.intersects(i)||e._updatePath(),t&&e._removed&&(delete e._removed,delete this._layers[n]);this._ctx.restore()},_updatePoly:function(t,e){var i,n,o,r,s=t._parts,a=s.length,l=this._ctx;if(a){for(this._drawnLayers[t._leaflet_id]=t,l.beginPath(),i=0;a>i;i++){for(n=0,o=s[i].length;o>n;n++)r=s[i][n],l[n?"lineTo":"moveTo"](r.x,r.y);e&&l.closePath()}this._fillStroke(l,t)}},_updateCircle:function(t){if(!t._empty()){var e=t._point,i=this._ctx,n=t._radius,o=(t._radiusY||n)/n;this._drawnLayers[t._leaflet_id]=t,1!==o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!==o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=this._clear,n=e.options;t.globalCompositeOperation=i?"destination-out":"source-over",n.fill&&(t.globalAlpha=i?1:n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.globalAlpha=i?1:n.opacity,e._prevWeight=t.lineWidth=i?e._prevWeight+1:n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){var e,i=this._map.mouseEventToLayerPoint(t),n=[];for(var o in this._layers)e=this._layers[o],e.options.interactive&&e._containsPoint(i)&&(L.DomEvent._fakeStop(t),n.push(e));n.length&&this._fireEvent(n,t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseOut(t,e),this._handleMouseHover(t,e)}},_handleMouseOut:function(t,e){var i=this._hoveredLayer;!i||"mouseout"!==t.type&&i._containsPoint(e)||(L.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){var i,n;for(i in this._drawnLayers)n=this._drawnLayers[i],n.options.interactive&&n._containsPoint(e)&&(L.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n);this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:L.Util.falseFn,_bringToBack:L.Util.falseFn}),L.Browser.canvas=function(){return!!document.createElement("canvas").getContext}(),L.canvas=function(t){return L.Browser.canvas?new L.Canvas(t):null},L.Polyline.prototype._containsPoint=function(t,e){var i,n,o,r,s,a,l=this._clickTolerance();if(!this._pxBounds.contains(t))return!1;for(i=0,r=this._parts.length;r>i;i++)for(a=this._parts[i],n=0,s=a.length,o=s-1;s>n;o=n++)if((e||0!==n)&&L.LineUtil.pointToSegmentDistance(t,a[o],a[n])<=l)return!0;return!1},L.Polygon.prototype._containsPoint=function(t){var e,i,n,o,r,s,a,l,u=!1;if(!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;a>o;o++)for(e=this._parts[o],r=0,l=e.length,s=l-1;l>r;s=r++)i=e[r],n=e[s],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(u=!u);return u||L.Polyline.prototype._containsPoint.call(this,t,!0)},L.CircleMarker.prototype._containsPoint=function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()},L.GeoJSON=L.FeatureGroup.extend({initialize:function(t,e){L.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,o=L.Util.isArray(t)?t:t.features;if(o){for(e=0,i=o.length;i>e;e++)n=o[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var r=this.options;if(r.filter&&!r.filter(t))return this;var s=L.GeoJSON.geometryToLayer(t,r);return s?(s.feature=L.GeoJSON.asFeature(t),s.defaultOptions=s.options,this.resetStyle(s),r.onEachFeature&&r.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return t.options=L.Util.extend({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),L.extend(L.GeoJSON,{geometryToLayer:function(t,e){var i,n,o,r,s="Feature"===t.type?t.geometry:t,a=s?s.coordinates:null,l=[],u=e&&e.pointToLayer,c=e&&e.coordsToLatLng||this.coordsToLatLng;if(!a&&!s)return null;switch(s.type){case"Point":return i=c(a),u?u(t,i):new L.Marker(i);case"MultiPoint":for(o=0,r=a.length;r>o;o++)i=c(a[o]),l.push(u?u(t,i):new L.Marker(i));return new L.FeatureGroup(l);case"LineString":case"MultiLineString":return n=this.coordsToLatLngs(a,"LineString"===s.type?0:1,c),new L.Polyline(n,e);case"Polygon":case"MultiPolygon":return n=this.coordsToLatLngs(a,"Polygon"===s.type?1:2,c),new L.Polygon(n,e);case"GeometryCollection":for(o=0,r=s.geometries.length;r>o;o++){var h=this.geometryToLayer({geometry:s.geometries[o],type:"Feature",properties:t.properties},e);h&&l.push(h)}return new L.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new L.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){for(var n,o=[],r=0,s=t.length;s>r;r++)n=e?this.coordsToLatLngs(t[r],e-1,i):(i||this.coordsToLatLng)(t[r]),o.push(n);return o},latLngToCoords:function(t){return t.alt!==undefined?[t.lng,t.lat,t.alt]:[t.lng,t.lat]},latLngsToCoords:function(t,e,i){for(var n=[],o=0,r=t.length;r>o;o++)n.push(e?L.GeoJSON.latLngsToCoords(t[o],e-1,i):L.GeoJSON.latLngToCoords(t[o]));return!e&&i&&n.push(n[0]),n},getFeature:function(t,e){return t.feature?L.extend({},t.feature,{geometry:e}):L.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var PointToGeoJSON={toGeoJSON:function(){return L.GeoJSON.getFeature(this,{type:"Point",coordinates:L.GeoJSON.latLngToCoords(this.getLatLng())})}};L.Marker.include(PointToGeoJSON),L.Circle.include(PointToGeoJSON),L.CircleMarker.include(PointToGeoJSON),L.Polyline.prototype.toGeoJSON=function(){var t=!L.Polyline._flat(this._latlngs),e=L.GeoJSON.latLngsToCoords(this._latlngs,t?1:0);return L.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"LineString",coordinates:e})},L.Polygon.prototype.toGeoJSON=function(){var t=!L.Polyline._flat(this._latlngs),e=t&&!L.Polyline._flat(this._latlngs[0]),i=L.GeoJSON.latLngsToCoords(this._latlngs,e?2:t?1:0,!0);return t||(i=[i]),L.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"Polygon",coordinates:i})},L.LayerGroup.include({toMultiPoint:function(){var t=[];return this.eachLayer(function(e){t.push(e.toGeoJSON().geometry.coordinates)}),L.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint();var e="GeometryCollection"===t,i=[];return this.eachLayer(function(t){if(t.toGeoJSON){var n=t.toGeoJSON();i.push(e?n.geometry:L.GeoJSON.asFeature(n))}}),e?L.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}}),L.geoJSON=function(t,e){return new L.GeoJSON(t,e)},L.geoJson=L.geoJSON;var eventsKey="_leaflet_events";L.DomEvent={on:function(t,e,i,n){if("object"==typeof e)for(var o in e)this._on(t,o,e[o],i);else{e=L.Util.splitWords(e);for(var r=0,s=e.length;s>r;r++)this._on(t,e[r],i,n)}return this},off:function(t,e,i,n){if("object"==typeof e)for(var o in e)this._off(t,o,e[o],i);else{e=L.Util.splitWords(e);for(var r=0,s=e.length;s>r;r++)this._off(t,e[r],i,n)}return this},_on:function(t,e,i,n){var o=e+L.stamp(i)+(n?"_"+L.stamp(n):"");if(t[eventsKey]&&t[eventsKey][o])return this;var r=function(e){return i.call(n||t,e||window.event)},s=r;return L.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,r,o):L.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener?this.addDoubleTapListener(t,r,o):"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):"mouseenter"===e||"mouseleave"===e?(r=function(e){e=e||window.event,L.DomEvent._isExternalTarget(t,e)&&s(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",r,!1)):("click"===e&&L.Browser.android&&(r=function(t){return L.DomEvent._filterClick(t,s)}),t.addEventListener(e,r,!1)):"attachEvent"in t&&t.attachEvent("on"+e,r),t[eventsKey]=t[eventsKey]||{},t[eventsKey][o]=r,this},_off:function(t,e,i,n){var o=e+L.stamp(i)+(n?"_"+L.stamp(n):""),r=t[eventsKey]&&t[eventsKey][o];return r?(L.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,o):L.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,o):"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r),t[eventsKey][o]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,L.DomEvent._skipped(t),this},disableScrollPropagation:function(t){return L.DomEvent.on(t,"mousewheel",L.DomEvent.stopPropagation)},disableClickPropagation:function(t){var e=L.DomEvent.stopPropagation;return L.DomEvent.on(t,L.Draggable.START.join(" "),e),L.DomEvent.on(t,{click:L.DomEvent._fakeStop,dblclick:e})},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return L.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new L.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new L.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},getWheelDelta:function(t){return t.deltaY&&0===t.deltaMode?-t.deltaY:t.deltaY&&1===t.deltaMode?18*-t.deltaY:t.deltaY&&2===t.deltaMode?52*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?18*-t.detail:t.detail?t.detail/-32765*52:0},_skipEvents:{},_fakeStop:function(t){L.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_isExternalTarget:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent.timeStamp,n=L.DomEvent._lastClick&&i-L.DomEvent._lastClick;return n&&n>100&&500>n||t.target._simulatedClick&&!t._simulated?void L.DomEvent.stop(t):(L.DomEvent._lastClick=i,void e(t))}},L.DomEvent.addListener=L.DomEvent.on,L.DomEvent.removeListener=L.DomEvent.off,L.Draggable=L.Evented.extend({statics:{START:L.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",
pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e,i){this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(L.DomEvent.on(this._dragStartTarget,L.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(L.DomEvent.off(this._dragStartTarget,L.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._moved=!1,!L.DomUtil.hasClass(this._element,"leaflet-zoom-anim")&&!(L.Draggable._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches)&&this._enabled&&(L.Draggable._dragging=!0,this._preventOutline&&L.DomUtil.preventOutline(this._element),L.DomUtil.disableImageDrag(),L.DomUtil.disableTextSelection(),!this._moving)){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new L.Point(e.clientX,e.clientY),this._startPos=this._newPos=L.DomUtil.getPosition(this._element),L.DomEvent.on(document,L.Draggable.MOVE[t.type],this._onMove,this).on(document,L.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new L.Point(e.clientX,e.clientY),n=i.subtract(this._startPoint);(n.x||n.y)&&(L.Browser.touch&&Math.abs(n.x)+Math.abs(n.y)<3||(L.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=L.DomUtil.getPosition(this._element).subtract(n),L.DomUtil.addClass(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,L.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,L.Util.cancelAnimFrame(this._animRequest),this._lastEvent=t,this._animRequest=L.Util.requestAnimFrame(this._updatePosition,this,!0)))},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),L.DomUtil.setPosition(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){L.DomUtil.removeClass(document.body,"leaflet-dragging"),this._lastTarget&&(L.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in L.Draggable.MOVE)L.DomEvent.off(document,L.Draggable.MOVE[t],this._onMove,this).off(document,L.Draggable.END[t],this._onUp,this);L.DomUtil.enableImageDrag(),L.DomUtil.enableTextSelection(),this._moved&&this._moving&&(L.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,L.Draggable._dragging=!1}}),L.Handler=L.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),L.Map.mergeOptions({dragging:!0,inertia:!L.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1}),L.Map.Drag=L.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new L.Draggable(t._mapPane,t._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}L.DomUtil.addClass(this._map._container,"leaflet-grab"),this._draggable.enable()},removeHooks:function(){L.DomUtil.removeClass(this._map._container,"leaflet-grab"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map.stop()},_onDragStart:function(){var t=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=L.latLngBounds(this._map.options.maxBounds);this._offsetLimit=L.bounds(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),e-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",t).fire("drag",t)},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,r=(n+e+i)%t-e-i,s=Math.abs(o+i)<Math.abs(r+i)?o:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,s=i.easeLinearity,a=o.multiplyBy(s/r),l=a.distanceTo([0,0]),u=Math.min(i.inertiaMaxSpeed,l),c=a.multiplyBy(u/l),h=u/(i.inertiaDeceleration*s),d=c.multiplyBy(-h/2).round();d.x||d.y?(d=e._limitOffset(d,e.options.maxBounds),L.Util.requestAnimFrame(function(){e.panBy(d,{duration:h,easeLinearity:s,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}}),L.Map.addInitHook("addHandler","dragging",L.Map.Drag),L.Map.mergeOptions({doubleClickZoom:!0}),L.Map.DoubleClickZoom=L.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=t.originalEvent.shiftKey?Math.ceil(i)-1:Math.floor(i)+1;"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}}),L.Map.addInitHook("addHandler","doubleClickZoom",L.Map.DoubleClickZoom),L.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40}),L.Map.ScrollWheelZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){L.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=L.DomEvent.getWheelDelta(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(L.bind(this._performZoom,this),n),L.DomEvent.stop(t)},_performZoom:function(){var t=this._map,e=this._delta,i=t.getZoom();t.stop();var n=Math.ceil(4*Math.log(2/(1+Math.exp(-Math.abs(e/200))))/Math.LN2);e=t._limitZoom(i+(e>0?n:-n))-i,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(i+e):t.setZoomAround(this._lastMousePos,i+e))}}),L.Map.addInitHook("addHandler","scrollWheelZoom",L.Map.ScrollWheelZoom),L.PosAnimation=L.Evented.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=L.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=L.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;i>e?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),L.DomUtil.setPosition(this._el,i),this.fire("step")},_complete:function(){L.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),L.Map.include({setView:function(t,e,i){if(e=e===undefined?this._zoom:this._limitZoom(e),t=this._limitCenter(L.latLng(t),e,this.options.maxBounds),i=i||{},this.stop(),this._loaded&&!i.reset&&i!==!0){i.animate!==undefined&&(i.zoom=L.extend({animate:i.animate},i.zoom),i.pan=L.extend({animate:i.animate,duration:i.duration},i.pan));var n=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan);if(n)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=L.point(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new L.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){L.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){L.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(i)?(this.panBy(i,e),!0):!1}}),L.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});var zoomAnimated=L.DomUtil.TRANSITION&&L.Browser.any3d&&!L.Browser.mobileOpera;zoomAnimated&&L.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),L.DomEvent.on(this._proxy,L.DomUtil.TRANSITION_END,this._catchTransitionEnd,this))}),L.Map.include(zoomAnimated?{_createAnimProxy:function(){var t=this._proxy=L.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var i=L.DomUtil.TRANSFORM,n=t.style[i];L.DomUtil.setTransform(t,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),n===t.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var e=this.getCenter(),i=this.getZoom();L.DomUtil.setTransform(t,this.project(e,i),this.getZoomScale(i,1))},this)},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/n);return i.animate===!0||this.getSize().contains(o)?(L.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(t,e,!0)},this),!0):!1},_animateZoom:function(t,e,i,n){i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,L.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:n}),setTimeout(L.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(L.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),L.Util.requestAnimFrame(function(){this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom)._moveEnd(!0)},this))}}:{}),L.Map.include({flyTo:function(t,e,i){function n(t){var e=(f*f-m*m+(t?-1:1)*y*y*g*g)/(2*(t?f:m)*y*g);return Math.log(Math.sqrt(e*e+1)-e)}function o(t){return(Math.exp(t)-Math.exp(-t))/2}function r(t){return(Math.exp(t)+Math.exp(-t))/2}function s(t){return o(t)/r(t)}function a(t){return m*(r(b)/r(b+v*t))}function l(t){return m*(r(b)*s(b+v*t)-o(b))/y}function u(t){return 1-Math.pow(1-t,1.5)}function c(){var i=(Date.now()-w)/k,n=u(i)*D;1>=i?(this._flyToFrame=L.Util.requestAnimFrame(c,this),this._move(this.unproject(h.add(d.subtract(h).multiplyBy(l(n)/g)),_),this.getScaleZoom(m/a(n),_),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}if(i=i||{},i.animate===!1||!L.Browser.any3d)return this.setView(t,e,i);this.stop();var h=this.project(this.getCenter()),d=this.project(t),p=this.getSize(),_=this._zoom;t=L.latLng(t),e=e===undefined?_:e;var m=Math.max(p.x,p.y),f=m*this.getZoomScale(_,e),g=d.distanceTo(h)||1,v=1.42,y=v*v,b=n(0),w=Date.now(),D=(n(1)-b)/v,k=i.duration?1e3*i.duration:1e3*D*.8;return this._moveStart(!0),c.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)}}),L.extend(L.DomEvent,{_touchstart:L.Browser.msPointer?"MSPointerDown":L.Browser.pointer?"pointerdown":"touchstart",_touchend:L.Browser.msPointer?"MSPointerUp":L.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,i){function n(t){var e;if(e=L.Browser.pointer?L.DomEvent._pointersCount:t.touches.length,!(e>1)){var i=Date.now(),n=i-(r||i);s=t.touches?t.touches[0]:t,a=n>0&&l>=n,r=i}}function o(){if(a&&!s.cancelBubble){if(L.Browser.pointer){var t,i,n={};for(i in s)t=s[i],n[i]=t&&t.bind?t.bind(s):t;s=n}s.type="dblclick",e(s),r=null}}var r,s,a=!1,l=250,u="_leaflet_",c=this._touchstart,h=this._touchend;return t[u+c+i]=n,t[u+h+i]=o,t.addEventListener(c,n,!1),t.addEventListener(h,o,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_",n=t[i+this._touchend+e];return t.removeEventListener(this._touchstart,t[i+this._touchstart+e],!1),t.removeEventListener(this._touchend,n,!1),this}}),L.extend(L.DomEvent,{POINTER_DOWN:L.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:L.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:L.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:L.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:{},_pointersCount:0,addPointerListener:function(t,e,i,n){return"touchstart"===e?this._addPointerStart(t,i,n):"touchmove"===e?this._addPointerMove(t,i,n):"touchend"===e&&this._addPointerEnd(t,i,n),this},removePointerListener:function(t,e,i){var n=t["_leaflet_"+e+i];return"touchstart"===e?t.removeEventListener(this.POINTER_DOWN,n,!1):"touchmove"===e?t.removeEventListener(this.POINTER_MOVE,n,!1):"touchend"===e&&(t.removeEventListener(this.POINTER_UP,n,!1),t.removeEventListener(this.POINTER_CANCEL,n,!1)),this},_addPointerStart:function(t,e,i){var n=L.bind(function(t){"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&L.DomEvent.preventDefault(t),this._handlePointer(t,e)},this);if(t["_leaflet_touchstart"+i]=n,t.addEventListener(this.POINTER_DOWN,n,!1),!this._pointerDocListener){var o=L.bind(this._globalPointerUp,this);document.documentElement.addEventListener(this.POINTER_DOWN,L.bind(this._globalPointerDown,this),!0),document.documentElement.addEventListener(this.POINTER_MOVE,L.bind(this._globalPointerMove,this),!0),document.documentElement.addEventListener(this.POINTER_UP,o,!0),document.documentElement.addEventListener(this.POINTER_CANCEL,o,!0),this._pointerDocListener=!0}},_globalPointerDown:function(t){this._pointers[t.pointerId]=t,this._pointersCount++},_globalPointerMove:function(t){this._pointers[t.pointerId]&&(this._pointers[t.pointerId]=t)},_globalPointerUp:function(t){delete this._pointers[t.pointerId],this._pointersCount--},_handlePointer:function(t,e){t.touches=[];for(var i in this._pointers)t.touches.push(this._pointers[i]);t.changedTouches=[t],e(t)},_addPointerMove:function(t,e,i){var n=L.bind(function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&this._handlePointer(t,e)},this);t["_leaflet_touchmove"+i]=n,t.addEventListener(this.POINTER_MOVE,n,!1)},_addPointerEnd:function(t,e,i){var n=L.bind(function(t){this._handlePointer(t,e)},this);t["_leaflet_touchend"+i]=n,t.addEventListener(this.POINTER_UP,n,!1),t.addEventListener(this.POINTER_CANCEL,n,!1)}}),L.Map.mergeOptions({touchZoom:L.Browser.touch&&!L.Browser.android23,bounceAtZoomLimits:!0}),L.Map.TouchZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){L.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(n)._divideBy(2))),this._startDist=i.distanceTo(n),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e.stop(),L.DomEvent.on(document,"touchmove",this._onTouchMove,this).on(document,"touchend",this._onTouchEnd,this),L.DomEvent.preventDefault(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]),o=i.distanceTo(n)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var r=i._add(n)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng).subtract(r))}if(e.options.bounceAtZoomLimits||!(this._zoom<=e.getMinZoom()&&1>o||this._zoom>=e.getMaxZoom()&&o>1)){this._moved||(e._moveStart(!0),this._moved=!0),L.Util.cancelAnimFrame(this._animRequest);var s=L.bind(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=L.Util.requestAnimFrame(s,this,!0),L.DomEvent.preventDefault(t)}}},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);this._zooming=!1,L.Util.cancelAnimFrame(this._animRequest),L.DomEvent.off(document,"touchmove",this._onTouchMove).off(document,"touchend",this._onTouchEnd);var t=this._zoom;t=this._map._limitZoom(t-this._startZoom>0?Math.ceil(t):Math.floor(t)),this._map._animateZoom(this._center,t,!0,!0)}}),L.Map.addInitHook("addHandler","touchZoom",L.Map.TouchZoom),L.Map.mergeOptions({tap:!0,tapTolerance:15}),L.Map.Tap=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){L.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(L.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new L.Point(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&L.DomUtil.addClass(i,"leaflet-active"),this._holdTimeout=setTimeout(L.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),L.DomEvent.on(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),L.DomEvent.off(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&L.DomUtil.removeClass(i,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new L.Point(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var i=document.createEvent("MouseEvents");i._simulated=!0,e.target._simulatedClick=!0,i.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}}),L.Browser.touch&&!L.Browser.pointer&&L.Map.addInitHook("addHandler","tap",L.Map.Tap),L.Map.mergeOptions({boxZoom:!0}),L.Map.BoxZoom=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){L.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(t){return!t.shiftKey||1!==t.which&&1!==t.button?!1:(this._resetState(),L.DomUtil.disableTextSelection(),L.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(t),void L.DomEvent.on(document,{contextmenu:L.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this))},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=L.DomUtil.create("div","leaflet-zoom-box",this._container),L.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new L.Bounds(this._point,this._startPoint),i=e.getSize();L.DomUtil.setPosition(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(L.DomUtil.remove(this._box),L.DomUtil.removeClass(this._container,"leaflet-crosshair")),L.DomUtil.enableTextSelection(),L.DomUtil.enableImageDrag(),L.DomEvent.off(document,{contextmenu:L.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){setTimeout(L.bind(this._resetState,this),0);var e=new L.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),L.Map.addInitHook("addHandler","boxZoom",L.Map.BoxZoom),L.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),L.Map.Keyboard=L.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),L.DomEvent.on(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),L.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;i>e;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;i>e;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;i>e;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;i>e;e++)n[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;i>e;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;i>e;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){L.DomEvent.on(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){L.DomEvent.off(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;e=this._panKeys[i],t.shiftKey&&(e=L.point(e).multiplyBy(3)),n.panBy(e),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i)return;n.closePopup()}L.DomEvent.stop(t)}}}),L.Map.addInitHook("addHandler","keyboard",L.Map.Keyboard),L.Handler.MarkerDrag=L.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new L.Draggable(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),L.DomUtil.addClass(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&L.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(t){var e=this._marker,i=e._shadow,n=L.DomUtil.getPosition(e._icon),o=e._map.layerPointToLatLng(n);i&&L.DomUtil.setPosition(i,n),e._latlng=o,t.latlng=o,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),L.Control=L.Class.extend({options:{position:"topright"},initialize:function(t){L.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return L.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},remove:function(){return this._map?(L.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),L.control=function(t){return new L.Control(t)},L.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,o){var r=i+t+" "+i+o;e[t+o]=L.DomUtil.create("div",r,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=L.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){L.DomUtil.remove(this._controlContainer)}}),L.Control.Zoom=L.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=L.DomUtil.create("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){this._disabled||this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._disabled||this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,i,n,o){var r=L.DomUtil.create("a",i,n);return r.innerHTML=t,r.href="#",r.title=e,L.DomEvent.on(r,"mousedown dblclick",L.DomEvent.stopPropagation).on(r,"click",L.DomEvent.stop).on(r,"click",o,this).on(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";L.DomUtil.removeClass(this._zoomInButton,e),L.DomUtil.removeClass(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&L.DomUtil.addClass(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&L.DomUtil.addClass(this._zoomInButton,e)}}),L.Map.mergeOptions({zoomControl:!0}),L.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new L.Control.Zoom,this.addControl(this.zoomControl))}),L.control.zoom=function(t){return new L.Control.Zoom(t)},L.Control.Attribution=L.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){L.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=L.DomUtil.create("div","leaflet-control-attribution"),L.DomEvent&&L.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}}),L.Map.mergeOptions({attributionControl:!0}),L.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new L.Control.Attribution).addTo(this))}),L.control.attribution=function(t){return new L.Control.Attribution(t)},L.Control.Scale=L.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=L.DomUtil.create("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=L.DomUtil.create("div",e,i)),t.imperial&&(this._iScale=L.DomUtil.create("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=1e3>e?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;o>5280?(e=o/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),L.control.scale=function(t){return new L.Control.Scale(t)},L.Control.Layers=L.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1},initialize:function(t,e,i){L.setOptions(this,i),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),this._map=t,
t.on("zoomend",this._checkDisabledLayers,this),this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update()},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update()},removeLayer:function(t){return t.off("add remove",this._onLayerChange,this),delete this._layers[L.stamp(t)],this._update()},_initLayout:function(){var t="leaflet-control-layers",e=this._container=L.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),L.DomEvent.disableClickPropagation(e),L.Browser.touch||L.DomEvent.disableScrollPropagation(e);var i=this._form=L.DomUtil.create("form",t+"-list");if(this.options.collapsed){L.Browser.android||L.DomEvent.on(e,{mouseenter:this._expand,mouseleave:this._collapse},this);var n=this._layersLink=L.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",L.Browser.touch?L.DomEvent.on(n,"click",L.DomEvent.stop).on(n,"click",this._expand,this):L.DomEvent.on(n,"focus",this._expand,this),L.DomEvent.on(i,"click",function(){setTimeout(L.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=L.DomUtil.create("div",t+"-base",i),this._separator=L.DomUtil.create("div",t+"-separator",i),this._overlaysList=L.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_addLayer:function(t,e,i){t.on("add remove",this._onLayerChange,this);var n=L.stamp(t);this._layers[n]={layer:t,name:e,overlay:i},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;L.DomUtil.empty(this._baseLayersList),L.DomUtil.empty(this._overlaysList);var t,e,i,n,o=0;for(i in this._layers)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,o+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&o>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._layers[L.stamp(t.target)],i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?(e=document.createElement("input"),e.type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers",n),e.layerId=L.stamp(t.layer),L.DomEvent.on(e,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;var r=document.createElement("div");i.appendChild(r),r.appendChild(e),r.appendChild(o);var s=t.overlay?this._overlaysList:this._baseLayersList;return s.appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),o=[],r=[];this._handlingClick=!0;for(var s=n.length-1;s>=0;s--)t=n[s],e=this._layers[t.layerId].layer,i=this._map.hasLayer(e),t.checked&&!i?o.push(e):!t.checked&&i&&r.push(e);for(s=0;s<r.length;s++)this._map.removeLayer(r[s]);for(s=0;s<o.length;s++)this._map.addLayer(o[s]);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);t<this._form.clientHeight?(L.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):L.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers()},_collapse:function(){L.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded")},_checkDisabledLayers:function(){for(var t,e,i=this._form.getElementsByTagName("input"),n=this._map.getZoom(),o=i.length-1;o>=0;o--)t=i[o],e=this._layers[t.layerId].layer,t.disabled=e.options.minZoom!==undefined&&n<e.options.minZoom||e.options.maxZoom!==undefined&&n>e.options.maxZoom}}),L.control.layers=function(t,e,i){return new L.Control.Layers(t,e,i)},L.Map.include({_defaultLocateOptions:{timeout:1e4,watch:!1},locate:function(t){if(t=this._locateOptions=L.extend({},this._defaultLocateOptions,t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=L.bind(this._handleGeolocationResponse,this),i=L.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new L.LatLng(e,i),o=n.toBounds(t.coords.accuracy),r=this._locateOptions;if(r.setView){var s=this.getBoundsZoom(o);this.setView(n,r.maxZoom?Math.min(s,r.maxZoom):s)}var a={latlng:n,bounds:o,timestamp:t.timestamp};for(var l in t.coords)"number"==typeof t.coords[l]&&(a[l]=t.coords[l]);this.fire("locationfound",a)}}),function(t,e){function i(t,e){var i=t.createElement("p"),n=t.getElementsByTagName("head")[0]||t.documentElement;return i.innerHTML="x<style>"+e+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var t=y.elements;return"string"==typeof t?t.split(" "):t}function o(t,e){var i=y.elements;"string"!=typeof i&&(i=i.join(" ")),"string"!=typeof t&&(t=t.join(" ")),y.elements=i+" "+t,u(e)}function r(t){var e=v[t[f]];return e||(e={},g++,t[f]=g,v[g]=e),e}function s(t,i,n){if(i||(i=e),h)return i.createElement(t);n||(n=r(i));var o;return o=n.cache[t]?n.cache[t].cloneNode():m.test(t)?(n.cache[t]=n.createElem(t)).cloneNode():n.createElem(t),!o.canHaveChildren||_.test(t)||o.tagUrn?o:n.frag.appendChild(o)}function a(t,i){if(t||(t=e),h)return t.createDocumentFragment();i=i||r(t);for(var o=i.frag.cloneNode(),s=0,a=n(),l=a.length;l>s;s++)o.createElement(a[s]);return o}function l(t,e){e.cache||(e.cache={},e.createElem=t.createElement,e.createFrag=t.createDocumentFragment,e.frag=e.createFrag()),t.createElement=function(i){return y.shivMethods?s(i,t,e):e.createElem(i)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-:]+/g,function(t){return e.createElem(t),e.frag.createElement(t),'c("'+t+'")'})+");return n}")(y,e.frag)}function u(t){t||(t=e);var n=r(t);return!y.shivCSS||c||n.hasCSS||(n.hasCSS=!!i(t,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),h||l(t,n),t}var c,h,d="3.7.3-pre",p=t.html5||{},_=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,m=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f="_html5shiv",g=0,v={};!function(){try{var t=e.createElement("a");t.innerHTML="<xyz></xyz>",c="hidden"in t,h=1==t.childNodes.length||function(){e.createElement("a");var t=e.createDocumentFragment();return"undefined"==typeof t.cloneNode||"undefined"==typeof t.createDocumentFragment||"undefined"==typeof t.createElement}()}catch(i){c=!0,h=!0}}();var y={elements:p.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:d,shivCSS:p.shivCSS!==!1,supportsUnknownElements:h,shivMethods:p.shivMethods!==!1,type:"default",shivDocument:u,createElement:s,createDocumentFragment:a,addElements:o};t.html5=y,u(e),"object"==typeof module&&module.exports&&(module.exports=y)}("undefined"!=typeof window?window:this,document),Array.prototype.map||(Array.prototype.map=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=new Array(i),o=arguments.length>=2?arguments[1]:void 0,r=0;i>r;r++)r in e&&(n[r]=t.call(o,e[r],r,e));return n}),"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(t,e){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var i,n,o=this.length>>>0,r=!1;for(1<arguments.length&&(n=e,r=!0),i=0;o>i;++i)this.hasOwnProperty(i)&&(r?n=t(n,this[i],i,this):(n=this[i],r=!0));if(!r)throw new TypeError("Reduce of empty array with no initial value");return n}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){"use strict";var i,n;if(null==this)throw new TypeError("this is null or not defined");var o,r=Object(this),s=r.length>>>0;if("[object Function]"!=={}.toString.call(t))throw new TypeError(t+" is not a function");for(arguments.length>=2&&(i=e),n=0;s>n;)n in r&&(o=r[n],t.call(i,o,n,r)),n++}),Object.keys||(Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=i.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var r,s,a=[];for(r in o)t.call(o,r)&&a.push(r);if(e)for(s=0;n>s;s++)t.call(o,i[s])&&a.push(i[s]);return a}}()),Array.prototype.some||(Array.prototype.some=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=arguments.length>=2?arguments[1]:void 0,o=0;i>o;o++)if(o in e&&t.call(n,e[o],o,e))return!0;return!1}),Array.prototype.map||(Array.prototype.map=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=new Array(i),o=arguments.length>=2?arguments[1]:void 0,r=0;i>r;r++)r in e&&(n[r]=t.call(o,e[r],r,e));return n}),Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=[],o=arguments.length>=2?arguments[1]:void 0,r=0;i>r;r++)if(r in e){var s=e[r];t.call(o,s,r,e)&&n.push(s)}return n}),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},o=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,o.prototype=new n,o}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(this===undefined||null===this)throw new TypeError('"this" is null or not defined');var i=this.length>>>0;for(e=+e||0,Math.abs(e)===1/0&&(e=0),0>e&&(e+=i,0>e&&(e=0));i>e;e++)if(this[e]===t)return e;return-1}),"function"!=typeof Promise&&!function(){var t,e,i,n;!function(){var o={},r={};t=function(t,e,i){o[t]={deps:e,callback:i}},n=i=e=function(t){function i(e){if("."!==e.charAt(0))return e;for(var i=e.split("/"),n=t.split("/").slice(0,-1),o=0,r=i.length;r>o;o++){var s=i[o];if(".."===s)n.pop();else{if("."===s)continue;n.push(s)}}return n.join("/")}if(n._eak_seen=o,r[t])return r[t];if(r[t]={},!o[t])throw new Error("Could not find module "+t);for(var s,a=o[t],l=a.deps,u=a.callback,c=[],h=0,d=l.length;d>h;h++)"exports"===l[h]?c.push(s={}):c.push(e(i(l[h])));var p=u.apply(this,c);return r[t]=s||p}}(),t("promise/all",["./utils","exports"],function(t,e){"use strict";function i(t){var e=this;if(!n(t))throw new TypeError("You must pass an array to all.");return new e(function(e,i){function n(t){return function(e){r(t,e)}}function r(t,i){a[t]=i,0===--l&&e(a)}var s,a=[],l=t.length;0===l&&e([]);for(var u=0;u<t.length;u++)s=t[u],s&&o(s.then)?s.then(n(u),i):r(u,s)})}var n=t.isArray,o=t.isFunction;e.all=i}),t("promise/asap",["exports"],function(t){"use strict";function e(){return function(){process.nextTick(o)}}function i(){var t=0,e=new l(o),i=document.createTextNode("");return e.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}function n(){return function(){u.setTimeout(o,1)}}function o(){for(var t=0;t<c.length;t++){var e=c[t],i=e[0],n=e[1];i(n)}c=[]}function r(t,e){var i=c.push([t,e]);1===i&&s()}var s,a="undefined"!=typeof window?window:{},l=a.MutationObserver||a.WebKitMutationObserver,u=window,c=[];s="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?e():l?i():n(),t.asap=r}),t("promise/config",["exports"],function(t){"use strict";function e(t,e){return 2!==arguments.length?i[t]:void(i[t]=e)}var i={instrument:!1};t.config=i,t.configure=e}),t("promise/polyfill",["./promise","./utils","exports"],function(t,e,i){"use strict";function n(){var t;t="undefined"!=typeof window&&window.document?window:self;var e="Promise"in t&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var e;return new t.Promise(function(t){e=t}),r(e)}();e||(t.Promise=o)}var o=t.Promise,r=e.isFunction;i.polyfill=n}),t("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(t,e,i,n,o,r,s,a){"use strict";function l(t){if(!b(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof l))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],u(t,this)}function u(t,e){function i(t){_(e,t)}function n(t){f(e,t)}try{t(i,n)}catch(o){n(o)}}function c(t,e,i,n){var o,r,s,a,l=b(i);if(l)try{o=i(n),s=!0}catch(u){a=!0,r=u}else o=n,s=!0;p(e,o)||(l&&s?_(e,o):a?f(e,r):t===G?_(e,o):t===O&&f(e,o))}function h(t,e,i,n){var o=t._subscribers,r=o.length;o[r]=e,o[r+G]=i,o[r+O]=n}function d(t,e){for(var i,n,o=t._subscribers,r=t._detail,s=0;s<o.length;s+=3)i=o[s],n=o[s+e],c(e,i,n,r);t._subscribers=null}function p(t,e){var i,n=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(L(e)&&(n=e.then,b(n)))return n.call(e,function(n){return i?!0:(i=!0,void(e!==n?_(t,n):m(t,n)))},function(e){return i?!0:(i=!0,void f(t,e))}),!0}catch(o){return i?!0:(f(t,o),!0)}return!1}function _(t,e){t===e?m(t,e):p(t,e)||m(t,e)}function m(t,e){t._state===C&&(t._state=E,t._detail=e,y.async(g,t))}function f(t,e){t._state===C&&(t._state=E,t._detail=e,y.async(v,t))}function g(t){d(t,t._state=G)}function v(t){d(t,t._state=O)}var y=t.config,L=(t.configure,e.objectOrFunction),b=e.isFunction,w=(e.now,i.all),D=n.race,k=o.resolve,P=r.reject,x=s.asap;y.async=x;var C=void 0,E=0,G=1,O=2;l.prototype={constructor:l,_state:undefined,_detail:undefined,_subscribers:undefined,then:function(t,e){var i=this,n=new this.constructor(function(){});if(this._state){var o=arguments;y.async(function(){c(i._state,n,o[i._state-1],i._detail)})}else h(this,n,t,e);return n},"catch":function(t){return this.then(null,t)}},l.all=w,l.race=D,l.resolve=k,l.reject=P,a.Promise=l}),t("promise/race",["./utils","exports"],function(t,e){"use strict";function i(t){var e=this;if(!n(t))throw new TypeError("You must pass an array to race.");return new e(function(e,i){for(var n,o=0;o<t.length;o++)n=t[o],n&&"function"==typeof n.then?n.then(e,i):e(n)})}var n=t.isArray;e.race=i}),t("promise/reject",["exports"],function(t){"use strict";function e(t){var e=this;return new e(function(e,i){i(t)})}t.reject=e}),t("promise/resolve",["exports"],function(t){"use strict";function e(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=this;return new e(function(e){e(t)})}t.resolve=e}),t("promise/utils",["exports"],function(t){"use strict";function e(t){return i(t)||"object"==typeof t&&null!==t}function i(t){return"function"==typeof t}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}var o=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=e,t.isFunction=i,t.isArray=n,t.now=o}),e("promise/polyfill").polyfill()}();var oldDG=window.DG;DG=new(function(){var t=function(){},e=function(){};return e.prototype=L,t.prototype=new e,t}());for(var prop in oldDG)oldDG.hasOwnProperty(prop)&&"undefined"==typeof DG[prop]&&(DG[prop]=oldDG[prop]);window.__dgApi__=window.__dgApi__||{},DG.version=window.__dgApi__.version,DG.Icon.Default.imagePath="../img/vendors/leaflet",DG.Map.addInitHook(function(){var t=!1;return function(){t||(!function(t,e,i,n,o,r,s){t.GoogleAnalyticsObject=o,t[o]=t[o]||function(){(t[o].q=t[o].q||[]).push(arguments)},t[o].l=1*new Date,r=e.createElement(i),s=e.getElementsByTagName(i)[0],r.async=1,r.src=n,s.parentNode.insertBefore(r,s)}(window,document,"script",DG.config.protocol+DG.config.googleAnalytics,"ga"),t=!0),ga("create",DG.config.gaCode,"none",{name:"mapsapi2gis"}),ga("mapsapi2gis.send","pageview");var e=new Image;e.src=DG.config.protocol+DG.config.analytics+"?sr="+window.screen.width+"x"+window.screen.height+"&v="+DG.version}}()),DG.Map.include({addHandler:function(t,e){if(!e)return this;var i=this.options[t],n=i===Object(i)?i:null,o=this[t]=new e(this,n);return this._handlers.push(o),i&&o.enable(),this}}),DG.Map.addInitHook(function(){DG.Browser.touch||DG.DomUtil.addClass(this._container,"no-touch")});var handlers=window.__dgApi__.callbacks||[],chain=Promise.resolve();handlers.forEach(function(t){chain=chain.then(t[0],t[1])}),DG.then=function(t,e){return chain.then(t,e)},chain["catch"](function(t){console.error(t)}),DG.plugin=function(t){var e,i=new RegExp(/.js$/i),n=new RegExp(/.css$/i);return new Promise(function(o){function r(){e--,0===e&&o()}function s(t){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",t),e.onload=function(){r()},e.onerror=function(){r()},e.onreadystatechange=function(){"complete"!==e.readyState&&"loaded"!==e.readyState||r()},document.getElementsByTagName("head")[0].appendChild(e)}function a(t){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t),document.getElementsByTagName("head")[0].appendChild(e),r()}function l(t){return i.test(t)}function u(t){return n.test(t)}function c(t){l(t)?s(t):u(t)?a(t):e--}DG.Util.isArray(t)&&(e=t.length,t.forEach(function(t){c(t)})),"string"==typeof t&&(e=1,c(t))})},DG.ajax=function(){function handleReadyState(t,e,i){return function(){return t._aborted?i(t.request):void(t.request&&4===t.request[readyState]&&(t.request.onreadystatechange=noop,twoHundo.test(t.request.status)?e(t.request):i(t.request)))}}function setHeaders(t,e){var i,n=e.headers||{};n.Accept=n.Accept||defaultHeaders.accept[e.dataType]||defaultHeaders.accept["*"],e.crossDomain||n[requestedWith]||(n[requestedWith]=defaultHeaders.requestedWith),n[contentType]||(n[contentType]=e.contentType||defaultHeaders.contentType);for(i in n)n.hasOwnProperty(i)&&"setRequestHeader"in t&&t.setRequestHeader(i,n[i])}function setCredentials(t,e){"undefined"!=typeof e.withCredentials&&"undefined"!=typeof t.withCredentials&&(t.withCredentials=!!e.withCredentials)}function generalCallback(t){lastValue=t}function urlappend(t,e){return t+(/\?/.test(t)?"&":"?")+e}function handleJsonp(t,e,i,n){var o=uniqid++,r=t.jsonpCallback||"callback",s=t.jsonpCallbackName||callbackPrefix,a=new RegExp("((^|\\?|&)"+r+")=([^&]+)"),l=n.match(a),u=doc.createElement("script"),c=0,h=-1!==navigator.userAgent.indexOf("MSIE 10.0");return l?"?"===l[3]?n=n.replace(a,"$1="+s):s=l[3]:n=urlappend(n,r+"="+s),win[s]=generalCallback,u.type="text/javascript",u.src=n,u.async=!0,"undefined"==typeof u.onreadystatechange||h||(u.event="onclick",u.htmlFor=u.id="_request_"+o),u.onerror=function(){u.onerror=u.onload=u.onreadystatechange=null,i({},"Request unknown error",{}),lastValue=undefined,head.removeChild(u),c=1},u.onload=u.onreadystatechange=function(){return u[readyState]&&"complete"!==u[readyState]&&"loaded"!==u[readyState]||c?!1:(u.onerror=u.onload=u.onreadystatechange=null,u.onclick&&u.onclick(),e(lastValue),lastValue=undefined,head.removeChild(u),void(c=1))},head.appendChild(u),{abort:function(){u.onerror=u.onload=u.onreadystatechange=null,i({},"Request is aborted: timeout",{}),lastValue=undefined,head.removeChild(u),c=1}}}function getRequest(t,e){var i,n=this.options,o=(n.type||"GET").toUpperCase(),r="string"==typeof n?n:n.url,s=n.processData!==!1&&n.data&&"string"!=typeof n.data?Ajax.toQueryString(n.data):n.data||null,a=!1;return"jsonp"!==n.type&&"GET"!==o||!s||(r=urlappend(r,s),s=null),"jsonp"===n.type?handleJsonp(n,t,e,r):(i=xhr(n),i.open(o,r,n.async!==!1),setHeaders(i,n),setCredentials(i,n),win[xDomainRequest]&&i instanceof win[xDomainRequest]?(i.onload=t,i.onprogress=function(){},i.ontimeout=function(){},i.onerror=e,a=!0):i.onreadystatechange=handleReadyState(this,t,e),a?setTimeout(function(){i.send(s)},200):i.send(s),i)}function buildParams(t,e,i,n){var o,r,s,a=/\[\]$/;if(DG.Util.isArray(e))for(r=0;e&&r<e.length;r++)s=e[r],i||a.test(t)?n(t,s):buildParams(t+"["+("object"==typeof s?r:"")+"]",s,i,n);else if(e&&"[object Object]"===e.toString())for(o in e)e.hasOwnProperty(o)&&buildParams(t+"["+o+"]",e[o],i,n);else n(t,e)}function setType(t){var e=t.match(/\.(json|jsonp|html|xml)(\?|$)/);return e?e[1]:"js"}function isCrossDomain(t){var e=rurl.exec(t.toLowerCase());return!(!e||e[1]===ajaxLocParts[1]&&e[2]===ajaxLocParts[2]&&(e[3]||("http:"===e[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))}function doRequest(o){"crossDomain"in o||(o.crossDomain=isCrossDomain(o.url));var self={};return self.promise=new Promise(function(resolve,reject){function complete(t){o.timeout&&clearTimeout(self.timeout),self.timeout=null,self._erred?reject(t):resolve(t)}function success(resp){resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval("("+r+")");break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}self._responseArgs.resp=resp,complete(resp)}function error(t,e,i){t=self.request,self._responseArgs.resp=t,self._responseArgs.msg=e,self._responseArgs.t=i,self._erred=!0,complete(t)}self.abort=function(){self._aborted=!0,reject("aborted")},self.url=o.url,self.timeout=null,self.options=o,self._aborted=!1,self._erred=!1,self._responseArgs={};var type="jsonp"===o.type?o.type:o.dataType||setType(self.url);o.timeout&&(self.timeout=setTimeout(function(){self.abort()},o.timeout)),self.request=getRequest.call(self,success,error)}),self}function Ajax(t,e){"[object Object]"===Object.prototype.toString.call(t)&&(e=t,t=undefined),e=e||{},e.url=t||e.url;var i=doRequest(e),n=i.promise;return(e.success||e.error||e.complete)&&n.then(e.success,e.error),n.abort=i.abort,n}var win=window,doc=document,rurl=/^([\w.+-]+:)?(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,twoHundo=/^20\d$/,ajaxLocParts,ajaxLocation,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="l_dg_ajax_callback_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(t){if(t.crossDomain===!0){var e=win[xmlHttpRequest]?new XMLHttpRequest:null;if(e&&"withCredentials"in e)return e;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(t){return t}};try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],Ajax.setup=function(t){t=t||{};for(var e in t)t.hasOwnProperty(e)&&(globalSetupOptions[e]=t[e])},Ajax.toQueryString=function(t,e){var i,n,o=e||!1,r=[],s=encodeURIComponent,a=function(t,e){e="function"==typeof e?e():e||"",r[r.length]=s(t)+"="+s(e)};if(DG.Util.isArray(t))for(n=0;t&&n<t.length;n++)a(t[n].name,t[n].value);else for(i in t)t.hasOwnProperty(i)&&buildParams(i,t[i],o,a);return r.join("&").replace(/%20/g,"+")};var testxhr=win[xmlHttpRequest]?new XMLHttpRequest:null;return Ajax.corsSupport=!(!(testxhr&&"withCredentials"in testxhr||win[xDomainRequest])||DG.Browser.ie&&-1!=document.location.host.toLowerCase().search(/[а-я]/)),Ajax}(),DG.Wkt={},DG.Wkt.toGeoJSON=function(t){function e(e){var i=t.substring(m).match(e);return i?(m+=i[0].length,i[0]):null}function i(t){return t&&f.match(/\d+/)&&(t.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+f}}),t}function n(){e(/^\s*/)}function o(){n();for(var t,i=0,o=[],r=[o],s=o;t=e(/^(\()/)||e(/^(\))/)||e(/^(\,)/)||e(/^[-+]?([0-9]*\.[0-9]+|[0-9]+)/);){if("("===t)r.push(s),s=[],r[r.length-1].push(s),i++;else if(")"===t){if(s=r.pop(),i--,0===i)break}else","===t?(s=[],r[r.length-1].push(s)):s.push(parseFloat(t));n()}return r.length=0,0!==i?null:o}function r(){for(var t,i,o=[];i=e(/^[-+]?([0-9]*\.[0-9]+|[0-9]+)/)||e(/^(\,)/);)","===i?(o.push(t),t=[]):(t||(t=[]),t.push(parseFloat(i))),n();return t&&o.push(t),o.length?o:null}function s(){if(!e(/^(point)/i))return null;if(n(),!e(/^(\()/))return null;var t=r();return n(),e(/^(\))/)?{type:"Point",coordinates:t[0]}:null}function a(){if(!e(/^(multipoint)/i))return null;n();var t=o();return n(),{type:"MultiPoint",coordinates:t}}function l(){if(!e(/^(multilinestring)/i))return null;n();var t=o();return n(),{type:"MultiLineString",coordinates:t}}function u(){if(!e(/^(linestring)/i))return null;if(n(),!e(/^(\()/))return null;var t=r();return e(/^(\))/)?{type:"LineString",coordinates:t}:null}function c(){return e(/^(polygon)/i)?(n(),{type:"Polygon",coordinates:o()}):null}function h(){return e(/^(multipolygon)/i)?(n(),{type:"MultiPolygon",coordinates:o()}):null}function d(){var t,i=[];if(!e(/^(geometrycollection)/i))return null;if(n(),!e(/^(\()/))return null;for(;t=p();)i.push(t),n(),e(/^(\,)/),n();return e(/^(\))/)?{type:"GeometryCollection",geometries:i}:null}function p(){return s()||u()||c()||a()||l()||h()||d()}DG.Util.isArray(t)&&(t=t[0]);var _=t.split(";");t=_.pop();var m=0,f=(_.shift()||"").split("=").pop();return i(p())},DG.Wkt.geoJsonLayer=function(t,e){return DG.geoJson(DG.Wkt.toGeoJSON(t),e)},DG.Wkt._coordsToLatLngs=function(t){return DG.Util.isArray(t)&&!DG.Util.isArray(t[0])?[DG.GeoJSON.coordsToLatLng(t)]:t.map(function(t){return DG.Wkt._coordsToLatLngs(t)}).reduce(function(t,e){return t.concat(e)})},DG.Wkt.toLatLngs=function(t){return DG.Util.isArray(t)||(t=[t]),t.map(function(t){var e=DG.Wkt.toGeoJSON(t).coordinates;return DG.Wkt._coordsToLatLngs(e)}).reduce(function(t,e){return t.concat(e)})},DG.Wkt.toPoints=function(t){return DG.Wkt.toGeoJSON(t).coordinates},DG.Wkt.pointsToLatLngOnMap=function(t,e){return function i(t){return Array.isArray(t)&&Array.isArray(t[0])?t.map(i):e.containerPointToLatLng(t)}(DG.Wkt.toPoints(t))},DG.ProjectDetector=DG.Handler.extend({initialize:function(t){this._map=t,this._osmViewport=!1,this._project=null,this._noProjectEventFired=!1,this._loadProjectList(),this._searchProject()},addHooks:function(){this._map.on("move",this._projectWatch,this)},removeHooks:function(){this._map.off("move",this._projectWatch,this)},getProject:function(){return this._project?DG.Util.extend({},this._project):!1},getProjectsList:function(){return this._projectList.slice(0)},isProjectHere:function(t,e,i){return t?(t instanceof DG.LatLng||t instanceof DG.LatLngBounds||(t=DG.latLng(t)),t=t instanceof DG.LatLngBounds?DG.latLngBounds(t.getSouthWest().wrap(),t.getNorthEast().wrap()):t.wrap(),i=i||(t instanceof DG.LatLngBounds?"intersects":"contains"),e?this._testProject(i,t,e):this._projectList.filter(this._testProject.bind(this,i,t))[0]):null},_projectWatch:function(){this._osmViewport===(this._project&&this._boundInProject(this._project,"contains"))&&(this._osmViewport=!this._osmViewport,this._map.attributionControl._update(null,this._osmViewport)),this._project&&this._boundInProject(this._project)&&this._zoomInProject(this._project)||(this._project&&(this._project=null,this._map.fire("projectleave")),this._searchProject(),this._project&&(this._osmViewport===(this._project&&this._boundInProject(this._project,"contains"))&&(this._osmViewport=!this._osmViewport),this._map.attributionControl._update(null,this._osmViewport,this._project.country_code)))},_wktToBnd:function(t){var e,i,n,o;t=t.replace(/, /g,","),t.replace(" (","("),e=/^POLYGON\((.*)\)/.exec(t),o=/\((.*?)\)/g,n=o.exec(e[1]),i=n[1].split(","),i=i.map(function(t){var e=t.split(" ");return DG.latLng(parseFloat(e[1]),parseFloat(e[0]))});var r=DG.latLngBounds(i);return[[r.getSouthWest().lat,r.getSouthWest().lng],[r.getNorthEast().lat,r.getNorthEast().lng]]},_checkProject:function(t){function e(t){return t!==undefined&&null!==t}return t&&t.bounds&&e(t.code)&&e(t.domain)&&e(t.country_code)&&t.zoom_level&&e(t.zoom_level.min)&&e(t.zoom_level.max)&&t.time_zone&&e(t.time_zone.offset)},_loadProjectList:function(){var t=this;DG.fallbackProjectsList=DG.fallbackProjectsList||[],DG.projectsList||(DG.projectsList=DG.fallbackProjectsList),delete DG.fallbackProjectsList,this._projectList=DG.projectsList.filter(t._checkProject).map(function(e){var i=t._wktToBnd(e.bounds),n=new DG.LatLngBounds(i);return{id:e.id,code:e.code,minZoom:e.zoom_level.min,maxZoom:e.zoom_level.max,timeOffset:e.time_zone.offset,bound:i,latLngBounds:n,traffic:!!e.flags.traffic,transport:!!e.flags.public_transport,roads:!!e.flags.road_network,country_code:e.country_code,domain:e.domain}})},_searchProject:function(){var t=this._projectList.filter(function(t){return this._boundInProject(t)&&this._zoomInProject(t)},this),e=!1;try{this._map._checkIfLoaded(),e=!0}catch(i){e=!1}if(e&&0===t.length&&!this._noProjectEventFired){var n=this;setTimeout(function(){n._map.fire("projectleave"),n._noProjectEventFired=!0},1)}t.some(function(t){var e=this;return this._project=t,setTimeout(function(){e._map.fire("projectchange",{getProject:e.getProject.bind(e)})},1),!0},this)},_boundInProject:function(t,e){try{return this.isProjectHere(this._map.getCenter(),t,e)}catch(i){return!1}},_testProject:function(t,e,i){return i.latLngBounds[t](e)},_zoomInProject:function(t){return this._map.getZoom()>=t.minZoom}}),DG.Map.mergeOptions({projectDetector:!0}),DG.Map.addInitHook("addHandler","projectDetector",DG.ProjectDetector),DG.Entrance=DG.FeatureGroup.extend({options:{vectors:[],fillColor:"#0085a0",strokeColor:"#fff",enableAnimation:!0,interactive:!1,autoClose:!0},statics:{SHOW_FROM_ZOOM:DG.Browser.svg?16:17},initialize:function(t){DG.setOptions(this,t),DG.FeatureGroup.prototype.initialize.call(this,t),this._initArrows()},onAdd:function(t){DG.FeatureGroup.prototype.onAdd.call(this,t),
this._map=t,this._eventHandler=new DG.Entrance.EventHandler(t,this,this.options),this._eventHandler.enable(),this.eachLayer(function(t){t.setStyle({visibility:"hidden"})}),this._isShown=!1,this.show(!1)},onRemove:function(t){DG.FeatureGroup.prototype.onRemove.call(this,t),this._isShown=!1,this._map.fire("entrancehide"),this._map=null,this._eventHandler.disable(),this._eventHandler=null},show:function(t){var e=this;return this._layers?(t!==!1&&this.fitBounds(),this._isAllowedZoom()&&(this.eachLayer(function(t){t.setStyle({visibility:"visible"}),e.options.enableAnimation&&DG.Path.ANIMATION_AVAILABLE&&t.runAnimation("animateArrowPathGeom")}),this._isShown||(this._map.fire("entranceshow"),this._isShown=!0)),this):this},hide:function(){return this.isShown()&&this._layers&&(this.eachLayer(function(t){t.setStyle({visibility:"hidden"})}),this._isShown=!1,this._map.fire("entrancehide")),this},isShown:function(){return this._isShown},setFillColor:function(t){this.eachLayer(function(e){"fill"==e.options.type&&e.setStyle({color:t})})},setStrokeColor:function(t){this.eachLayer(function(e){"stroke"==e.options.type&&e.setStyle({color:t})})},_initArrows:function(){this.options.vectors.map(function(t){return DG.Wkt.toLatLngs(t)}).forEach(function(t){DG.Browser.ielt9||this.addLayer(DG.Entrance.arrow(t,this._getArrowStrokeOptions())),this.addLayer(DG.Entrance.arrow(t,this._getArrowOptions()))},this)},_getFitZoom:function(){return this._map.projectDetector.getProject().maxZoom||DG.Entrance.SHOW_FROM_ZOOM},fitBounds:function(){var t,e=this._map,i=this.getBounds();return e.getBounds().contains(i)&&this._isAllowedZoom()||(t=this._getFitZoom(),e.projectDetector.getProject()||e.once("moveend",function(){e.setZoom(this._getFitZoom())},this),e.setView(i.getCenter(),t,{animate:!0})),this},_isAllowedZoom:function(){return this._map.getZoom()>=DG.Entrance.SHOW_FROM_ZOOM},_getArrowStrokeOptions:function(){return{type:"stroke",enableAnimation:this.options.enableAnimation,interactive:this.options.interactive,color:this.options.strokeColor,weight:6,byZoom:{16:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M9.313,18.984c2.246-1.468,7.101-5.562,7.101-5.562c0.781-0.781,0.781-2.047,0-2.828c0,0-5.242-4.023-7.101-5.102C9.74,5.354,8.583,5.93,8.125,6.5C7.902,6.777,9,11.614,9,11.614v0.789c0,0-0.879,4.237-0.905,5.285C8.09,17.891,9.108,19.118,9.313,18.984z"}},lastPointOffset:2,vmlEndArrow:"none",weight:6,iconWidth:4},17:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M7.912,21.498c3.106-2.029,9.859-7.873,9.859-7.873c2.059-1.807,2.142-1.542,0.146-3.208c0,0-7.434-6.084-10.005-7.576C7.583,2.649,6.903,3.446,6.271,4.233c-0.308,0.384,2.209,6.051,2.209,6.051v3.388c0,0-2.215,4.583-2.25,6.03C6.222,19.986,7.629,21.684,7.912,21.498z"}},lastPointOffset:0,vmlEndArrow:"none",weight:7,iconWidth:6},18:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M7.61,22.688c4.045-2.642,11.312-8.906,11.312-8.906c1.92-1.781,1.938-2-0.124-3.781c0,0-8.151-6.334-11.5-8.276C6.87,1.475,5.516,2.62,5.732,3.093c2.146,4.694,2.063,4.741,2.612,7.469l0.016,2.75c0,0-1.573,5.458-2.619,7.958C5.599,21.611,7.241,22.93,7.61,22.688z"}},lastPointOffset:DG.Browser.vml?-2:-5,vmlEndArrow:"none",weight:8,iconWidth:8},19:{marker:{viewBox:"0 0 24 24",refX:12,refY:12,markerHeight:27,markerWidth:27,path:{d:"M6.254472,23.8475c4.560355,-2.972281 12.747538,-10.032785 12.747538,-10.032785c2.167521,-2.006556 2.178242,-2.253353 -0.13949,-4.25991c0,0 -9.185101,-7.13562 -12.962148,-9.324594c-0.482861,-0.278985 -2.006558,1.008645 -1.759761,1.534428c2.414306,5.290015 2.414306,5.290015 3.272724,8.294486l0,3.433681c0,0 -2.081665,5.933829 -3.261997,8.755889c-0.160951,0.386288 1.684652,1.867062 2.103134,1.598804z"}},lastPointOffset:DG.Browser.vml?-2:-5,vmlEndArrow:"none",weight:10,iconWidth:12}}}},_getArrowOptions:function(){return{type:"fill",enableAnimation:this.options.enableAnimation,interactive:this.options.interactive,color:this.options.fillColor,weight:3,byZoom:{16:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M11.068,13.011L9.5,17.285l6.379-5.169L9.313,7.19l1.717,3.824"}},lastPointOffset:2,weight:2,iconWidth:4},17:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M10.354,13.969l-2.184,5.18L16.993,12L7.912,5.188l2.38,4.781"}},lastPointOffset:0,weight:3,iconWidth:6},18:{marker:{refX:12,refY:12,markerHeight:24,markerWidth:24,path:{d:"M10.281,13.781L7.42,21.271l11.488-9.308L7.083,3.093L10.219,10"}},lastPointOffset:DG.Browser.vml?0:-5,weight:4,iconWidth:8},19:{marker:{refX:12,refY:12,markerHeight:27,markerWidth:27,path:{d:"M9.344783,13.814714l-3.326375,8.476902l12.983603,-10.51565l-13.305513,-9.979137l3.648286,7.940389"}},lastPointOffset:DG.Browser.vml?0:-5,weight:5,iconWidth:12}}}}}),DG.Path.ANIMATION_AVAILABLE=DG.Browser.svg&&!DG.Browser.mobileWebkit&&-1===navigator.userAgent.toLowerCase().indexOf("presto")&&"[object Function]"===Object.prototype.toString.call(DG.SVG.create("animate").beginElement),DG.Path.include(DG.Path.ANIMATION_AVAILABLE?{runAnimation:function(){var t=this._animationEl=this._addAnimation();return t&&(t.beginElement(),this._removeAnimation(t)),this},stopAnimation:function(t){return this.animations[t]&&this.animations[t].endElement(),this},_addAnimation:function(){var t=this.options.animation,e=this._rings[0],i=null;return t&&e.length>0&&(i=DG.SVG.create("animate"),t.getValues&&(t.values=t.getValues(e)),Object.keys(t).filter(function(e){return"[object Function]"!=={}.toString.call(t[e])}).forEach(function(e){i.setAttribute(e,t[e])}),this._path.appendChild(i)),i},_removeAnimation:function(t){this._map.once("zoomstart",function(){if(t)try{this._path.removeChild(t)}catch(e){}this._animationEl=null},this)}}:{}),DG.Entrance.Arrow=DG.Polyline.extend({initialize:function(t,e){e=e||{},this._setLatLngs(t),e.enableAnimation&&DG.Path.ANIMATION_AVAILABLE&&(e.animation=this.getArrowAnimation(this._convertLatLngs(t))),this._markers=[],L.setOptions(this,e)},onAdd:function(t){var e=this._renderer=t.getArrowRenderer();e._initPath(this),this._project(),this._update(),this._updateStyleByZoom(),e._addPath(this),e._initMarkers(this)},onRemove:function(t){DG.Polyline.prototype.onRemove.call(this,t),this._renderer._removeMarkers(this)},getEvents:function(){return{viewreset:this._reset,moveend:this._update,zoomend:this._updateStyleByZoom}},_projectLatlngs:function(t,e,i){DG.Polyline.prototype._projectLatlngs.call(this,t,e,i),this._offsetLastPathPoint()},_update:function(){DG.Polyline.prototype._update.call(this),this._renderer._updateMarker(this)},_updateStyleByZoom:function(){this._project();var t=this.options.byZoom,e=this._map.getZoom();this.setStyle(t[e])},_offsetLastPathPoint:function(){var t,e,i,n=this._rings[0],o=this.options.byZoom[this._map.getZoom()],r=n.length,s=n[r-1].distanceTo(n[r-2]);o&&(e={x:n[r-1].x-n[r-2].x,y:n[r-1].y-n[r-2].y},s>o.iconWidth?(t=Math.abs(o.lastPointOffset/s),i={x:e.x*t,y:e.y*t},o.lastPointOffset>0?(n[r-1].x+=i.x,n[r-1].y+=i.y):(n[r-1].x-=i.x,n[r-1].y-=i.y)):(t=s/o.iconWidth,0!==e.x&&(n[r-1].x=n[r-2].x+e.x/t),0!==e.y&&(n[r-1].y=n[r-2].y+e.y/t)))}}),DG.Entrance.arrow=function(t,e){return new DG.Entrance.Arrow(t,e)},DG.Entrance.Arrow.SVG=DG.SVG.extend({getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._onMoveEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),DG.Browser.ie&&(t.mousemove=t.zoomend=this._refresh),t},_onMoveEnd:function(t){DG.Browser.ie&&this._refresh(),this._update(t)},_initMarkers:function(t){var e,i,n=t.options.byZoom,o=t._markerId="arrow-marker-"+DG.Util.stamp(t);Object.keys(n).map(function(r){e=DG.SVG.create("marker"),i=n[r].marker,Object.keys(i).filter(function(t){return"polygon"!==t&&"path"!==t}).forEach(function(t){e.setAttribute(t,i[t])}),e.id=o+"-"+r,e.setAttribute("orient","auto"),e.setAttribute("markerUnits","userSpaceOnUse"),e.setAttribute("stroke-width","0"),i.path&&e.appendChild(this._getMarkerChild("path",i.path,t)),i.polygon&&e.appendChild(this._getMarkerChild("polygon",i.polygon,t)),t._markers.push(e),this._getDefs().appendChild(e)},this),this._updateMarker(t)},_getMarkerChild:function(t,e,i){var n=DG.SVG.create("path"),o="path"===t?"d":"points";return n.setAttribute(o,e[o]),n.setAttribute("fill",e.color?e.color:i.options.color),n},_getDefs:function(){return this._defs=this._defs||DG.SVG.create("defs"),this._defs.parentNode||this._container.appendChild(this._defs),this._defs},_updateMarker:function(t){if(t._map){var e=t._map.getZoom(),i=t._map.getBounds(),n=t._latlngs[t._latlngs.length-1],o=e>=DG.Entrance.SHOW_FROM_ZOOM&&i.contains(n)?t._markerId+"-"+e:"";t._path.setAttribute("marker-end","url(#"+o+")")}},_removeMarkers:function(t){var e=this._getDefs(),i=t._markers;(e||i)&&(i.forEach(function(t){e.removeChild(t)}),i.length=0)},_refresh:function(){this._container.parentNode.insertBefore(this._container,this._container)},_updateStyle:function(t){var e=t._path,i=t.options;DG.SVG.prototype._updateStyle.call(this,t),e.setAttribute("visibility",i.visibility),t._markers.forEach(function(t){t.setAttribute("fill-opacity",i.opacity);for(var e=t.getElementsByTagName("path"),n=0;n<e.length;n++)e[n].setAttribute("fill",i.color)}),this._updateMarker(t)}}),L.Map.include({getArrowRenderer:function(){var t=this._arrowRenderer;return t||(t=this._arrowRenderer=new DG.Entrance.Arrow.SVG),this.hasLayer(t)||this.addLayer(t),t}}),DG.Entrance.Arrow.SVG.include(L.Browser.vml?{_initMarkers:function(t){t._markers=L.SVG.create("stroke"),this._updateMarker(t),t._container.appendChild(t._markers)},_updateMarker:function(t){if(t._map){var e=t.options.byZoom[t._map.getZoom()];t._markers.endarrow=e&&e.vmlEndArrow?e.vmlEndArrow:"classic"}},_removeMarkers:function(t){t._container.removeChild(t._markers)},_updateStyle:function(t){var e=t.options,i=t._container;DG.SVG.prototype._updateStyle.call(this,t),e.visibility&&(i.style.visibility=e.visibility)}}:{}),DG.Browser.svg&&DG.Entrance.Arrow.include({getArrowAnimation:function(t){var e={id:"animateArrowPathGeom",attributeName:"d",fill:"freeze",begin:"indefinite"};return e.getValues=this._getAnimationValues(t.length),e.keyTimes=this._getAnimateTiming(t),e.dur=this._getAnimationTime(t.length),e},_getAnimationValues:function(t){return 2===t?this._getShakeAnimationValues:this._getSlideAnimationValues},_getSlideAnimationValues:function(t){var e="",i="",n="",o="M "+t[0].x+" "+t[0].y,r="l -1 0";e=o+" "+r+"; ";for(var s=1;s<t.length;s++){if(n+=t[s].x-t[s-1].x+" "+(t[s].y-t[s-1].y),s===t.length-1){n=t[s].x-t[s-1].x+" "+(t[s].y-t[s-1].y),e+=o+" l "+i+n+";";break}e+=o+" l "+n+"; ",e+=o+" l "+n+" "+r+"; ",n+=" l ",i+=t[s].x-t[s-1].x+" "+(t[s].y-t[s-1].y)+" l "}return e},_getShakeAnimationValues:function(t){var e,i,n=[1,.4,1,.84,1,.94,1],o=t[1].x-t[0].x,r=t[1].y-t[0].y,s=" l "+o+" "+r;return e=t[0].x-o,i=t[0].y-r,n.reduce(function(t,n){return t+" M "+(e+o*n)+" "+(i+r*n)+s+";"},"M "+e+" "+i+s+"; ")},_getPolylineLength:function(t){for(var e=0,i=1;i<t.length;i++)e+=t[i-1].distanceTo(t[i]);return e},_getAnimateTiming:function(t){var e,i,n,o=[0],r=this._getPolylineLength(t);if(2===t.length)e="0; 0.33; 0.495; 0.66; 0.77; 0.88; 0.935; 1";else if(3===t.length)e="0; 0.33; 0.34; 1";else if(4===t.length)e="0; 0.25; 0.26; 0.5; 0.51; 1";else{for(var s=1;s<t.length;s++)n=t[s-1].distanceTo(t[s]),i=n/r,o.push(o[o.length-1]+i),s<t.length-1?o.push(o[o.length-1]):o[o.length-1]=1;e=o.join("; ")}return e},_getAnimationTime:function(t){return 2===t?"0.7s":3===t||4===t?"0.5s":"0.7s"}}),DG.Entrance.EventHandler=DG.Handler.extend({options:{autoClose:!0},initialize:function(t,e,i){DG.Util.setOptions(this,i),this._map=t,this._entrance=e},addHooks:function(){this._map.on({zoomend:this._showOrHideEntrance,projectleave:this._showOrHideEntrance},this),this.options.autoClose&&this._map.on("layeradd",this._removeEntrance,this)},removeHooks:function(){this._map.off({zoomend:this._showOrHideEntrance,projectleave:this._showOrHideEntrance},this),this.options.autoClose&&this._map.off("layeradd",this._removeEntrance,this)},_showOrHideEntrance:function(){this._map.getZoom()>=DG.Entrance.SHOW_FROM_ZOOM?this._entrance.show(!1):this._entrance.hide()},_removeEntrance:function(t){(t.layer instanceof DG.Popup||t.layer instanceof DG.Entrance&&t.layer!==this._entrance)&&this._entrance.removeFrom(this._map)}}),DG.Label=DG.Layer.extend({options:{offset:new DG.Point(12,15),className:"dg-label",zIndexOffset:0},_typeOfString:Object.prototype.toString.call("s"),_defaultZIndex:100,initialize:function(t,e){DG.Util.setOptions(this,e),this._animated=DG.Browser.any3d,this._content=t},onAdd:function(t){this._map=t,this._el||this._initDOM(),this._visible=!0,this.setContent(this._content)._onViewReset(),t.on("viewreset",this._onViewReset,this).on("zoomanim",this._onZoomAnimation,this)},onRemove:function(t){t.off("viewreset",this._onViewReset,this).off("zoomanim",this._onZoomAnimation,this),this._visible=!1,this._el.removeChild(this._container),DG.Util.falseFn(this._container.offsetWidth),this._container=null,t.getPanes().markerPane.removeChild(this._el),this._el=null},_initDOM:function(){this._el=DG.DomUtil.create("div",this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),this._map.getPanes().markerPane),this._el.style.zIndex=this._defaultZIndex+this.options.zIndexOffset,this._container=DG.DomUtil.create("div",this.options.className+"__content",this._el),DG.DomUtil.disableTextSelection(this._container),DG.DomEvent.disableClickPropagation(this._el).on(this._container,"mousewheel",DG.DomEvent.stopPropagation).on(this._container,"contextmenu",DG.DomEvent.stopPropagation)},_onViewReset:function(){this._visible&&this._latlng&&DG.DomUtil.setPosition(this._el,this._map.latLngToLayerPoint(this._latlng).add(this.options.offset),DG.Browser.ie)},_onZoomAnimation:function(t){this._latlng&&DG.DomUtil.setPosition(this._el,this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).add(this.options.offset))},setOffset:function(t){return t instanceof DG.Point&&(this.options.offset=t,this._onViewReset()),this},setZIndexOffset:function(t){return isNaN(+t)||(this.options.zIndexOffset=+t,this._visible&&(this._el.style.zIndex=this._defaultZIndex+this.options.zIndexOffset)),this},setContent:function(t){return Object.prototype.toString.call(t)!==this._typeOfString?this:(this._content=t,this._visible&&(this._container.innerHTML=t),this)},setPosition:function(t){return t instanceof DG.LatLng?(this._latlng=t,this._onViewReset(),this):this}}),DG.label=function(t,e){return new DG.Label(t,e)},DG.Marker.include({bindLabel:function(t,e){return this._label?(this._label.setContent(t),e&&(this.options.offset!==e.offset&&this._label.setOffset(this.options.offset=e.offset),this.options["static"]!==e["static"]&&this.unbindLabel().bindLabel(t,e))):(e=DG.extend({offset:new DG.Point(5,5)},e),this._label=DG.label(t,e),this.once("remove",this._onMarkerRemove),e["static"]?this.showLabel():this.on("mouseover",this._mouseOverLabel).on("mouseout",this._mouseOutLabel).on("dragstart",this._dragStartLabel).on("dragend",this._dragEndLabel),"undefined"!=typeof this._map?this._updateLabelZIndex():this.once("add",this._updateLabelZIndex)),this},unbindLabel:function(){return this._label&&(this.hideLabel().off("remove",this.unbindLabel).off("mouseover",this._mouseOverLabel).off("mouseout",this._mouseOutLabel).off("dragstart",this._dragStartLabel).off("dragend",this._dragEndLabel).off("move",this._updatePosition).off("add",this._updateLabelZIndex),this._label=null),this},_onMarkerRemove:function(){if(this._label){var t=this._label._content;this.once("add",function(){this._label||this.bindLabel(t)}),this.unbindLabel()}},getLabel:function(){return this._label?this._label:null},_originalUpdateZIndex:DG.Marker.prototype._updateZIndex,_updateZIndex:function(t){return this._zIndex||(this._zIndex=0),this._originalUpdateZIndex(t),this._updateLabelZIndex(),this},_updateLabelZIndex:function(){return this._label&&this._icon&&this._label.setZIndexOffset(this._icon.style.zIndex),this},showLabel:function(){return this._label&&this.on("move",this._updatePosition)._map.addLayer(this._label.setPosition(this.getLatLng())),this},hideLabel:function(){return this._label&&this.off("move",this._updatePosition)._map.removeLayer(this._label),this},_updatePosition:function(){this._label.setPosition(this.getLatLng())},_dragStartLabel:function(){this._label.isMarkerDragging=!0,this.hideLabel()},_dragEndLabel:function(){this._label.isMarkerDragging=!1,this._label.isMouseOverMarker&&this.showLabel()},_mouseOverLabel:function(){this._label.isMouseOverMarker=!0,this._label.isMarkerDragging||this.showLabel()},_mouseOutLabel:function(){this._label.isMouseOverMarker=!1,this.hideLabel()}}),DG.Marker.addInitHook(function(){"undefined"!=typeof this.options.label&&this.bindLabel(this.options.label)}),DG.Path.include({bindLabel:function(t,e){return this._label?(this._label.setContent(t),this._label.options.offset!==e.offset&&this._label.setOffset(e.offset)):(this._label=DG.label(t,e),this.on(this._labelEvents,this)),this},unbindLabel:function(){return this._label&&(this.off(this._labelEvents,this),this._map.removeLayer(this._label),this._label=null),this},getLabel:function(){return this._label?this._label:null},_labelEvents:{mouseover:function(t){this._map.addLayer(this._label.setPosition(t.latlng))},mousemove:function(t){this._label.setPosition(t.latlng)},mouseout:function(){this._map.removeLayer(this._label)},remove:function(){this._map.removeLayer(this._label)}}}),DG.Path.addInitHook(function(){"undefined"!=typeof this.options.label&&this.bindLabel(this.options.label)}),DG.Entrance.include({bindLabel:function(t,e){return this._label?(this._label.setContent(t),this._label.options.offset!==e.offset&&this._label.setOffset(e.offset)):(this._label=DG.label(t,e),this.on(this._labelEvents,this)),this},unbindLabel:function(){return this._label&&(this.off(this._labelEvents,this),this._map.removeLayer(this._label),this._label=null),this},getLabel:function(){return this._label?this._label:null},_labelEvents:{mouseover:function(t){this._map.addLayer(this._label.setPosition(t.latlng))},mousemove:function(t){this._label.setPosition(t.latlng)},mouseout:function(){this._label.remove()},remove:function(){this._label.remove()}}}),DG.Entrance.addInitHook(function(){"undefined"!=typeof this.options.label&&this.bindLabel(this.options.label)}),DG.configTheme=DG.configTheme||{},DG.configTheme.balloonOptions={offset:{x:1,y:-43}},function(t,e){"use strict";function i(e,i,n){e._eventHandlers=e._eventHandlers||[{element:e.scroller,handler:function(t){e.scroll(t)},type:"scroll"},{element:e.bar,handler:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e.selection(),e.drag.now=1},type:"touchstart mousedown"},{element:document,handler:function(){e.selection(1),e.drag.now=0},type:"mouseup blur touchend"},{element:e.bar,handler:function(t){2!=t.button&&e._pos0(t)},type:"touchstart mousedown"},{element:document,handler:function(t){e.drag.now&&e.drag(t)},type:"mousemove touchmove"},{element:t,handler:function(){e.update()},type:"resize"},{element:e.root,handler:function(){e.update()},type:"sizeChange"}],h(e._eventHandlers,function(t){t.element&&i(t.element,t.type,t.handler,n)})}function n(t,e,i){var n="data-baron-"+e;if("on"==i)t.setAttribute(n,"inited");else{if("off"!=i)return t.getAttribute(n);t.removeAttribute(n)}}function o(t){if(!n(t.root,t.direction)){var e=new p.prototype.constructor(t);return i(e,t.event,"on"),n(e.root,t.direction,"on"),e.update(),e}}function r(t){var e={};t=t||{};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function s(t){var e=r(t);e.direction=e.direction||"v";var i=t.event||function(t,i,n,o){e.$(t)[o||"on"](i,n)};return e.event=function(t,e,n,o){h(t,function(t){i(t,e,n,o)})},e}function a(t){if(this.events&&this.events[t])for(var e=0;e<this.events[t].length;e++){var i=Array.prototype.slice.call(arguments,1);this.events[t][e].apply(this,i)}}if(t){var l=t.baron,u=t.jQuery,c={v:{x:"Y",pos:"top",crossPos:"left",size:"height",crossSize:"width",client:"clientHeight",crossClient:"clientWidth",offset:"offsetHeight",crossOffset:"offsetWidth",offsetPos:"offsetTop",scroll:"scrollTop",scrollSize:"scrollHeight"},h:{x:"X",pos:"left",crossPos:"top",size:"width",crossSize:"height",client:"clientWidth",crossClient:"clientHeight",offset:"offsetWidth",crossOffset:"offsetHeight",offsetPos:"offsetLeft",scroll:"scrollLeft",scrollSize:"scrollWidth"}},h=function(i,n){var o=0;for(i.length!==e&&i!==t||(i=[i]);i[o];)n.call(this,i[o],o),o++},d=function(e){var i,n,o=!1;return e=e||{},n=e.$||t.jQuery,o?e.root=i=this:i=n(e.root||e.scroller),new d.fn.constructor(i,e,n)};d.fn={constructor:function(t,e,i){var n=s(e);n.$=i,h.call(this,t,function(t,e){var i=r(n);n.root&&n.scroller?(i.scroller=n.$(n.scroller,t),i.scroller.length||(i.scroller=t)):i.scroller=t,i.root=t,this[e]=o(i),this.length=e+1}),this.params=n},dispose:function(){var t=this.params;h(this,function(e){e.dispose(t)}),this.params=null},update:function(){for(var t=0;this[t];)this[t].update.apply(this[t],arguments),t++},baron:function(t){return t.root=[],t.scroller=this.params.scroller,h.call(this,this,function(e){t.root.push(e.root)}),t.direction="v"==this.params.direction?"h":"v",t._chain=!0,d(t)}};var p={};p.prototype={constructor:function(t){function i(t,e){return h(t,e)[0]}function n(t){var e=this.barMinSize||20;t>0&&e>t&&(t=e),this.bar&&h(this.bar).css(this.origin.size,parseInt(t,10)+"px")}function o(t){this.bar&&h(this.bar).css(this.origin.pos,+t+"px")}function r(){return _[this.origin.client]-this.barTopLimit-this.bar[this.origin.offset]}function s(t){return t*r.call(this)+this.barTopLimit}function l(t){return(t-this.barTopLimit)/r.call(this)}function u(){return!1}var h,d,p,_,m,f,g,v,y;return y=v=(new Date).getTime(),h=this.$=t.$,this.event=t.event,this.events={},this.root=t.root,this.scroller=i(t.scroller),this.bar=i(t.bar,this.root),_=this.track=i(t.track,this.root),!this.track&&this.bar&&(_=this.bar.parentNode),this.clipper=this.scroller.parentNode,this.direction=t.direction,this.origin=c[this.direction],this.barOnCls=t.barOnCls,this.barTopLimit=0,g=1e3*t.pause||0,this.cursor=function(t){return t["client"+this.origin.x]||(((t.originalEvent||t).touches||{})[0]||{})["page"+this.origin.x]},this.pos=function(t){var i="page"+this.origin.x+"Offset",n=this.scroller[i]?i:this.origin.scroll;return t!==e&&(this.scroller[n]=t),this.scroller[n]},this.rpos=function(t){var e,i=this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client];return e=t?this.pos(t*i):this.pos(),e/(i||1)},this.barOn=function(t){this.barOnCls&&(t||this.scroller[this.origin.client]>=this.scroller[this.origin.scrollSize]?h(this.root).removeClass(this.barOnCls):h(this.root).addClass(this.barOnCls))},this._pos0=function(t){p=this.cursor(t)-d},this.drag=function(t){this.scroller[this.origin.scroll]=l.call(this,this.cursor(t)-p)*(this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client])},this.selection=function(t){this.event(document,"selectpos selectstart",u,t?"off":"on")},this.resize=function(){function e(){var e=i.scroller[i.origin.crossOffset]-i.scroller[i.origin.crossClient];t.freeze&&!i.clipper.style[i.origin.crossSize]&&h(i.clipper).css(i.origin.crossSize,i.clipper[i.origin.crossClient]-e+"px"),h(i.scroller).css(i.origin.crossSize,i.clipper[i.origin.crossClient]+e+"px"),Array.prototype.unshift.call(arguments,"resize"),a.apply(i,arguments),y=(new Date).getTime()}var i=this,n=0;(new Date).getTime()-y<g&&(clearTimeout(m),n=g),n?m=setTimeout(e,n):e()},this.scroll=function(){function t(){l.bar&&(i=(_[l.origin.client]-l.barTopLimit)*l.scroller[l.origin.client]/l.scroller[l.origin.scrollSize],e!=i&&(n.call(l,i),e=i),d=s.call(l,l.rpos()),o.call(l,d)),Array.prototype.unshift.call(arguments,"scroll"),a.apply(l,arguments),v=(new Date).getTime()}var e,i,r=0,l=this;(new Date).getTime()-v<g&&(clearTimeout(f),r=g),r?f=setTimeout(t,r):t()},this},update:function(t){return a.call(this,"upd",t),this.resize(1),this.barOn(),this.scroll(),this},dispose:function(t){i(this,this.event,"off"),n(this.root,t.direction,"off"),u(this.scroller).css(this.origin.crossSize,""),this.barOn(!0),a.call(this,"dispose")},on:function(t,e,i){for(var n=t.split(" "),o=0;o<n.length;o++)"init"==n[o]?e.call(this,i):(this.events[n[o]]=this.events[n[o]]||[],this.events[n[o]].push(function(t){e.call(this,t||i)}))}},d.fn.constructor.prototype=d.fn,p.prototype.constructor.prototype=p.prototype,d.noConflict=function(){return t.baron=l,d},d.version="0.6.6",u&&u.fn&&(u.fn.baron=d),t.baron=d,t.module&&module.exports&&(module.exports=d.noConflict())}}(window),function(t,e){var n=function(t){function n(t,i){a<(l.minView||0)&&(i=e),i!==e?(i+="px",this.$(s[t]).css(this.origin.pos,i).addClass(l.outside)):this.$(s[t]).css(this.origin.pos,"").removeClass(l.outside)}function o(t){try{i=document.createEvent("WheelEvent"),i.initWebKitWheelEvent(t.originalEvent.wheelDeltaX,t.originalEvent.wheelDeltaY),d.dispatchEvent(i),t.preventDefault()}catch(t){}}function r(t){var e;for(var i in t)l[i]=t[i];if(s=this.$(l.elements,this.scroller)){a=this.scroller[this.origin.client];for(var n=0;n<s.length;n++)e={},e[this.origin.size]=s[n][this.origin.offset],s[n].parentNode!==this.scroller&&this.$(s[n].parentNode).css(e),e={},e[this.origin.crossSize]=s[n].parentNode[this.origin.crossClient],this.$(s[n]).css(e),a-=s[n][this.origin.offset],h[n]=s[n].parentNode[this.origin.offsetPos],u[n]=u[n-1]||0,c[n]=c[n-1]||Math.min(h[n],0),s[n-1]&&(u[n]+=s[n-1][this.origin.offset],c[n]+=s[n-1][this.origin.offset]),0==n&&0==h[n]||(this.event(s[n],"mousewheel",o,"off"),this.event(s[n],"mousewheel",o));l.limiter&&s[0]&&(this.track&&this.track!=this.scroller?(e={},e[this.origin.pos]=s[0].parentNode[this.origin.offset],this.$(this.track).css(e)):this.barTopLimit=s[0].parentNode[this.origin.offset],this.scroll()),l.limiter===!1&&(this.barTopLimit=0)}var r={element:s,handler:function(){for(var t,e=_(this)[0].parentNode,i=e.offsetTop,n=0;n<s.length;n++)s[n]===this&&(t=n);var o=i-u[t];l.scroll?l.scroll({x1:m.scroller.scrollTop,x2:o}):m.scroller.scrollTop=o},type:"click"};l.clickable&&(this._eventHandlers.push(r),p(r.element,r.type,r.handler,"off"),p(r.element,r.type,r.handler,"on"))}var s,a,l={outside:"",before:"",after:"",past:"",future:"",radius:0,minView:0},u=[],c=[],h=[],d=this.scroller,p=this.event,_=this.$,m=this;this.on("init",r,t),this.on("init scroll",function(){var t,i,o=[];if(s){for(var r,d=0;d<s.length;d++)t=0,h[d]-this.pos()<c[d]+l.radius?(t=1,i=u[d]):h[d]-this.pos()>c[d]+a-l.radius?(t=2,i=u[d]+a):(t=3,i=e),t!=o[d]&&(n.call(this,d,i),o[d]=t,r=!0);if(r)for(d=0;d<s.length;d++)1==o[d]&&l.past&&this.$(s[d]).addClass(l.past).removeClass(l.future),2==o[d]&&l.future&&this.$(s[d]).addClass(l.future).removeClass(l.past),3==o[d]&&(l.future||l.past)&&this.$(s[d]).removeClass(l.past).removeClass(l.future),o[d]!=o[d+1]&&1==o[d]&&l.before?this.$(s[d]).addClass(l.before).removeClass(l.after):o[d]!=o[d-1]&&2==o[d]&&l.after?this.$(s[d]).addClass(l.after).removeClass(l.before):this.$(s[d]).removeClass(l.before).removeClass(l.after)}}),this.on("resize upd",function(t){r.call(this,t&&t.fix)})};baron.fn.fix=function(t){for(var e=0;this[e];)n.call(this[e],t),e++;return this}}(window),function(t,e){var i=function(t){var e,i,n,o,r=this;o=t.screen||.9,t.forward&&(e=this.$(t.forward,this.clipper),this.event(e,"click",function(){var e=r.pos()-t.delta||30;r.pos(e)})),t.backward&&(i=this.$(t.backward,this.clipper),this.event(i,"click",function(){var e=r.pos()+t.delta||30;r.pos(e)})),t.track&&(n=t.track===!0?this.track:this.$(t.track,this.clipper)[0],n&&this.event(n,"mousedown",function(t){var e=t["offset"+r.origin.x],i=r.bar[r.origin.offsetPos],n=0;i>e?n=-1:e>i+r.bar[r.origin.offset]&&(n=1);var s=r.pos()+n*o*r.scroller[r.origin.client];r.pos(s)}))};baron.fn.controls=function(t){for(var e=0;this[e];)i.call(this[e],t),e++;return this}}(window),function(t,e){var i=function(t){function e(){return g.scroller[g.origin.scroll]+g.scroller[g.origin.offset]}function i(){return g.scroller[g.origin.scrollSize]}function n(){return g.scroller[g.origin.client]}function o(t,e){var i=5e-4*t;return Math.floor(e-i*(t+550))}function r(t){c=t,t?(s(),a=setInterval(s,200)):clearInterval(a)}function s(){var s,a,c={},w=e(),D=i(),k=1==v;if(a=0,v>0&&(a=40),s=o(L,a),w>=D-L&&v>-1?k&&(L+=s):L=0,0>L&&(L=0),c[d]=L+"px",n()<=i()){g.$(h).css(c);for(var P=0;P<m.length;P++)g.$(m[P].self).css(m[P].property,Math.min(L/p*100,100)+"%")}f&&L&&g.$(g.root).addClass(f),0==L&&t.onCollapse&&t.onCollapse(),v=0,l=setTimeout(function(){v=-1},b),_&&L>p&&!u&&(_(),u=!0),0==L?y++:y=0,y>1&&(r(!1),u=!1,f&&g.$(g.root).removeClass(f))}var a,l,u,c,h=this.$(t.block),d=t.size||this.origin.size,p=t.limit||80,_=t.onExpand,m=t.elements||[],f=t.inProgress||"",g=this,v=0,y=0,L=0,b=t.waiting||500;this.on("init",function(){r(!0)}),this.on("dispose",function(){r(!1)}),this.event(this.scroller,"mousewheel DOMMouseScroll",function(t){var n=t.wheelDelta<0||t.originalEvent&&t.originalEvent.wheelDelta<0||t.detail>0;n&&(v=1,clearTimeout(l),!c&&e()>=i()&&r(!0))})};baron.fn.pull=function(t){for(var e=0;this[e];)i.call(this[e],t),e++;return this}}(window),function(){var t=DG.configTheme.balloonOptions.offset.x,e=DG.configTheme.balloonOptions.offset.y,i=DG.Popup.prototype.initialize,n=DG.Popup.prototype._initLayout,o=DG.Popup.prototype.onAdd,r=DG.Popup.prototype._adjustPan,s=baron.noConflict(),a=function(t){this[0]=t,this.length=1};a.prototype={setAttribute:function(t,e){return this[0].setAttribute(t,e),this},getAttribute:function(t){return this[0].getAttribute(t)},removeAttribute:function(t){return this[0].removeAttribute(t),this},css:function(t,e){return e?(this[0].style[t]=e,this):DG.DomUtil.getStyle(this[0],t)}},DG.Popup.prototype.options.offset=DG.point(t,e),DG.Popup.mergeOptions({border:16,mapControlsWidth:60}),DG.Popup.include({_headerContent:null,_footerContent:null,_scroller:null,_scrollerBar:null,_barWrapper:null,_baron:null,_isBaronExist:!1,_popupShowClass:"leaflet-popup_show_true",_popupHideClass:"leaflet-popup_show_false",_popupTipClass:"leaflet-popup-tip-container",_tipSVGPath:"M0 0c12.643 0 28 7.115 28 44h2c0-36.885 15.358-44 28-44h-58z",_isAutoPanPaddingUserDefined:!1,initialize:function(t,e){this._popupStructure={},this._isAutoPanPaddingUserDefined=t&&t.hasOwnProperty("autoPanPadding"),i.call(this,t,e)},onAdd:function(t){t.on({entranceshow:this._closePopup,resize:this.resize},this),o.call(this,t),this._animateOpening()},onRemove:function(t){this._animateClosing(),t.off({entranceshow:this._closePopup,resize:this.resize},this),DG.DomUtil.TRANSITION?this._removeTimeout=setTimeout(L.bind(L.DomUtil.remove,L.DomUtil,this._container),200):L.DomUtil.remove(this._container),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this},!0)},setContent:function(t){return this._isNode(t)||"object"!=typeof t?this._bodyContent=t:Object.keys(t).forEach(function(e){this["_"+e+"Content"]=t[e]},this),this.update(),this},setHeaderContent:function(t){return this._headerContent=t,this.update(),this},setFooterContent:function(t){return this._footerContent=t,this.update(),this},getContent:function(){return this._bodyContent},getHeaderContent:function(){return this._headerContent},getFooterContent:function(){return this._footerContent},clear:function(){return Object.keys(this._popupStructure).forEach(this._clearElement,this),this._isBaronExist=!1,this},clearHeader:function(){return this._clearElement("header")},clearFooter:function(){return this._clearElement("footer")},findElement:function(t){return this._contentNode.querySelector(t)},_animateOpening:function(){DG.DomUtil.addClass(this._innerContainer,this._popupShowClass),DG.DomUtil.removeClass(this._innerContainer,this._popupHideClass)},_animateClosing:function(){DG.DomUtil.addClass(this._innerContainer,this._popupHideClass),DG.DomUtil.removeClass(this._innerContainer,this._popupShowClass)},_closePopup:function(){this._map.closePopup(this)},_isNode:function(t){
return!!t.nodeName},_initLayout:function(){n.call(this),this._innerContainer=DG.DomUtil.create("div","leaflet-popup-inner "+this._popupHideClass,this._container),DG.DomEvent.disableClickPropagation(this._innerContainer),this.options.closeButton&&this._innerContainer.appendChild(this._detachEl(this._closeButton)),this._innerContainer.appendChild(this._detachEl(this._wrapper));var t=this._detachEl(this._tipContainer);if(DG.Browser.svg){var e=DG.SVG.create("path"),i=this._popupTipClass+" "+this._popupTipClass+"_svg";e.setAttribute("d",this._tipSVGPath),t=DG.SVG.create("svg"),t.setAttribute("class",i),t.appendChild(e),DG.DomEvent.disableClickPropagation(e)}else DG.DomUtil.addClass(t,this._popupTipClass+"_image"),DG.DomEvent.disableClickPropagation(t);this._innerContainer.appendChild(t)},_clearElement:function(t){return this["_"+t+"Content"]=null,this._detachEl(this._popupStructure[t]),delete this._popupStructure[t],this},_updateScrollPosition:function(){this._baron&&this._baron.update()},resize:function(){var t=this._updateLayout();if(this._updatePosition(),t)if(this._isBaronExist){DG.DomUtil.removeClass(this._scroller,"dg-scroller_hidden_true"),DG.DomUtil.addClass(this._scroller,"dg-scroller");var e=this._isBaronExist?this._scroller.scrollTop:!1;e&&(this._scroller.scrollTop=e);var i=this.options.maxHeight-2*this.options.border-this._getDelta();this._scrollerWrapper.style.height=i+"px",this._updateScrollPosition()}else this._isContentHeightEnough()||(this._initBaronScroller(),this._initBaron());else this._isBaronExist&&(this._scrollerWrapper.style.height="",DG.DomUtil.removeClass(this._scroller,"dg-scroller"),DG.DomUtil.addClass(this._scroller,"dg-scroller_hidden_true"),DG.DomUtil.removeClass(this._scroller,"dg-scroller"),DG.DomEvent.off(this._scroller,"scroll",this._onScroll));this._adjustPan(),this._bindAdjustPanOnTransitionEnd()},_adjustPan:function(t){if(this._map){if(t)return void("max-height"===t.propertyName&&(setTimeout(r.bind(this),1),DG.DomEvent.off(this._wrapper,DG.DomUtil.TRANSITION_END,this._adjustPan)));var e=this.options;if(e.autoPan){var i=this._map,n=this._container.offsetHeight,o=this._containerWidth,s=new L.Point(this._containerLeft,-n-this._containerBottom);this._zoomAnimated&&s._add(L.DomUtil.getPosition(this._container));var a=[e.autoPanPadding[0],e.autoPanPadding[1]];!this._isAutoPanPaddingUserDefined&&this._map._container.offsetWidth>=e.maxWidth+2*e.mapControlsWidth&&(a[0]=e.mapControlsWidth);var l=i.layerPointToContainerPoint(s),u=L.point(a),c=L.point(e.autoPanPaddingTopLeft||u),h=L.point(e.autoPanPaddingBottomRight||u),d=i.getSize(),p=0,_=0;l.x+o+h.x>d.x&&(p=l.x+o-d.x+h.x),l.x-p-c.x<0&&(p=l.x-c.x),l.y+n+h.y>d.y&&(_=l.y+n-d.y+h.y),l.y-_-c.y<0&&(_=l.y-c.y),(p||_)&&i.fire("autopanstart").panBy([p,_])}}},_bindAdjustPanOnTransitionEnd:function(){DG.DomUtil.TRANSITION?DG.DomEvent.on(this._wrapper,DG.DomUtil.TRANSITION_END,this._adjustPan,this):this._adjustPan()},_isContentHeightEnough:function(){var t=this.options;if(!t.maxHeight)return!0;var e=this._popupStructure.body?this._popupStructure.body.offsetHeight+this._getDelta():this._contentNode.offsetHeight;return e+=2*t.border,e<=t.maxHeight},_initBaronScroller:function(){var t=this._popupStructure.body.parentNode,e=this._scrollerWrapper=DG.DomUtil.create("div","dg-scroller__wrapper",t),i=this._scroller=DG.DomUtil.create("div","dg-scroller",e),n=this._barWrapper=DG.DomUtil.create("div","dg-scroller__bar-wrapper",i),o=this.options.maxHeight-2*this.options.border;this._scrollerBar=DG.DomUtil.create("div","dg-scroller__bar",n),i.appendChild(this._detachEl(this._popupStructure.body)),o-=this._getDelta(),e.style.height=Math.max(18,o)+"px",e.style.width=t.offsetWidth+5+"px",this._isBaronExist=!0,this._switchEvents()},_onScroll:function(t){this.fire("scroll",{originalEvent:t})},_onClick:function(t){t.target=t.target||t.srcElement,this._moving||this.fire("click",{originalEvent:t})},_onStart:function(t){if(this._moved=!1,!this._moving){var e=t.touches?t.touches[0]:t;this._startPoint=new DG.Point(e.clientX,e.clientY),this._toggleTouchEvents()}},_onEnd:function(t){this._toggleTouchEvents(!0),this._onClick(t),this._moving=!1},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=DG.point(e.clientX,e.clientY),n=Math.abs(i.subtract(this._startPoint).y);!n||10>n||(this._moving=this._moved=!0)},_initBaron:function(){var t=this._scrollerWrapper;this._baron=s({scroller:".dg-scroller",bar:".dg-scroller__bar",track:".dg-scroller__bar-wrapper",$:function(e){var i="[object String]"==={}.toString.call(e)?t.querySelector(e):e;return new a(i)},event:function(t,e,i,n){e.split(" ").forEach(function(e){DG.DomEvent[n||"on"](t,e,i)})}})},_initHeader:function(){this._popupStructure.header=DG.DomUtil.create("header","dg-popup__header",this._contentNode)},_initFooter:function(){this._popupStructure.footer=DG.DomUtil.create("footer","dg-popup__footer",this._contentNode)},_initBodyContainer:function(){this._popupStructure.wrapper=DG.DomUtil.create("div","dg-popup__container-wrapper",this._contentNode),this._popupStructure.body=DG.DomUtil.create("div","dg-popup__container",this._popupStructure.wrapper)},update:function(){if(this._map){if(DG.Browser.ielt9||(this._container.style.visibility="hidden"),this._switchEvents(!0),this._clearNode(this._contentNode),this._isBaronExist=!1,this._headerContent&&this._initHeader(),this._bodyContent&&this._initBodyContainer(),this._footerContent&&this._initFooter(),this._updatePopupStructure(),this.resize(),DG.DomEvent.on(this._wrapper,"click",DG.DomEvent.stopPropagation),this._switchEvents(),DG.Browser.ielt9){var t=this._popupStructure.footer;t&&(t.className+=" ie8")}DG.Browser.ielt9||(this._container.style.visibility="")}},_getDelta:function(){var t=0,e=this._popupStructure;return e.header&&(t+=e.header.offsetHeight),e.footer&&(t+=e.footer.offsetHeight),t},_updateLayout:function(){var t,e=this.options,i=this._contentNode,n=this._wrapper,o=i.style,r=n.style,s="leaflet-popup-scrolled",a=!1;o.margin=e.border+"px",DG.DomUtil.removeClass(i,s),this._isContentHeightEnough()?r.maxHeight=i.offsetHeight+2*e.border+"px":(r.maxHeight=e.maxHeight+"px",DG.DomUtil.addClass(i,s),a=!0);var l=2*e.autoPanPadding[0];return e.sprawling?(t=e.maxWidth,t=Math.min(t,this._map._container.offsetWidth-l),t=Math.max(t,e.minWidth)):(r.width="",o.whiteSpace="nowrap",t=n.offsetWidth,o.whiteSpace="",t=Math.min(t,this._map._container.offsetWidth-l),t=Math.min(Math.max(t,e.minWidth),e.maxWidth)),r.width=t+"px",this._containerWidth=this._container.offsetWidth,a},_updatePopupStructure:function(){Object.keys(this._popupStructure).forEach(function(t){this._insertContent(this["_"+t+"Content"],this._popupStructure[t])},this),this.fire("contentupdate")},_insertContent:function(t,e){t&&e&&(t="function"==typeof t?t(this._source||this):t,"string"==typeof t?e.innerHTML=t:(this._clearNode(e),e.appendChild(t)))},_clearNode:function(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)},_detachEl:function(t){return t.parentNode&&t.parentNode.removeChild(t),t},_switchEvents:function(t){var e=t?"off":"on";DG.Browser.touch?DG.DomEvent[e](this._contentNode,"touchstart mousedown mousemove",this._onStart,this):DG.DomEvent[e](this._contentNode,"click",this._onClick,this),this._isBaronExist&&DG.DomEvent[e](this._scroller,"scroll",this._onScroll,this)},_toggleTouchEvents:function(t){var e=t?"off":"on";DG.DomEvent[e](this._contentNode,"touchmove",this._onMove,this)[e](this._contentNode,"touchend",this._onEnd,this)}})}(),DG.Map.include({_markerClass:"dg-customization__marker_type_mushroom",_markerShowClass:"dg-customization__marker_appear",_markerHideClass:"dg-customization__marker_disappear",_dgHideClass:"dg-popup_hidden_true",openPopup:function(t,e,i){if(!(t instanceof L.Popup)){var n=t;t=new L.Popup(i).setContent(n)}return e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,t._source&&t._source._icon&&(-1!==t._source._icon.className.indexOf(this._markerClass)?(DG.DomUtil.removeClass(t._source._icon,this._markerShowClass),DG.DomUtil.addClass(t._source._icon,this._markerHideClass)):(DG.DomUtil.addClass(t._source._icon,this._dgHideClass),t._source._shadow&&DG.DomUtil.addClass(t._source._shadow,this._dgHideClass))),this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(t._source&&t._source._icon&&(-1!==t._source._icon.className.indexOf(this._markerClass)?(DG.DomUtil.removeClass(t._source._icon,this._markerHideClass),DG.DomUtil.addClass(t._source._icon,this._markerShowClass)):(DG.DomUtil.removeClass(t._source._icon,this._dgHideClass),t._source._shadow&&DG.DomUtil.removeClass(t._source._shadow,this._dgHideClass))),this.removeLayer(t)),this}}),DG.Dictionary={},DG.Dictionary.ru={pluralRules:function(t){return t%10===1&&t%100!==11?0:t%10>=2&&4>=t%10&&t%10%1===0&&(12>t%100||t%100>14)?1:t%10===0||t%10>=5&&9>=t%10&&t%10%1===0||t%100>=11&&14>=t%100&&t%100%1===0?2:void 0}},DG.Dictionary.en={pluralRules:function(t){return 1===t?0:1}},DG.Dictionary.it={pluralRules:function(t){return 1===t?0:1}},DG.Dictionary.cs={pluralRules:function(t){return 1===t?0:t>=2&&4>=t?1:2}},DG.Dictionary.es={pluralRules:function(t){return t>=2?1:0}},DG.Locale={t:function(t,e){var i,n,o,r=this._map.getLang(),s=!1;return"undefined"==typeof this.constructor.Dictionary[r]&&(r=DG.config.defaultLang,this._map.setLang(r)),n=this.constructor.Dictionary[r][t],(s="undefined"!=typeof n)?(i=s?n:t,e!==undefined&&(e=parseInt(e,10),e=isNaN(e)?0:e,o=this.constructor.Dictionary[r].pluralRules(e),i=n[o]),i=DG.Util.template(i,{n:e}),i?i:t):t}},DG.Map.include({setLang:function(t){t&&"[object String]"===Object.prototype.toString.call(t)&&(this.options.currentLang=t,this.fire("langchange",{lang:t}))},getLang:function(){if(!this.options.currentLang){var t=document.documentElement,e=t.lang||t.getAttributeNS&&t.getAttributeNS("http://www.w3.org/XML/1998/namespace","lang")||DG.config.defaultLang;this.options.currentLang=e}return this.options.currentLang}}),DG.RoundControl=DG.Control.extend({includes:DG.Mixin.Events,options:{position:"topright",iconClass:"default"},onAdd:function(t){var e=this._controlCLass="dg-control-round",i=this._controlIconCLass=this._controlCLass+"__icon",n=DG.DomUtil.create("div","");if(this._disable)return n;DG.DomUtil.addClass(n,e);var o=this._link=DG.DomUtil.create("a",i+" "+i+"_name_"+this.options.iconClass,n);return o.href="#",this._renderTranslation(),this._map=t,DG.DomEvent.on(n,"click",this._toggleControl,this).on(n,"dblclick",DG.DomEvent.stopPropagation).on(o,"mousedown",DG.DomEvent.stopPropagation),this.fireEvent("add"),n},onRemove:function(){this.fireEvent("remove"),DG.DomEvent.off(this._link,"click",this._toggleControl)},setState:function(t){return this._link&&this._container?(this._state&&(DG.DomUtil.removeClass(this._container,this._controlCLass+"_state_"+this._state),DG.DomUtil.removeClass(this._link,this._controlIconCLass+"_state_"+this._state),this._state=null),t&&(this._state=t,DG.DomUtil.addClass(this._container,this._controlCLass+"_state_"+this._state),DG.DomUtil.addClass(this._link,this._controlIconCLass+"_state_"+this._state)),this):this},_toggleControl:function(t){DG.DomEvent.stop(t),this.fireEvent("click")}}),DG.RoundControl.include(DG.Locale),DG.roundControl=function(t){return new DG.RoundControl(t)},DG.configTheme=DG.configTheme||{},DG.configTheme.markersData={iconSize:[22,34],className:"dg-customization__marker dg-customization__marker_type_mushroom",iconAnchor:[10,32]};var controlAddTo=DG.Control.prototype.addTo;DG.Control.include({addTo:function(t){return t.on("langchange",this._renderTranslation,this),controlAddTo.call(this,t)},_renderTranslation:function(){}}),DG.Browser.safari51=DG.Browser.safari&&-1!==navigator.userAgent.indexOf("Version/5.1"),DG.Marker.prototype.options.icon=DG.divIcon(DG.configTheme.markersData);var utilSetOptions=DG.Util.setOptions;DG.setOptions=L.setOptions=DG.Util.setOptions=function(t,e){return e&&"undefined"!=typeof e.clickable&&(e.interactive=e.clickable),utilSetOptions.call(this,t,e)},DG.Layer.mergeOptions({nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]});var panBy=DG.Map.prototype.panBy,getBoundsZoom=DG.Map.prototype.getBoundsZoom,setMaxZoom=DG.Map.prototype.setMaxZoom;DG.Map.include({_tileLayersNumber:0,_mapMaxZoomCache:null,initialize:function(t,e){e=L.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=L.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==undefined&&(this._zoom=this._limitZoom(e.zoom)),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._addLayers(e.layers),e.center&&e.zoom!==undefined&&this.setView(L.latLng(e.center),e.zoom,{reset:!0})},setView:function(t,e,i){if(this._restrictZoom(t,e),e=e===undefined?this._zoom:this._limitZoom(e),t=this._limitCenter(DG.latLng(t),e,this.options.maxBounds),i=i||{},i.animate&&(i.animate=this._testAnimation(t)),this.stop(),this._loaded&&!i.reset&&i!==!0){i.animate!==undefined&&(i.zoom=DG.extend({animate:i.animate,duration:i.duration},i.zoom),i.pan=DG.extend({animate:i.animate,duration:i.duration},i.pan));var n=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan);if(n)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){var i=panBy.call(this,t,e),n=this._restrictZoom(this.getCenter());return this.getZoom()>n&&this.setZoom(n),i},getBoundsZoom:function(t,e,i){return t=DG.latLngBounds(t),this._restrictZoom(t),getBoundsZoom.call(this,t,e,i)},getTileLayersNumber:function(){return this._tileLayersNumber},setMaxZoom:function(t){return this._mapMaxZoomCache=null,setMaxZoom.call(this,t)},_testAnimation:function(t){if(this.projectDetector.enabled()){var e=this.projectDetector.getProject(),i=this.projectDetector.isProjectHere(t);if(e&&i)return e.code===i.code}return!0},_updateTileLayers:function(t){t.layer instanceof DG.TileLayer&&!t.layer._isDg&&("layeradd"===t.type?this._tileLayersNumber++:this._tileLayersNumber--)},_getNewBounds:function(t,e){if(t instanceof DG.LatLngBounds)return t;var i=this.project(t,e),n=this.getSize().divideBy(2),o=this.unproject(i.subtract(n),e),r=this.unproject(i.add(n),e);return DG.latLngBounds(o,r)},_restrictZoom:function(t,e){if(this._layers&&this.projectDetector.enabled()&&0===this._tileLayersNumber){var i=this.options,n=!!i.maxZoom,o=this.baseLayer,r=this._getNewBounds(t,e),s=this.projectDetector.isProjectHere(r);return n?(this._mapMaxZoomCache||(this.baseLayer.options.detectRetina&&DG.Browser.retina&&i.maxZoom>0&&i.maxZoom--,this._mapMaxZoomCache=i.maxZoom),i.maxZoom=this._mapMaxZoomCache&&s?this._mapMaxZoomCache:DG.config.projectLeaveMaxZoom,s&&(this._mapMaxZoomCache=i.maxZoom),i.maxZoom):(s?o.options.detectRetina&&DG.Browser.retina&&s.maxZoom>0?o.options.maxZoom=s.maxZoom-1:o.options.maxZoom=s.maxZoom:o.options.maxZoom=DG.config.projectLeaveMaxZoom,o.options.maxNativeZoom=o.options.maxZoom,this._updateZoomLevels(),o.options.maxZoom)}},_handleDOMEvent:function(t){if(this._loaded&&!L.DomEvent._skipped(t)){var e="keypress"===t.type&&13===t.keyCode?"click":t.type;if("click"===t.type){var i=L.Util.extend({},t);i.type="prepreclick",this._handleDOMEvent(i);var n=L.Util.extend({},t);n.type="preclick",this._handleDOMEvent(n)}"mousedown"===e&&L.DomUtil.preventOutline(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_fireDOMEvent:function(t,e,i){if(!t._stopped&&(i=(i||[]).concat(this._findEventTargets(t,e)),i.length)){var n=i[0];if("contextmenu"===e&&n.listens(e,!0)&&L.DomEvent.preventDefault(t),"click"!==t.type&&"preclick"!==t.type&&"prepreclick"!==t.type||t._simulated||!this._draggableMoved(n)){var o={originalEvent:t};if("keypress"!==t.type){var r=n instanceof L.Marker;o.containerPoint=r?this.latLngToContainerPoint(n.getLatLng()):this.mouseEventToContainerPoint(t),o.layerPoint=this.containerPointToLayerPoint(o.containerPoint),o.latlng=r?n.getLatLng():this.layerPointToLatLng(o.layerPoint)}for(var s=0;s<i.length;s++)if(i[s].fire(e,o,!0),o.originalEvent._stopped||i[s].options.nonBubblingEvents&&-1!==L.Util.indexOf(i[s].options.nonBubblingEvents,e))return}}}}),DG.Map.addInitHook(function(){this.on("layeradd layerremove",this._updateTileLayers)}),DG.Map.addInitHook(function(){function t(){var t=this.getLang(),n=this.projectDetector&&this.projectDetector.getProject();"ru"!==t||n?this.baseLayer.options.errorTileUrl=e:this.baseLayer.options.errorTileUrl=i}var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQMAAABmvDolAAAAA1BMVEX28t5R0k5UAAAAH0lEQVR4Xu3AAQkAAADCMPunNsdhWxwAAAAAAAAAwAEhAAABg2UP5AAAAABJRU5ErkJggg==",i=DG.config.protocol+DG.config.baseUrl+"/img/nomap_ru.png",n=DG.TileLayer.extend({initialize:function(t,e){this._isDg=!0,DG.TileLayer.prototype.initialize.call(this,t,e)},getTiles:function(){return this._tiles}});this.baseLayer=new n(DG.config.protocol+DG.config.tileServer,{subdomains:"0123",errorTileUrl:"ru"===this.getLang()?i:e,detectRetina:DG.config.detectRetina,maxZoom:19,maxNativeZoom:19,zIndex:0}).addTo(this),this.on({langchange:t,projectchange:t,projectleave:t},this)}),DG.Map.mergeOptions({tilesCheck:!0}),DG.Map.TilesCheck=DG.Handler.extend({initialize:function(t){this._map=t,this._layer=t.baseLayer,this._moveStartEventCounter=0,this._moveEndEventCounter=0,this._loadingEventCounter=0,this._loadEventCounter=0},addHooks:function(){this._map.on(this._mapEvents,this),this._layer.on(this._layerEvents,this)},removeHooks:function(){this._map.off(this._mapEvents,this),this._layer.off(this._layerEvents,this)},_mapEvents:{layeradd:function(t){t.layer==this._layer&&this.enable()},layerremove:function(t){t.layer==this._layer&&this.disable()},movestart:function(){this._stopWaiting(),this._moveStartEventCounter++,this._isWaiting=!0},moveend:function(){this._moveEndEventCounter++,(this._isWaiting||this._moveStartEventCounter===this._moveEndEventCounter)&&(this._isMoveEnd=!0,this._checkWaiting())}},_layerEvents:{loading:function(){this._loadingEventCounter++},load:function(){this._loadEventCounter++,(this._isWaiting||this._loadingEventCounter===this._loadEventCounter)&&(this._isLoad=!0,this._checkWaiting())}},_stopWaiting:function(){this._isWaiting=!1,this._isMoveEnd=!1,this._isLoad=!1},_checkWaiting:function(){this._isWaiting&&this._isLoad&&this._isMoveEnd&&(this._stopWaiting(),this._resetCounters(),this._checkTiles())},_checkTiles:function(){if(0===this._map.getTileLayersNumber()&&this._map._loaded){var t=this._map.getZoom(),e=this._layer.options.errorTileUrl,i=this._layer.getTiles();for(var n in i)if(i[n].coords.z===t&&i[n].el.src!==e)return;this._map.zoomOut()}},_resetCounters:function(){this._moveStartEventCounter=0,this._moveEndEventCounter=0,this._loadingEventCounter=0,this._loadEventCounter=0}}),DG.Map.addInitHook("addHandler","tilesCheck",DG.Map.TilesCheck),DG.Control.Zoom.include(DG.Locale),DG.Control.Zoom.Dictionary={},DG.Control.Zoom.include({onAdd:function(t){var e="dg-zoom",i='<div class="dg-control-round__icon '+e+"__control "+e+"__button "+e+'__button_type_{type}"></div>',n=DG.DomUtil.create("div",e);return this._map=t,this._zoomInButton=this._createButton(DG.Util.template(i,{type:"in"}),this.t("zoom_in"),"dg-control-round "+e+"__in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(DG.Util.template(i,{type:"out"}),this.t("zoom_out"),"dg-control-round "+e+"__out",n,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},_originalCreateButton:DG.Control.Zoom.prototype._createButton,_createButton:function(){var t=Array.prototype.slice.call(arguments),e=this._originalCreateButton.apply(this,t),i=e.children[0],n="dg-control-round_state_active",o="dg-control-round__icon_state_active";return DG.DomEvent.on(e,"touchstart",function(){DG.DomUtil.addClass(e,n),DG.DomUtil.addClass(i,o)}).on(e,"touchend touchcancel",function(){DG.DomUtil.removeClass(e,n),DG.DomUtil.removeClass(i,o)}),e},_renderTranslation:function(){this._zoomInButton&&this._zoomOutButton&&(this._zoomInButton.title=this.t("zoom_in"),this._zoomOutButton.title=this.t("zoom_out"))}}),DG.Control.Zoom.Dictionary.ru={zoom_in:"Приблизить",zoom_out:"Отдалить"},DG.Control.Zoom.Dictionary.it={zoom_in:"Zoom avanti",zoom_out:"Zoom indietro"},DG.Control.Zoom.Dictionary.cs={zoom_in:"Přiblížit",zoom_out:"Oddálit"},DG.Control.Zoom.Dictionary.en={zoom_in:"Zoom in",zoom_out:"Zoom out"},DG.Control.Zoom.Dictionary.es={zoom_in:"Acercar",zoom_out:"Alejar"},function(t,e){"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.core",[],e):"object"==typeof exports?module.exports=e():t.dust=e()}(this,function(){function getTemplate(t,e){return t?"function"==typeof t&&t.template?t.template:dust.isTemplateFn(t)?t:e!==!1?dust.cache[t]:void 0:void 0}function load(t,e,i){if(!t)return e.setError(new Error("No template or template name provided to render"));var n=getTemplate(t,dust.config.cache);return n?n(e,Context.wrap(i,n.templateName)):dust.onLoad?e.map(function(e){function n(t,n){var r;if(t)return e.setError(t);if(r=getTemplate(n,!1)||getTemplate(o,dust.config.cache),!r){if(!dust.compile)return e.setError(new Error("Dust compiler not available"));r=dust.loadSource(dust.compile(n,o))}r(e,Context.wrap(i,r.templateName)).end()}var o=t;3===dust.onLoad.length?dust.onLoad(o,i.options,n):dust.onLoad(o,n)}):e.setError(new Error("Template Not Found: "+t))}function Context(t,e,i,n,o){t===undefined||t instanceof Stack||(t=new Stack(t)),this.stack=t,this.global=e,this.options=i,this.blocks=n,this.templateName=o}function getWithResolvedData(t,e,i){return function(n){return t.push(n)._get(e,i)}}function Stack(t,e,i,n){this.tail=e,this.isObject=t&&"object"==typeof t,this.head=t,this.index=i,this.of=n}function Stub(t){this.head=new Chunk(this),this.callback=t,this.out=""}function Stream(){this.head=new Chunk(this)}function Chunk(t,e,i){this.root=t,this.next=e,this.data=[],this.flushable=!1,this.taps=i}function Tap(t,e){this.head=t,this.tail=e}var dust={version:"2.7.2"},NONE="NONE",ERROR="ERROR",WARN="WARN",INFO="INFO",DEBUG="DEBUG",EMPTY_FUNC=function(){};dust.config={whitespace:!1,amd:!1,cjs:!1,cache:!0},dust._aliases={write:"w",end:"e",map:"m",render:"r",reference:"f",section:"s",exists:"x",notexists:"nx",block:"b",partial:"p",helper:"h"},function(){var t,e,i={DEBUG:0,INFO:1,WARN:2,ERROR:3,NONE:4};"undefined"!=typeof console&&console.log?(t=console.log,e="function"==typeof t?function(){t.apply(console,arguments)}:function(){t(Array.prototype.slice.apply(arguments).join(" "))}):e=EMPTY_FUNC,dust.log=function(t,n){n=n||INFO,i[n]>=i[dust.debugLevel]&&e("[DUST:"+n+"]",t)},dust.debugLevel=NONE,"undefined"!=typeof process&&process.env&&/\bdust\b/.test(process.env.DEBUG)&&(dust.debugLevel=DEBUG)}(),dust.helpers={},dust.cache={},dust.register=function(t,e){t&&(e.templateName=t,dust.config.cache!==!1&&(dust.cache[t]=e))},dust.render=function(t,e,i){var n=new Stub(i).head;try{load(t,n,e).end()}catch(o){n.setError(o)}},dust.stream=function(t,e){var i=new Stream,n=i.head;return dust.nextTick(function(){try{load(t,n,e).end()}catch(i){n.setError(i)}}),i},dust.loadSource=function(source){return eval(source)},Array.isArray?dust.isArray=Array.isArray:dust.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},dust.nextTick=function(){return function(t){setTimeout(t,0)}}(),dust.isEmpty=function(t){return 0===t?!1:dust.isArray(t)&&!t.length?!0:!t},dust.isEmptyObject=function(t){var e;if(null===t)return!1;if(t===undefined)return!1;if(t.length>0)return!1;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},dust.isTemplateFn=function(t){return"function"==typeof t&&t.__dustBody},dust.isThenable=function(t){return t&&"object"==typeof t&&"function"==typeof t.then},dust.isStreamable=function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pipe},dust.filter=function(t,e,i,n){var o,r,s,a;if(i)for(o=0,r=i.length;r>o;o++)s=i[o],s.length&&(a=dust.filters[s],"s"===s?e=null:"function"==typeof a?t=a(t,n):dust.log("Invalid filter `"+s+"`",WARN));return e&&(t=dust.filters[e](t,n)),t},dust.filters={h:function(t){return dust.escapeHtml(t)},j:function(t){return dust.escapeJs(t)},u:encodeURI,uc:encodeURIComponent,js:function(t){return dust.escapeJSON(t)},jp:function(t){return JSON?JSON.parse(t):(dust.log("JSON is undefined; could not parse `"+t+"`",WARN),t)}},dust.makeBase=dust.context=function(t,e){return new Context(undefined,t,e)},Context.wrap=function(t,e){return t instanceof Context?t:new Context(t,{},{},null,e)},Context.prototype.get=function(t,e){return"string"==typeof t&&("."===t[0]&&(e=!0,t=t.substr(1)),t=t.split(".")),this._get(e,t)},Context.prototype._get=function(t,e){var i,n,o,r,s,a=this.stack||{},l=1;if(n=e[0],o=e.length,t&&0===o)r=a,a=a.head;else{if(t)a&&(a=a.head?a.head[n]:undefined);else{for(;a&&(!a.isObject||(r=a.head,i=a.head[n],i===undefined));)a=a.tail;a=i!==undefined?i:this.global&&this.global[n]}for(;a&&o>l;){if(dust.isThenable(a))return a.then(getWithResolvedData(this,t,e.slice(l)));r=a,a=a[e[l]],l++}}return"function"==typeof a?(s=function(){try{return a.apply(r,arguments)}catch(t){throw dust.log(t,ERROR),t}},s.__dustBody=!!a.__dustBody,s):(a===undefined&&dust.log("Cannot find reference `{"+e.join(".")+"}` in template `"+this.getTemplateName()+"`",INFO),a)},Context.prototype.getPath=function(t,e){return this._get(t,e)},Context.prototype.push=function(t,e,i){return t===undefined?(dust.log("Not pushing an undefined variable onto the context",INFO),this):this.rebase(new Stack(t,this.stack,e,i))},Context.prototype.pop=function(){var t=this.current();return this.stack=this.stack&&this.stack.tail,t},Context.prototype.rebase=function(t){return new Context(t,this.global,this.options,this.blocks,this.getTemplateName())},Context.prototype.clone=function(){var t=this.rebase();return t.stack=this.stack,t},Context.prototype.current=function(){return this.stack&&this.stack.head},Context.prototype.getBlock=function(t){var e,i,n;if("function"==typeof t&&(t=t(new Chunk,this).data.join("")),e=this.blocks,!e)return dust.log("No blocks for context `"+t+"` in template `"+this.getTemplateName()+"`",DEBUG),!1;for(i=e.length;i--;)if(n=e[i][t])return n;return dust.log("Malformed template `"+this.getTemplateName()+"` was missing one or more blocks."),!1},Context.prototype.shiftBlocks=function(t){var e,i=this.blocks;return t?(e=i?i.concat([t]):[t],new Context(this.stack,this.global,this.options,e,this.getTemplateName())):this},Context.prototype.resolve=function(t){var e;return"function"!=typeof t?t:(e=(new Chunk).render(t,this),e instanceof Chunk?e.data.join(""):e)},Context.prototype.getTemplateName=function(){return this.templateName},Stub.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.callback(t.error),dust.log("Rendering failed with error `"+t.error+"`",ERROR),void(this.flush=EMPTY_FUNC)):void 0;this.out+=t.data.join(""),t=t.next,this.head=t}this.callback(null,this.out)},Stream.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.emit("error",t.error),this.emit("end"),dust.log("Streaming failed with error `"+t.error+"`",ERROR),void(this.flush=EMPTY_FUNC)):void 0;this.emit("data",t.data.join("")),t=t.next,this.head=t}this.emit("end")},Stream.prototype.emit=function(t,e){var i,n,o=this.events||{},r=o[t]||[];if(!r.length)return dust.log("Stream broadcasting, but no listeners for `"+t+"`",DEBUG),!1;for(r=r.slice(0),i=0,n=r.length;n>i;i++)r[i](e);return!0},Stream.prototype.on=function(t,e){var i=this.events=this.events||{},n=i[t]=i[t]||[];return"function"!=typeof e?dust.log("No callback function provided for `"+t+"` event listener",WARN):n.push(e),this},Stream.prototype.pipe=function(t){if("function"!=typeof t.write||"function"!=typeof t.end)return dust.log("Incompatible stream passed to `pipe`",WARN),this;var e=!1;return"function"==typeof t.emit&&t.emit("pipe",this),"function"==typeof t.on&&t.on("error",function(){e=!0}),this.on("data",function(i){if(!e)try{t.write(i,"utf8")}catch(n){dust.log(n,ERROR)}}).on("end",function(){if(!e)try{t.end(),e=!0}catch(i){dust.log(i,ERROR)}})},Chunk.prototype.write=function(t){var e=this.taps;return e&&(t=e.go(t)),this.data.push(t),this},Chunk.prototype.end=function(t){return t&&this.write(t),this.flushable=!0,this.root.flush(),this},Chunk.prototype.map=function(t){var e=new Chunk(this.root,this.next,this.taps),i=new Chunk(this.root,e,this.taps);this.next=i,this.flushable=!0;try{t(i)}catch(n){dust.log(n,ERROR),i.setError(n)}return e},Chunk.prototype.tap=function(t){var e=this.taps;return e?this.taps=e.push(t):this.taps=new Tap(t),this},Chunk.prototype.untap=function(){return this.taps=this.taps.tail,this},Chunk.prototype.render=function(t,e){return t(this,e)},Chunk.prototype.reference=function(t,e,i,n){return"function"==typeof t?(t=t.apply(e.current(),[this,e,null,{auto:i,filters:n}]),t instanceof Chunk?t:this.reference(t,e,i,n)):dust.isThenable(t)?this.await(t,e,null,i,n):dust.isStreamable(t)?this.stream(t,e,null,i,n):dust.isEmpty(t)?this:this.write(dust.filter(t,i,n,e))},Chunk.prototype.section=function(t,e,i,n){var o,r,s,a=i.block,l=i["else"],u=this;if("function"==typeof t&&!dust.isTemplateFn(t)){try{t=t.apply(e.current(),[this,e,i,n])}catch(c){return dust.log(c,ERROR),this.setError(c)}if(t instanceof Chunk)return t}if(dust.isEmptyObject(i))return u;if(dust.isEmptyObject(n)||(e=e.push(n)),dust.isArray(t)){if(a){if(r=t.length,r>0){for(s=e.stack&&e.stack.head||{},s.$len=r,o=0;r>o;o++)s.$idx=o,u=a(u,e.push(t[o],o,r));return s.$idx=undefined,s.$len=undefined,u}if(l)return l(this,e)}}else{if(dust.isThenable(t))return this.await(t,e,i);if(dust.isStreamable(t))return this.stream(t,e,i);if(t===!0){if(a)return a(this,e)}else if(t||0===t){if(a)return a(this,e.push(t))}else if(l)return l(this,e)}return dust.log("Section without corresponding key in template `"+e.getTemplateName()+"`",DEBUG),this},Chunk.prototype.exists=function(t,e,i){var n=i.block,o=i["else"];if(dust.isEmpty(t)){if(o)return o(this,e)}else{if(n)return n(this,e);dust.log("No block for exists check in template `"+e.getTemplateName()+"`",DEBUG)}return this},Chunk.prototype.notexists=function(t,e,i){var n=i.block,o=i["else"];if(dust.isEmpty(t)){if(n)return n(this,e);dust.log("No block for not-exists check in template `"+e.getTemplateName()+"`",DEBUG)}else if(o)return o(this,e);return this},Chunk.prototype.block=function(t,e,i){var n=t||i.block;return n?n(this,e):this},Chunk.prototype.partial=function(t,e,i,n){var o;return n===undefined&&(n=i,i=e),dust.isEmptyObject(n)||(i=i.clone(),o=i.pop(),i=i.push(n).push(o)),dust.isTemplateFn(t)?this.capture(t,e,function(t,e){i.templateName=t,load(t,e,i).end()}):(i.templateName=t,load(t,this,i))},Chunk.prototype.helper=function(t,e,i,n,o){var r,s=this,a=n.filters;if(o===undefined&&(o="h"),!dust.helpers[t])return dust.log("Helper `"+t+"` does not exist",WARN),s;try{return r=dust.helpers[t](s,e,i,n),r instanceof Chunk?r:("string"==typeof a&&(a=a.split("|")),dust.isEmptyObject(i)?s.reference(r,e,o,a):s.section(r,e,i,n))}catch(l){return dust.log("Error in helper `"+t+"`: "+l.message,ERROR),s.setError(l)}},Chunk.prototype.await=function(t,e,i,n,o){return this.map(function(r){t.then(function(t){r=i?r.section(t,e,i):r.reference(t,e,n,o),r.end()},function(t){var n=i&&i.error;n?r.render(n,e.push(t)).end():(dust.log("Unhandled promise rejection in `"+e.getTemplateName()+"`",INFO),r.end())})})},Chunk.prototype.stream=function(t,e,i,n,o){var r=i&&i.block,s=i&&i.error;return this.map(function(a){var l=!1;t.on("data",function(t){l||(r?a=a.map(function(i){i.render(r,e.push(t)).end()}):i||(a=a.reference(t,e,n,o)))}).on("error",function(t){l||(s?a.render(s,e.push(t)):dust.log("Unhandled stream error in `"+e.getTemplateName()+"`",INFO),l||(l=!0,a.end()))}).on("end",function(){l||(l=!0,a.end())})})},Chunk.prototype.capture=function(t,e,i){return this.map(function(n){
var o=new Stub(function(t,e){t?n.setError(t):i(e,n)});t(o.head,e).end()})},Chunk.prototype.setError=function(t){return this.error=t,this.root.flush(),this};for(var f in Chunk.prototype)dust._aliases[f]&&(Chunk.prototype[dust._aliases[f]]=Chunk.prototype[f]);Tap.prototype.push=function(t){return new Tap(t,this)},Tap.prototype.go=function(t){for(var e=this;e;)t=e.head(t),e=e.tail;return t};var HCHARS=/[&<>"']/,AMP=/&/g,LT=/</g,GT=/>/g,QUOT=/\"/g,SQUOT=/\'/g;dust.escapeHtml=function(t){return"string"==typeof t||t&&"function"==typeof t.toString?("string"!=typeof t&&(t=t.toString()),HCHARS.test(t)?t.replace(AMP,"&amp;").replace(LT,"&lt;").replace(GT,"&gt;").replace(QUOT,"&quot;").replace(SQUOT,"&#39;"):t):t};var BS=/\\/g,FS=/\//g,CR=/\r/g,LS=/\u2028/g,PS=/\u2029/g,NL=/\n/g,LF=/\f/g,SQ=/'/g,DQ=/"/g,TB=/\t/g;return dust.escapeJs=function(t){return"string"==typeof t?t.replace(BS,"\\\\").replace(FS,"\\/").replace(DQ,'\\"').replace(SQ,"\\'").replace(CR,"\\r").replace(LS,"\\u2028").replace(PS,"\\u2029").replace(NL,"\\n").replace(LF,"\\f").replace(TB,"\\t"):t},dust.escapeJSON=function(t){return JSON?JSON.stringify(t).replace(LS,"\\u2028").replace(PS,"\\u2029").replace(LT,"\\u003c"):(dust.log("JSON is undefined; could not escape `"+t+"`",WARN),t)},dust}),"function"==typeof define&&define.amd&&define.amd.dust===!0&&define(["require","dust.core"],function(t,e){return e.onLoad=function(e,i){t([e],function(){i()})},e}),function(t,e){"function"==typeof define&&define.amd&&define.amd.dust===!0?define(["dust.core"],e):"object"==typeof exports?module.exports=e(require("dustjs-linkedin")):e(t.dust)}(this,function(t){function e(e,i,n){n=n||"INFO",e=e?"{@"+e+"}: ":"",t.log(e+i,n)}function i(t){h[t]||(e(t,"Deprecation warning: "+t+" is deprecated and will be removed in a future version of dustjs-helpers","WARN"),e(null,"For help and a deprecation timeline, see https://github.com/linkedin/dustjs-helpers/wiki/Deprecated-Features#"+t.replace(/\W+/g,""),"WARN"),h[t]=!0)}function n(t){return t.stack.tail&&t.stack.tail.head&&"undefined"!=typeof t.stack.tail.head.__select__}function o(t){return n(t)&&t.get("__select__")}function r(t,e){var i,n=t.stack.head,o=t.rebase();t.stack&&t.stack.tail&&(o.stack=t.stack.tail);var r={isPending:!1,isResolved:!1,isDeferredComplete:!1,deferreds:[]};for(i in e)r[i]=e[i];return o.push({__select__:r}).push(n,t.stack.index,t.stack.of)}function s(t){var e,i;if(t.isDeferredPending=!0,t.deferreds.length)for(t.isDeferredComplete=!0,e=0,i=t.deferreds.length;i>e;e++)t.deferreds[e]();t.isDeferredPending=!1}function a(t,e){return"function"==typeof e?e.toString().replace(/(^\s+|\s+$)/gm,"").replace(/\n/gm,"").replace(/,\s*/gm,", ").replace(/\)\{/gm,") {"):e}function l(t,e){return function(i,n,o,r){return u(i,n,o,r,t,e)}}function u(t,i,n,r,s,a){var l,u,h,d,p=n.block,_=n["else"],m=o(i)||{};if(m.isResolved&&!m.isDeferredPending)return t;if(r.hasOwnProperty("key"))u=r.key;else{if(!m.hasOwnProperty("key"))return e(s,"No key specified","WARN"),t;u=m.key}return d=r.type||m.type,u=c(i.resolve(u),d),h=c(i.resolve(r.value),d),a(u,h)?(m.isPending||(l=!0,m.isPending=!0),p&&(t=t.render(p,i)),l&&(m.isResolved=!0)):_&&(t=t.render(_,i)),t}function c(t,e){switch(e&&(e=e.toLowerCase()),e){case"number":return+t;case"string":return String(t);case"boolean":return t="false"===t?!1:t,Boolean(t);case"date":return new Date(t)}return t}var h={},d={tap:function(t,e,n){return i("tap"),n.resolve(t)},sep:function(t,e,i){var n=i.block;return e.stack.index===e.stack.of-1?t:n?n(t,e):t},first:function(t,e,i){return 0===e.stack.index?i.block(t,e):t},last:function(t,e,i){return e.stack.index===e.stack.of-1?i.block(t,e):t},contextDump:function(t,i,n,o){var r,s,l=i.resolve(o.to),u=i.resolve(o.key);switch(u){case"full":r=i.stack;break;default:r=i.stack.head}switch(s=JSON.stringify(r,a,2),l){case"console":e("contextDump",s);break;default:s=s.replace(/</g,"\\u003c"),t=t.write(s)}return t},math:function(t,i,n,a){var l,u=a.key,c=a.method,h=a.operand,d=a.round;if(!a.hasOwnProperty("key")||!a.method)return e("math","`key` or `method` was not provided","ERROR"),t;switch(u=parseFloat(i.resolve(u)),h=parseFloat(i.resolve(h)),c){case"mod":0===h&&e("math","Division by 0","ERROR"),l=u%h;break;case"add":l=u+h;break;case"subtract":l=u-h;break;case"multiply":l=u*h;break;case"divide":0===h&&e("math","Division by 0","ERROR"),l=u/h;break;case"ceil":case"floor":case"round":case"abs":l=Math[c](u);break;case"toint":l=parseInt(u,10);break;default:e("math","Method `"+c+"` is not supported","ERROR")}return"undefined"!=typeof l&&(d&&(l=Math.round(l)),n&&n.block?(i=r(i,{key:l}),t=t.render(n.block,i),s(o(i))):t=t.write(l)),t},select:function(t,i,n,a){var l=n.block,u={};return a.hasOwnProperty("key")&&(u.key=i.resolve(a.key)),a.hasOwnProperty("type")&&(u.type=a.type),l?(i=r(i,u),t=t.render(l,i),s(o(i))):e("select","Missing body block","WARN"),t},eq:l("eq",function(t,e){return t===e}),ne:l("ne",function(t,e){return t!==e}),lt:l("lt",function(t,e){return e>t}),lte:l("lte",function(t,e){return e>=t}),gt:l("gt",function(t,e){return t>e}),gte:l("gte",function(t,e){return t>=e}),any:function(t,i,n,r){var s=o(i);return s?s.isDeferredComplete?e("any","Must not be nested inside {@any} or {@none} block","ERROR"):t=t.map(function(t){s.deferreds.push(function(){s.isResolved&&(t=t.render(n.block,i)),t.end()})}):e("any","Must be used inside a {@select} block","ERROR"),t},none:function(t,i,n,r){var s=o(i);return s?s.isDeferredComplete?e("none","Must not be nested inside {@any} or {@none} block","ERROR"):t=t.map(function(t){s.deferreds.push(function(){s.isResolved||(t=t.render(n.block,i)),t.end()})}):e("none","Must be used inside a {@select} block","ERROR"),t},size:function(e,i,n,o){var r,s,a=o.key;if(a=i.resolve(o.key),a&&a!==!0)if(t.isArray(a))r=a.length;else if(!isNaN(parseFloat(a))&&isFinite(a))r=a;else if("object"==typeof a){r=0;for(s in a)a.hasOwnProperty(s)&&r++}else r=(a+"").length;else r=0;return e.write(r)}};for(var p in d)t.helpers[p]=d[p];return t}),DG.dust=function(t,e){var i;return dust.render(t,e,function(t,e){i=e}),i},DG.debug&&(dust.debugLevel="ERROR"),DG.Control.Attribution.include(DG.Locale),DG.Control.Attribution.Dictionary={},DG.Control.Attribution.include({options:{position:"bottomright"},_getLink:function(t){var e={ru:{copyright_logo:"http://info.2gis.ru/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://api.2gis.ru/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://help.2gis.ru/licensing-agreement/"},it:{copyright_logo:"http://2gis.it/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://2gis.it/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://2gis.it/"},cz:{copyright_logo:"http://praha.2gis.cz/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://praha.2gis.cz/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.cz/licensing-agreement/"},cl:{copyright_logo:"http://santiago.2gis.cl/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://santiago.2gis.cl/?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.cl/licensing-agreement/"},cy:{copyright_logo:"http://info.2gis.com.cy/lemesos?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://info.2gis.com.cy/lemesos?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.com.cy/licensing-agreement/"},ae:{copyright_logo:"http://info.2gis.ae/dubai?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_apilink:"http://info.2gis.ae/dubai?utm_source=copyright&utm_medium=map&utm_campaign=partners",copyright_license:"http://law.2gis.ae/licensing-agreement/"}},i=this._countryCode in e?this._countryCode:"ru";return e[i][t]},onAdd:function(t){t._copyright||(t._copyright=!0,this._first=!0),this._container=DG.DomUtil.create("div","dg-attribution"),DG.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},_update:function(t,e,i){if(this._map){"undefined"!=typeof e&&(this._osm=e),"undefined"!=typeof i&&(this._countryCode=i);var n=[];for(var o in this._attributions)this._attributions[o]&&n.push(o);var r=[],s="";this._first&&(s=this._getAttributionHTML(t)),this.options.prefix&&r.push(this.options.prefix),n.length&&r.push(n.join(", ")),this._container.innerHTML=s+r.join(" | ")}},_getData:function(t){return{osm:this._osm,work_on:this.t("work_on"),lang:t||this._map.getLang(),copyright_apilink:this._getLink("copyright_apilink"),copyright_license:this._getLink("copyright_license"),copyright_logo:this._getLink("copyright_logo"),license_agreement:this.t("license_agreement"),API_2GIS:this.t("API_2GIS")}},_getAttributionHTML:function(t){return DG.dust("DGAttribution/copyright",this._getData(t))},_renderTranslation:function(t){this._update(t.lang)}}),DG.Map.addInitHook(function(){this._copyright||DG.control.attribution().addTo(this)}),DG.Control.Attribution.Dictionary.ru={license_agreement:"Лицензионное соглашение",work_on:"Работает на",API_2GIS:"API 2ГИС"},DG.Control.Attribution.Dictionary.it={license_agreement:"Accordo di licenza",work_on:" ",API_2GIS:"2GIS API"},DG.Control.Attribution.Dictionary.cs={license_agreement:"Licenční smlouva",work_on:"Pracuje na",API_2GIS:"API 2GIS"},DG.Control.Attribution.Dictionary.en={license_agreement:"License agreement",work_on:"Uses",API_2GIS:"2GIS API"},DG.Control.Attribution.Dictionary.es={license_agreement:"Acuerdo de licencia",work_on:" ",API_2GIS:"2GIS API"},DG.Control.Location=DG.RoundControl.extend({statics:{Dictionary:{}},options:{iconClass:"locate",position:DG.Browser.mobile?"bottomright":"topleft",drawCircle:!0,follow:!0,stopFollowingOnDrag:!1,metric:!0,onLocationError:function(){},onLocationOutsideMapBounds:function(){},locateOptions:{}},initialize:function(t){return DG.Util.setOptions(this,t),navigator.geolocation?(this._event=undefined,this._locateOptions={watch:!0,setView:!0,maximumAge:1/0,maxZoom:1/0},DG.extend(this._locateOptions,this.options.locateOptions),this._resetVariables(),void this.on({click:this._handleLocate,add:this._initLocate})):void(this._disable=!0)},_initLocate:function(){this._layer=new DG.LayerGroup,this._layer.addTo(this._map),this._map.on({locationfound:this._onLocationFound,locationerror:this._onLocationError},this)},_handleLocate:function(){this._active&&(!this._event||this._map.getBounds().contains(this._event.latlng)||this._isOutsideMapBounds())?this._stopLocate():(this._locateOnNextLocationFound=!0,this._active||this._map.locate(this._locateOptions),this._active=!0,this.options.follow&&this._startFollowing(),this._clearError(),this._event?this._visualizeLocation():this.setState("requesting"))},_onLocationFound:function(t){this._event&&this._event.latlng.lat===t.latlng.lat&&this._event.latlng.lng===t.latlng.lng&&this._event.accuracy===t.accuracy||this._active&&(this._event=t,this.options.follow&&this._following&&(this._locateOnNextLocationFound=!0),this._visualizeLocation())},_startFollowing:function(){this._following=!0,this.options.stopFollowingOnDrag&&this._map.on("dragstart",this._stopFollowing)},_stopFollowing:function(){this._following=!1,this.options.stopFollowingOnDrag&&this._map.off("dragstart",this._stopFollowing),this._visualizeLocation()},_isOutsideMapBounds:function(){return this._event===undefined?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_visualizeLocation:function(){this._event.accuracy===undefined&&(this._event.accuracy=0);var t=this._event.accuracy;if(this._locateOnNextLocationFound){if(this._isOutsideMapBounds())this.options.onLocationOutsideMapBounds(this);else if(this._locateOptions.setView){var e=this._map.projectDetector.getProject().maxZoom||DG.config.projectLeaveMaxZoom;e=Math.min(this._locateOptions.maxZoom,e),this._map.setView(this._event.latlng,e)}this._locateOnNextLocationFound=!1}var i={clickable:!1,color:"#FFF",fillColor:"#FFF",fillOpacity:.4,weight:0,opacity:.3};this.options.drawCircle&&(this._circle?this._circle.setLatLng(this._event.latlng).setRadius(t):this._circle=DG.circle(this._event.latlng,t,i).addTo(this._layer));var n="dg-location__pin";n+=this._following?" "+n+"state_following":"";var o={icon:DG.divIcon({className:n,iconSize:[20,20]})};this._marker?this._marker.setLatLng(this._event.latlng):this._marker=DG.marker(this._event.latlng,o).bindLabel(this.t("you_are_here")).addTo(this._layer),DG.DomEvent.on(this._marker,"click",function(){this._map.fireEvent("dgLocateClick")},this),this._container&&this.setState("active")},_resetVariables:function(){this._active=!1,this._following=!1},_stopLocate:function(){this._map.stopLocate(),this._map.off("dragstart",this._stopFollowing),this.setState(),this._resetVariables(),this._layer.clearLayers(),this._marker=undefined,this._circle=undefined,this._event=undefined},_onLocationError:function(t){if(3!==t.code||!this._locateOptions.watch){this._stopLocate(),this._error=DG.DomUtil.create("div","dg-label dg-label_name_location-error",this._container),this._errorText=DG.DomUtil.create("div","dg-label__content",this._error),this._errorText.innerHTML=this.t("cant_find");var e=this;setTimeout(function(){e._clearError()},3e3),this.options.onLocationError(t)}},_clearError:function(){this._error&&(this._container.removeChild(this._error),this._error=undefined,this._errorText=undefined)},_renderTranslation:function(){this._link&&(this._link.title=this.t("button_title")),this._marker&&this._marker.bindLabel(this.t("you_are_here"))}}),DG.control.location=function(t){return new DG.Control.Location(t)},DG.Map.addInitHook(function(){this.options.locationControl&&(this.locationControl=DG.control.location(this.options.locationControl),this.addControl(this.locationControl))}),DG.Control.Location.Dictionary.ru={cant_find:"Мы не смогли Вас найти",you_are_here:"Вы здесь",button_title:"Найти Вас на карте"},DG.Control.Location.Dictionary.it={cant_find:"Non siamo riusciti a localizzarti",you_are_here:"Voi siete qui",button_title:"Trova la tua posizione sulla mappa"},DG.Control.Location.Dictionary.cs={cant_find:"Nepodařilo se nám určit Vaši polohu",you_are_here:"Jste tady",button_title:"Určit Vaši polohu na mapě"},DG.Control.Location.Dictionary.en={cant_find:"We can't find you",you_are_here:"You are here",button_title:"Show your location"},DG.Control.Location.Dictionary.es={cant_find:"No pudimos encontrarte",you_are_here:"Tú estás aquí",button_title:"Encontrarte en el mapa"},DG.Screenfull=DG.Class.extend({_apiMap:[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],initialize:function(){this.api=this._api()},request:function(t){var e=this.api.requestFullscreen;t=t||document.documentElement,t[e](Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[this.api.exitFullscreen]()},isFullscreen:function(){return!!document[this.api.fullscreenElement]},isAvailable:function(){return Boolean(this.api)},_api:function(){var t={},e=this._apiMap;return e.forEach(function(i){i&&i[1]in document&&i.forEach(function(i,n){t[e[0][n]]=i})}),t.requestFullscreen?t:!1}}),DG.screenfull=new DG.Screenfull,DG.Control.Fullscreen=DG.RoundControl.extend({statics:{Dictionary:{}},options:{position:"topright",iconClass:"fullscreen"},initialize:function(t){DG.Util.setOptions(this,t),this._isFullscreen=!1,this.on("click",this._toggleFullscreen)},_toggleFullscreen:function(){this._isFullscreen?this._toggle(!1,"exit","on","cancelfullscreen"):this._toggle(!0,"request","on","requestfullscreen"),this._renderTranslation(),this._map.invalidateSize()},_renderTranslation:function(){this._link.title=this.t(this._isFullscreen?"title_min":"title_max")},_toggle:function(t,e,i,n){var o=this._map._container;this._isFullscreen=t,this.setState(t?"active":""),DG.screenfull[e](o),DG.DomEvent[i](document,DG.screenfull.api.fullscreenchange,this._onFullScreenStateChange,this),this._map.fire(n)},_onFullScreenStateChange:function(){DG.screenfull.isFullscreen()||this._toggle(!1,"exit","on","cancelfullscreen")}}),DG.control.fullscreen=function(t){return new DG.Control.Fullscreen(t)},DG.Map.mergeOptions({fullscreenControl:!0}),DG.Map.addInitHook(function(){this.options.fullscreenControl&&(this.fullscreenControl=DG.control.fullscreen(this.options.fullscreenControl),DG.screenfull.isAvailable()&&this.addControl(this.fullscreenControl))}),DG.Control.Fullscreen.Dictionary.ru={title_max:"Развернуть",title_min:"Восстановить"},DG.Control.Fullscreen.Dictionary.it={title_max:"Espandi",title_min:"Ripristina"},DG.Control.Fullscreen.Dictionary.cs={title_max:"Rozbalit",title_min:"Obnovit"},DG.Control.Fullscreen.Dictionary.en={title_max:"Expand",title_min:"Restore"},DG.Control.Fullscreen.Dictionary.es={title_max:"Maximizar",title_min:"Restaurar"},DG.Meta={},DG.Meta.Layer=DG.Layer.extend({options:{tileSize:256,minZoom:0,maxZoom:19,zoomOffset:0,eventBubbling:"transparent"},initialize:function(t,e){DG.TileLayer.prototype.initialize.call(this,null,e),delete this._url,this._currentTile=!1,this._currentTileData=!1,this._origin=DG.Meta.origin(t,{dataFilter:this.options.dataFilter})},getOrigin:function(){return this._origin},onAdd:function(t){this._resetView(),this._addDomEvents(),t.on("rulerstart",this._removeDomEvents,this),t.on("rulerend",this._addDomEvents,this)},onRemove:function(t){this._removeDomEvents(),this._tileZoom=null,t.off("rulerstart",this._removeDomEvents,this),t.off("rulerend",this._addDomEvents,this)},getEvents:function(){return{viewreset:this._resetAll,zoom:this._resetView}},_addDomEvents:function(){DG.DomEvent.on(this._map.getPane("tilePane"),this._domEvents,this)},_removeDomEvents:function(){DG.DomEvent.off(this._map.getPane("tilePane"),this._domEvents,this)},_removeAllTiles:DG.GridLayer.prototype._removeAllTiles,_getZoomForUrl:DG.TileLayer.prototype._getZoomForUrl,getTileSize:DG.TileLayer.prototype.getTileSize,_isValidTile:DG.GridLayer.prototype._isValidTile,_wrapCoords:DG.GridLayer.prototype._wrapCoords,_resetView:DG.GridLayer.prototype._resetView,_resetGrid:DG.GridLayer.prototype._resetGrid,_resetAll:DG.GridLayer.prototype._resetAll,_pxBoundsToTileRange:DG.GridLayer.prototype._pxBoundsToTileRange,_domEvents:{mousemove:function(t){var e,i,n,o=this.getTileSize(),r=this._map.mouseEventToLayerPoint(t),s=this._map.getPixelOrigin().add(r),a=s.unscaleBy(o).floor(),l=this._map.getZoom();l>this.options.maxZoom+this.options.zoomOffset||l<this.options.minZoom-this.options.zoomOffset||!this._isValidTile(a)||(this._wrapCoords(a),a.z=this._getZoomForUrl(),a.key=o.x+"x"+o.y,i=this._origin.getTileKey(a),i!==this._currentTile&&(this._currentTile=i,this._currentTileData=!1),this._currentTileData===!1?this._currentTileData=this._origin.getTileData(a):(e=DG.point(s.x%o.x,s.y%o.y),n=this._getHoveredObject(a,e),this._hoveredEntity!==n&&(this._fireMouseEvent("mouseout",t),this._hoveredEntity=n,this._fireMouseEvent("mouseover",t)),this._fireMouseEvent("mousemove",t)))},mouseout:function(t){this._fireMouseEvent("mouseout",t),this._hoveredEntity=null,this._currentTile=!1},click:function(t){this._fireMouseEvent("click",t)},dblclick:function(t){this._fireMouseEvent("dblclick",t)},mousedown:function(t){this._fireMouseEvent("mousedown",t)},contextmenu:function(t){this._fireMouseEvent("contextmenu",t)}},_fireMouseEvent:function(t,e){this._hoveredEntity&&(this.fire(t,{meta:this._hoveredEntity,latlng:this._map.mouseEventToLatLng(e)}),"layer"===this.options.eventBubbling&&DG.DomEvent.stop(e))},_getHoveredObject:function(t,e){for(var i=0;i<this._currentTileData.length;i++)if(DG.PolyUtil.contains(e,this._currentTileData[i].geometry.coordinates[0]))return this._currentTileData[i];return null},_setView:function(t,e,i,n){var o=Math.round(e),r=this._tileZoom!==o;!n&&r&&(this._tileZoom=o,this._resetGrid())}}),DG.Meta.layer=function(t,e){return new DG.Meta.Layer(t,e)},DG.Meta.Origin=DG.Class.extend({options:{subdomains:"0123",dataFilter:null},_url:!1,initialize:function(t,e){this._url=t,this._requests={},this._tileStorage={},e=DG.setOptions(this,e),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split(""))},getTileData:function(t){var e=this.getTileKey(t),i=this;return"undefined"==typeof this._tileStorage[e]&&"undefined"==typeof this._requests[e]?(this._tileStorage[e]=!1,this._requests[e]=this._requestData(t).then(function(n){i.setTileData(e,i.options.dataFilter?i.options.dataFilter(n,t):n),delete i._requests[e]}),!1):this._tileStorage[e]},setTileData:function(t,e){return"string"!=typeof t&&(t=this.getTileKey(t)),e.forEach(function(e){e.geometry.constructor!==Object&&(e.geometry=DG.Wkt.toGeoJSON(e.geometry)),this._tileStorage[t]||(this._tileStorage[t]=[]),this._tileStorage[t].push(e)},this),this},flush:function(){return this._tileStorage={},Object.keys(this._requests).forEach(function(t){this[t].abort&&this[t].abort()},this._requests),this},setURL:function(t,e){return this._url=t,e&&this.flush(),this},getTileKey:function(t){return[t.x,t.y,t.z,t.key].join(":")},_requestData:function(t){return this._url?this._performRequest(t):Promise.resolve([])},_performRequest:function(t){return DG.ajax(this._prepareURL(t),{type:"get",dataType:"json"})},_prepareURL:function(t){return DG.Util.template(this._url,{x:t.x,y:t.y,z:t.z,s:this._getSubdomain(t)})},_getSubdomain:DG.TileLayer.prototype._getSubdomain}),DG.Meta.origin=function(t,e){return new DG.Meta.Origin(t,e)},DG.PolyUtil.contains=function(t,e){var i,n,o,r=0,s=[];for(n=0,o=e.length;o>n;n++)s.push(DG.point(e[n]));for(i=this._getEdges(s),n=0,o=i.length;o>n;n++)switch(this._getEdgeType(i[n],t)){case"TOUCHING":return!0;case"CROSSING":r=1-r}return!!r},DG.PolyUtil._getEdges=function(t){for(var e,i,n,o=[],r=0,s=t.length;s>r;r++)i=t[r],n=r!==s-1?t[r+1]:t[0],e={startPoint:i,endPoint:n},o.push(e);return o},DG.PolyUtil._getEdgeType=function(t,e){var i=this._classify(t,e);switch(i){case"LEFT":return t.startPoint.y<e.y&&e.y<=t.endPoint.y?"CROSSING":"INESSENTIAL";case"RIGHT":return t.endPoint.y<e.y&&e.y<=t.startPoint.y?"CROSSING":"INESSENTIAL";case"BETWEEN":case"ORIGIN":case"DESTINATION":return"TOUCHING";default:return"INESSENTIAL"}},DG.PolyUtil._classify=function(t,e){var i,n,o;return i={x:t.endPoint.x-t.startPoint.x,y:t.endPoint.y-t.startPoint.y},n={x:e.x-t.startPoint.x,y:e.y-t.startPoint.y},o=i.x*n.y-n.x*i.y,o>0?"LEFT":0>o?"RIGHT":i.x*n.x<0||i.y*n.y<0?"BEHIND":this._getLengthSquared(i)<this._getLengthSquared(n)?"BEYOND":DG.PolyUtil._areEquals(t.startPoint,e)?"ORIGIN":DG.PolyUtil._areEquals(t.endPoint,e)?"DESTINATION":"BETWEEN"},DG.PolyUtil._getLengthSquared=function(t){return Math.pow(t.x,2)+Math.pow(t.y,2)},DG.PolyUtil._areEquals=function(t,e){return t.x===e.x&&t.y===e.y},DG.Map.mergeOptions({poi:!DG.Browser.mobile}),DG.Poi=DG.Handler.extend({options:{disableLabel:!1},initialize:function(t,e){this._map=t,DG.Util.setOptions(this,e),this._metaLayer=DG.Meta.layer(DG.config.protocol+DG.config.poiMetaServer,{minZoom:DG.config.poiLayerMinZoom,maxNativeZoom:19,detectRetina:DG.config.detectRetina,eventBubbling:"layer",dataFilter:DG.bind(this._processData,this)})},addHooks:function(){this._map.addLayer(this._metaLayer),this.options.disableLabel||(this._labelHelper=DG.label(),this._metaLayer.on(this._layerEventsListeners,this))},removeHooks:function(){this._map.removeLayer(this._metaLayer),this.options.disableLabel||(this._metaLayer.off(this._layerEventsListeners,this),this._map.removeLayer(this._labelHelper),this._labelHelper=null)},getMetaLayer:function(){return this._metaLayer},_processData:function(t,e){var i=this._map,n=e.scaleBy(this._metaLayer.getTileSize());return""===t.responseText?[]:t.result.poi.map(function(t){var e=DG.Wkt.toGeoJSON(t.hover);return e.coordinates[0]=e.coordinates[0].map(function(t){return i.project([t[1],t[0]]).round().subtract(n)}),{id:t.id,hint:t.links[0].name,linked:t.links[0],geometry:e}})},_layerEventsListeners:{mouseover:function(t){this._setCursor("pointer"),this._labelHelper.setPosition(t.latlng).setContent(t.meta.hint).setZIndexOffset(300),this._map.addLayer(this._labelHelper),this._map.fire("poihover",{latlng:t.latlng,meta:t.meta})},mouseout:function(t){this._setCursor(""),this._map.removeLayer(this._labelHelper),this._map.fire("poileave",{latlng:t.latlng,meta:t.meta})},mousemove:function(t){this._labelHelper.setPosition(t.latlng)}},_setCursor:function(t){this._map.getContainer().style.cursor=t}}),DG.Map.addInitHook("addHandler","poi",DG.Poi),DG.Map.mergeOptions({geoclicker:!1}),DG.Geoclicker=DG.Handler.extend({clickCount:0,pendingClick:0,timeout:250,initialize:function(t,e){this._map=t,this._controller=new DG.Geoclicker.Controller(t,e)},addHooks:function(){this._toggleEvents(!0),this._map.on("rulerstart",this._pause,this).on("rulerend",this._unpause,this)},removeHooks:function(){this._toggleEvents(),this._map.off("rulerstart",this._pause,this).off("rulerend",this._unpause,this)},_pause:function(){this._toggleEvents()},_unpause:function(){this.enabled()&&this._toggleEvents(!0)},_toggleEvents:function(t){this._map[t?"on":"off"](this._mapEventsListeners,this),this._map.poi&&this._map.poi.getMetaLayer()[t?"on":"off"]("click",this._mapEventsListeners.click,this)},getController:function(){return this._controller},_checkOpenPopup:function(){DG.Browser.mobile&&this._map._popup&&(this._map._popup.options.closeOnClick||this._map.options.closePopupOnClick)&&(this.popupWasOpen=!0)},_mapEventsListeners:{langchange:function(){this._controller.reinvokeHandler()},popupclose:function(t){this._controller.handlePopupClose(t.popup)},prepreclick:function(){this._checkOpenPopup()},click:function(t){0===this.clickCount?(this.clickCount=1,this._singleClick(t)):(this.clickCount=0,clearTimeout(this.pendingClick),this.popupWasOpen=!1)},dblclick:function(){DG.Browser.ielt9&&(this.clickCount=0,this.popupWasOpen=!1,clearTimeout(this.pendingClick))}},_singleClick:function(t){var e=this;clearTimeout(this.pendingClick),this.pendingClick=setTimeout(function(){if(t.meta&&(e._checkOpenPopup(),e._map.closePopup()),!e.popupWasOpen){var i=e._map.getZoom();e._controller.handleClick(t.latlng,i,t.meta)}e.clickCount=0,e.popupWasOpen=!1},this.timeout)}}),DG.Map.addInitHook("addHandler","geoclicker",DG.Geoclicker),DG.Geoclicker.clampHelper=function(t,e){var i,n,o,r,s,a,l,u,c,h=document.createElement.bind(document),d=document.createTextNode.bind(document);if(i=h("span"),function(t){t.position="absolute",t.whiteSpace="pre",t.visibility="hidden",t.margin="0 18px 8px 0"}(i.style),t.ownerDocument&&t.ownerDocument===document){for(r=a=0,s=1,c=!1,o=t.clientWidth,n=(t.textContent||t.innerText).replace(/\n/g," ");null!==t.firstChild;)t.removeChild(t.firstChild);t.appendChild(i),n.replace(/ |-/g,function(p,_){s!==e&&(i.appendChild(d(n.substr(r,_-r))),o<i.clientWidth?(c?(u=n.substr(r,_+1-r),r=_+1):(u=n.substr(r,a-r),r=a),l=h("span"),l.appendChild(d(u)),t.appendChild(l),l.className="dg-map-geoclicker__clamped-line",c=!0,s++):c=!1,a=_+1,i.removeChild(i.firstChild))}),t.removeChild(i),l=h("span"),l.className="dg-map-geoclicker__clamped-line dg-map-geoclicker__clamped-line_last",l.appendChild(d(n.substr(r))),t.appendChild(l)}},DG.Geoclicker.Provider={},DG.Geoclicker.Provider.CatalogApi=DG.Class.extend({initialize:function(t){this._map=t;var e=DG.config.protocol+DG.config.webApiServer+"/"+DG.config.webApiVersion+"/";this._urlGeoSearch=e+"geo/search",this._urlGeoGet=e+"geo/get",this._urlDetails=e+"catalog/branch/get",this._urlFirmsInHouse=e+"catalog/branch/list",this._key=DG.config.geoclickerCatalogApiKey,this._geoFields=DG.config.geoAdditionalFields,this._firmInfoFields=DG.config.firmInfoFields},getLocations:function(t){var e=t.zoom,i=t.latlng,n=t.beforeRequest||function(){},o=this.getTypesByZoom(e),r=i.lng+","+i.lat;return o?(n(),this.geoSearch(r,o,e).then(DG.bind(function(t){return this._filterResponse(t,o)},this))):Promise.reject("no type")},firmsInHouse:function(t,e){e=e||{};var i={building_id:t,page:e.page||1};return this._performRequest(i,this._urlFirmsInHouse)},getFirmInfo:function(t){return this._performRequest({type:"filial",id:t,fields:this._firmInfoFields},this._urlDetails)},geoSearch:function(t,e,i){var n={point:t,type:e,zoom_level:i,fields:this._geoFields};return this._performRequest(n,this._urlGeoSearch)},geoGet:function(t){var e={id:t,fields:this._geoFields};return this._performRequest(e,this._urlGeoGet)},cancelLastRequest:function(){this._lastRequest&&this._lastRequest.abort()},getTypesByZoom:function(t){var e={"adm_div.settlement":8,"adm_div.city":8,"adm_div.division":11,"adm_div.district":12,street:14,building:14,"adm_div.place":15,poi:15,attraction:17},i=[];return Object.keys(e).forEach(function(n){t>=e[n]&&i.push(n)}),i.length?i.join(","):null},_performRequest:function(t,e){var i=DG.extend({key:this._key},t),n="get";return this.cancelLastRequest(),DG.ajax.corsSupport||(n=i.format="jsonp"),this._lastRequest=DG.ajax(e,{type:n,data:i,timeout:this._timeoutMs}),this._lastRequest},_filterResponse:function(t,e){var i,n,o,r,s,a={};if(this._isNotFound(t))return!1;for(r=t.result.items,i=r.length-1;i>=0;i--)n=r[i],s=n.type,n.subtype&&(s+="."+n.subtype),e&&-1===e.indexOf(s)||(a[s]=n,o=!0);return o?a:!1},_isNotFound:function(t){return!(t&&(!t.meta||!t.meta.error)&&t.result&&t.result.items&&t.result.items.length)}}),DG.Geoclicker.Handler={},DG.Geoclicker.Handler.Default=DG.Class.extend({includes:DG.Locale,statics:{Dictionary:{}},_eventHandlers:{},initialize:function(t,e,i){this._controller=t,this._view=e,this._map=i},handle:function(){return Promise.resolve({tmpl:"popupHeader",data:{title:this.t("we_have_not")}})},addClickEvent:function(){this._view._popup.on("click",this._runEventHandlers,this),this._map.once("popupclose",this._removeClickEvent,this)},_removeClickEvent:function(){this._view._popup.off("click",this._runEventHandlers,this)},_addEventHandler:function(t,e){this._eventHandlers[t]=e},_runEventHandlers:function(t){var e=t.originalEvent.target;for(var i in this._eventHandlers)if(this._eventHandlers.hasOwnProperty(i)&&e.className.indexOf(i)>-1)return DG.DomEvent.preventDefault(t.originalEvent),void this._eventHandlers[i].call(this,e)},_clearEventHandlers:function(){this._eventHandlers={}},_getDirectionsUrl:function(t){return DG.Util.template(DG.config.ppnotLink,{domain:this._map.projectDetector.getProject().domain,projectCode:this._map.projectDetector.getProject().code,center:this._map.getCenter().lng+","+this._map.getCenter().lat,zoom:this._map.getZoom(),name:encodeURIComponent(t),rsType:this._map.projectDetector.getProject().transport?"bus":"car",point:this._popup._latlng.lng+","+this._popup._latlng.lat})},_getDrilldown:function(t){var e,i=[];return t.adm_div&&(i=t.adm_div.reduce(function(t,e){return e.name&&t.push(e.name),t},[]).reverse()),i.length&&t.address&&t.address.postcode&&i.push(t.address.postcode),e=i.join(", ")}}),DG.Geoclicker.Handler.HandlerExample=DG.Geoclicker.Handler.Default.extend({handle:function(t,e){return Promise.resolve({tmpl:e+":<br/>"+t[e].id})}}),DG.Geoclicker.Handler.ApiError=DG.Geoclicker.Handler.Default.extend({handle:function(){var t=this._view.render({tmpl:"popupHeader",data:{title:this.t("apiErrorTitle")}});return Promise.resolve({header:t,tmpl:this.t("apiErrorBody")})}}),DG.Geoclicker.Handler.CityArea=DG.Geoclicker.Handler.Default.extend({_polylineStyleDefault:{fillColor:"#ff9387",color:"#ff9387",noClip:!0,opacity:1},_polylineStyles:{11:{fillOpacity:.18,weight:1},12:{fillOpacity:.12,weight:1},13:{fillOpacity:.08,weight:2},18:{fillOpacity:0,
weight:3}},handle:function(t,e){return t[e]?(this._stylesInited||this._initStyles(),this._geometry&&this._map.removeLayer(this._geometry),this._popup=this._view.getPopup(),this._geometryZoomStyle=this._getPolyStyleNum(),this._geometry=DG.Wkt.geoJsonLayer(t[e].geometry.selection,{style:this._polylineStyles[this._geometryZoomStyle],interactive:!1}).addTo(this._map),this._map.on("zoomend",this._updateGeometry,this).once("popupclose",this._clearPopup,this),Promise.resolve(this._fillCityAreaObject(t,e))):!1},_fillCityAreaObject:function(t,e){var i={name:this.t("noname"),drilldown:"",purpose:this.t(e),type:e.split(".").join("_")};return i.drilldown=this._getDrilldown(t[e]),t[e].name&&(i.name=t[e].name),{tmpl:"cityarea",data:i,header:this._view.render({tmpl:"popupHeader",data:{title:i.name}})}},_initStyles:function(){this._stylesInited=!0,Object.keys(this._polylineStyles).forEach(function(t){DG.extend(this._polylineStyles[t],this._polylineStyleDefault)},this)},_getPolyStyleNum:function(){var t=this._map.getZoom();return Object.keys(this._polylineStyles).filter(function(e){return e>=t})[0]||!1},_updateGeometry:function(){var t=this._getPolyStyleNum();t&&t!==this._geometryZoomStyle&&(this._geometryZoomStyle=t,this._geometry.setStyle(this._polylineStyles[t]))},_clearPopup:function(){this._map.removeLayer(this._geometry).off("zoomend",this._updateGeometry,this)}}),DG.Geoclicker.Handler.House=DG.Geoclicker.Handler.Default.extend({_firmsOnPage:20,_scrollThrottleInterval:400,_scrollHeightReserve:60,options:{showBooklet:!0,showPhotos:!0,showRouteSearch:!0},handle:function(t){return t.building?(this.firmCard=null,this._page=1,this._houseObject=null,this._firmList=null,this._firmListObject=null,this._firmCardObject=null,this._onScroll=!1,this._isFirmlistOpen=!1,this._id=t.building.id,this._totalPages=1,this._api=this._controller.getCatalogApi(),this._popup=this._view.getPopup(),this._initedPopupClose=!1,this._directionsUrl=this._getDirectionsUrl(t.building.name),this._firmListLoader=this._view.initLoader(!0),this._houseObject=this._fillHouseObject(t.building),Promise.resolve(this._houseObject)):!1},_isRouteSearchAllowed:function(){var t=this._controller.getMap().projectDetector.getProject();return t.transport||t.roads},_firmCardSetup:function(){return{render:this._view.renderTemplate,lang:this._map.getLang(),domain:this._controller.getMap().projectDetector.getProject().domain,ajax:DG.bind(this._api.getFirmInfo,this._api),timezoneOffset:this._controller.getMap().projectDetector.getProject().timeOffset,map:this._map,popup:this._popup,isMobile:DG.Browser.mobile,showEntrance:DG.Entrance,gotoUrl:this._directionsUrl,onFirmReady:DG.bind(this._onFirmReady,this),onToggle:DG.bind(this._popup.resize,this._popup),showBooklet:this.options.showBooklet,showPhotos:this.options.showPhotos,showRouteSearch:this.options.showRouteSearch&&this._isRouteSearchAllowed(),t:DG.bind(this.t,this)}},_fillFirmCardObject:function(t){var e=this._firmCardSetup();return this.firmCard=new FirmCard(t,e),this._initPopupClose(),this.firmCard.getContainer()},_firmListSetup:function(){var t=this._firmCardSetup();return DG.extend(t,{backBtn:DG.bind(this._showHousePopup,this),onFirmClick:DG.bind(this._onFirmListClick,this),onShowLess:DG.bind(this._showHousePopup,this),pasteLoader:DG.bind(this._pasteLoader,this)}),{firmCard:t,firmlistItemTmpl:"firmlistItem",onListReady:DG.bind(this._renderFirmList,this)}},_initShortFirmList:function(t){var e=this._firmListSetup();return this._shortFirmList=new FirmCard.List(t,e),this._shortFirmList.renderList()},_initFirmList:function(t){if(!t)return!1;var e=t.result.items,i=this._firmListSetup();i.firmCard.backBtn=DG.bind(this._showListPopup,this),this._shortFirmList._toggleEventHandlers(!0),this._firmList=new FirmCard.List(e,i),this._firmListObject=this._fillFirmListObject(this._firmList.renderList()),this._clearAndRenderPopup(this._firmListObject)},_fillFirmListObject:function(t){var e=this;return{tmpl:t,header:this._header,footer:this._view.render({tmpl:"popupFooterBtns",data:{btns:[{name:"back",label:this.t("back_button"),icon:!0}]}}),afterRender:function(){e._initPopupClose(),e._totalPages>1&&e._firmListLoader&&this.tmpl.parentNode.appendChild(e._firmListLoader)}}},_onFirmReady:function(t){var e=this;t.afterRender=function(){var t=e._popup._popupStructure.header.firstChild;DG.Browser.ielt9||t.offsetHeight>72&&(DG.DomUtil.addClass(t,"dg-popup__header-teaser"),DG.Browser.webkit||DG.Geoclicker.clampHelper(t,3))},this._clearAndRenderPopup(t)},_showHousePopup:function(){this._popup.off("scroll",this._onScroll),this._clearAndRenderPopup(this._houseObject),this._shortFirmList._toggleEventHandlers()},_onFirmListClick:function(){this._popup.off("scroll",this._onScroll)},_pasteLoader:function(){var t=DG.DomUtil.create("div","dg-map-geoclicker__preloader-wrapper"),e=this._view.initLoader();t.insertBefore(e,t.firstChild),t.style.height=this._popup._contentNode.offsetHeight-1+"px",t.style.width=this._popup._contentNode.offsetWidth+"px",this._clearAndRenderPopup({tmpl:t})},_initPopupClose:function(){this._initedPopupClose||(this._controller.getMap().once("popupclose",DG.bind(this._onPopupClose,this)),this._initedPopupClose=!0)},_showListPopup:function(){var t=this._firmListObject;this._pasteLoader(),t?(this._clearAndRenderPopup(t),this._firmList._toggleEventHandlers()):t=this._api.firmsInHouse(this._id).then(DG.bind(this._initFirmList,this)),this._onScroll||(this._onScroll=DG.Util.throttle(this._handlePopupScroll,this._scrollThrottleInterval,this)),this._popup.on("scroll",this._onScroll)},_renderFirmList:function(){this._isFirmlistOpen||(this._popup.resize(),this._isFirmlistOpen=!0)},_onPopupClose:function(){this._initedPopupClose=!1,this._firmList&&(this._firmList.clearList(),this._firmList=null,this._popup.off("scroll",this._onScroll)),this._firmId=null,this.firmCard&&(this.firmCard._toggleEventHandlers(!0),this.firmCard=null),this._firmListLoader=null,this._page=1,this._clearEventHandlers()},_initShowMore:function(){var t=this._popup.findElement(".dg-popup__button_name_all");t&&this._addEventHandler("dg-popup__button_name_all",DG.bind(this._showListPopup,this))},_clearAndRenderPopup:function(t){this._clearEventHandlers(),this._popup.clear("header","footer"),this._view.renderPopup(t)},_appendFirmList:function(t){this._firmList.addFirms(t.result.items),this._popup._updateScrollPosition()},_handlePopupScroll:function(t){var e=t.originalEvent.target||t.target._scroller;DG.DomEvent.stop(t),this._totalPages<=1||e&&e.scrollHeight<=e.scrollTop+e.offsetHeight+this._scrollHeightReserve&&this._handlePaging()},_handlePaging:function(){if(this._page++,this._totalPages&&this._page<=this._totalPages&&this._api.firmsInHouse(this._id,{page:this._page}).then(DG.bind(this._appendFirmList,this)),this._page===this._totalPages){var t=this._firmListLoader;t&&t.parentNode&&t.parentNode.removeChild(t),this._popup.off("scroll",this._onScroll)}}}),DG.Geoclicker.Handler.House.include({_getAddressString:function(t){return t.address&&t.address.components?t.address.components.filter(function(t){return"street_number"===t.type}).map(function(t){return t.street+", "+t.number}).join(" / "):""},_fillBody:function(t){var e={},i=DG.DomUtil.create("div","dg-building-callout__body"),n=t.links.branches,o=this._getDrilldown(t);return t.building_name?e.address={header:this._getAddressString(t),drilldown:o}:o&&(e.address={drilldown:o}),e.purpose=t.purpose_name+(t.floors?", "+this.t("n_floors",t.floors.ground_count):""),n&&n.count>0&&(this._totalPages=Math.ceil(t.links.branches.count/this._firmsOnPage)),t.links.attractions&&t.links.attractions.length&&(e.attractions=t.links.attractions.reduce(function(t,e){return e.name&&t.push(e.name),t},[])),i.innerHTML=this._view.render({tmpl:"house",data:e}),n&&n.items&&i.appendChild(this._initShortFirmList(n.items)),i},_fillHeader:function(t){var e={};return t.building_name?e.title=t.building_name:t.address&&t.address.components?e.title=this._getAddressString(t):e.title=t.purpose_name,this._header=this._view.render({tmpl:"popupHeader",data:e}),this._header},_fillFooter:function(t){var e=[],i=t.links.branches;return i&&i.items&&i.items.length&&i.count>i.items.length&&e.push(this._getShowAllData(i.count)),this._isRouteSearchAllowed()&&e.push({name:"goto",label:this.t("go_to"),icon:!0,href:this._directionsUrl}),this._view.render({tmpl:"popupFooterBtns",data:{btns:e}})},_getShowAllData:function(t){return{name:"all",label:this.t("show_organization_in_building",t)}},_fillHouseObject:function(t){var e=this;return{header:this._fillHeader(t),tmpl:this._fillBody(t),footer:this._fillFooter(t),afterRender:function(){e._initShowMore(),e._initPopupClose()}}}}),DG.Geoclicker.Handler.Poi=DG.Geoclicker.Handler.House.extend({handle:function(t){if(!t.poi)return!1;if(this.firmCard=null,this._page=1,this._houseObject=null,this._firmList=null,this._firmListObject=null,this._firmCardObject=null,this._onScroll=!1,this._isFirmlistOpen=!1,this._id=t.poi.reference.id,this._totalPages=1,this._api=this._controller.getCatalogApi(),this._popup=this._view.getPopup(),this._initedPopupClose=!1,this._directionsUrl=this._getDirectionsUrl(t.poi.reference.name),this._firmListLoader=this._view.initLoader(!0),"building"===t.poi.reference.type){var e=this;return e._api.geoGet(t.poi.reference.id).then(function(t){return e._houseObject=e._fillHouseObject(t.result.items[0]),Promise.resolve(e._houseObject)})}return"branch"===t.poi.reference.type?(this._fillFirmCardObject(t.poi.reference.id),!0):!1}}),DG.Geoclicker.Handler.Sight=DG.Geoclicker.Handler.Default.extend({handle:function(t){return t.attraction?(this._popup=this._view.getPopup(),this._initedPopupClose=!1,Promise.resolve(this._fillSightObject(t))):!1},_fillSightObject:function(t){var e=t.attraction,i={},n=this,o={btns:[{name:"goto",label:this.t("go_to"),icon:!0}]};return e.name?(i.buildingName=e.name,i.purpose=e.subtype_name):i.buildingName=e.subtype_name,i.description=e.description,i.drillDown=this._getDrilldown(e),this._checkDescFieldHeight(i.description)&&(i.showMoreText=this.t("show_more_about_sight")),o.btns[0].href=this._getDirectionsUrl(i.buildingName),{tmpl:"sight",data:i,header:this._view.render({tmpl:"popupHeader",data:{title:i.buildingName}}),footer:this._view.render({tmpl:"popupFooterBtns",data:o}),afterRender:function(){n._needShowMore&&n._initShowMore(),n._initPopupClose()}}},_initPopupClose:function(){this._initedPopupClose||(this._controller.getMap().once("popupclose",DG.bind(this._clearPopup,this)),this._initedPopupClose=!0)},_clearPopup:function(){this._initedPopupClose=!1,this._clearEventHandlers()},_showMoreText:function(){this._desc.style.maxHeight="100%",this._link.parentNode.removeChild(this._link),this._popup.resize()},_initShowMore:function(){this._link=this._popup.findElement(".dg-map-geoclicker__show-more-sights-link"),this._desc=this._popup.findElement(".dg-map-geoclicker__sight-description"),this._link&&this._desc&&this._addEventHandler("dg-map-geoclicker__show-more-sights-link",DG.bind(this._showMoreText,this))},_checkDescFieldHeight:function(t){var e,i=DG.DomUtil.create("div","");return i.style.visibility="hidden",i.innerHTML=t,this._popup._contentNode.appendChild(i),e=i.offsetHeight,this._popup._contentNode.removeChild(i),this._needShowMore=e>40,this._needShowMore}}),DG.Geoclicker.View=DG.Class.extend({initialize:function(t,e){this._map=t,this._popup=DG.popup({maxHeight:300,minHeight:50,maxWidth:385,minWidth:310,sprawling:!0,closeOnClick:!0}),e&&DG.Util.setOptions(this,e)},initLoader:function(t){var e=document.createElement("div");return e.innerHTML=DG.dust("DGGeoclicker/loader",{small:t,anim:this._detectCssAnimation()}),e.firstChild},showPopup:function(t,e){this._popup.setContent(e).setLatLng(t).openOn(this._map)},render:function(t){var e,i={};return t=t||{},t.tmpl=t.tmpl||"",e=t.data?this.renderTemplate(t.tmpl,t.data):t.tmpl,t.beforeRender&&t.beforeRender(),t.popup&&(t.header&&(i.header=t.header),t.footer&&(i.footer=t.footer),i.body=e,this._popup.setContent(i)),t.afterRender&&t.afterRender(),e},renderTemplate:function(t,e){return DG.dust("DGGeoclicker/"+t,e)},renderPopup:function(t){return t.popup=!0,this.render(t)},getPopup:function(){return this._popup},_detectCssAnimation:function(){var t=!1,e="Webkit Moz O ms Khtml".split(" "),i=document.createElement("div");if(i.style.animationName&&(t=!0),t===!1)for(var n=0;n<e.length;n++)if(i.style[e[n]+"AnimationName"]!==undefined){t=!0;break}return t}}),DG.Geoclicker.Controller=DG.Class.extend({options:{handlersSequence:{poi:DG.Geoclicker.Handler.Poi,attraction:DG.Geoclicker.Handler.Sight,building:DG.Geoclicker.Handler.House,street:DG.Geoclicker.Handler.CityArea,"adm_div.place":DG.Geoclicker.Handler.CityArea,"adm_div.district":DG.Geoclicker.Handler.CityArea,"adm_div.division":DG.Geoclicker.Handler.CityArea,"adm_div.settlement":DG.Geoclicker.Handler.CityArea,"adm_div.city":DG.Geoclicker.Handler.CityArea,"default":DG.Geoclicker.Handler.Default,apiError:DG.Geoclicker.Handler.ApiError}},initialize:function(t,e){this._options=e,this._handlers={},this._catalogApi=new DG.Geoclicker.Provider.CatalogApi(t),this._map=t,this._view=new DG.Geoclicker.View(t),this._renderHandlerResult=DG.bind(this._renderHandlerResult,this),this._lastHandleClickArguments=null},handlePopupClose:function(t){t===this._view.getPopup()&&(this._lastHandleClickArguments=null,this._catalogApi.cancelLastRequest())},handleClick:function(t,e,i){function n(){var e=o._view.initLoader();o._view._popup.clear(),o._view.showPopup(t,e),o._lastHandleClickArguments=r}var o=this,r=Array.prototype.slice.call(arguments,0);if(i&&i.linked){if("branch"!=i.linked.type&&"building"!=i.linked.type)return;n(),o.handleResponse({poi:{reference:i.linked}})}else this._catalogApi.getLocations({latlng:t,zoom:e,beforeRequest:n}).then(function(t){o.handleResponse(t)},function(t){o.handleResponse(t)})},handleResponse:function(t){var e;if(!t)return void this._runHandler("default");if("no type"!==t){if("aborted"===t)return void this._runHandler("apiError");for(e=this.findHandler(t);e;){if(this._runHandler(e,t))return;delete t[e],e=this.findHandler(t)}this._runHandler("default")}},findHandler:function(t){for(var e in this.options.handlersSequence)if(t[e])return e;return null},getCatalogApi:function(){return this._catalogApi},getMap:function(){return this._map},reinvokeHandler:function(){this._lastHandleClickArguments&&this.handleClick.apply(this,this._lastHandleClickArguments)},_runHandler:function(t,e){e=e||{},this._initHandlerOnce(t),this._handlers[t].addClickEvent();var i=this._handlers[t].handle(e,t);return i&&i.then?i.then(this._renderHandlerResult):i},_renderHandlerResult:function(t){this._view.renderPopup(t)},_initHandlerOnce:function(t){this._handlers[t]||(this._handlers[t]=new this.options.handlersSequence[t](this,this._view,this._map,this._options))}}),DG.Geoclicker.Handler.Default.Dictionary.it=DG.extend({apiErrorTitle:"Oh oh, c'è&nbsp;un&nbsp;errore",apiErrorBody:"I nostri server si rifiutano di rispondere. Stiamo facendo del nostro meglio per convincerli a&nbsp;comportarsi bene. Ritorna tra qualche minuto.",we_have_not:"Non disponiamo ancora di informazioni su questo posto",noname:"Nome non indicato","adm_div.place":"Luogo","adm_div.division":"Zona","adm_div.settlement":"Comune",street:"Via","adm_div.district":"Municipalità","adm_div.city":"Сittà",go_to:"Come arrivare",show_organization_in_building:["{n} azienda in tutto","{n} aziende in tutto"],show_more_about_sight:"Maggiori informazioni",back_button:"Indietro",n_floors:["{n} piano","{n} piani"]},DG.Dictionary.it),DG.Geoclicker.Handler.Default.Dictionary.ru=DG.extend({apiErrorTitle:"Ошибочка вышла",apiErrorBody:"Наши серверы отказываются отвечать. Мы уже прикладываем все силы, чтобы вразумить их. Возвращайтесь к&nbsp;нам через&nbsp;несколько минут.",we_have_not:"Это место мы ещё не успели изучить",noname:"Без названия","adm_div.place":"Место","adm_div.division":"Округ","adm_div.settlement":"Населенный пункт",street:"Улица","adm_div.district":"Район","adm_div.city":"Город",go_to:"Проехать сюда",show_organization_in_building:["Всего {n} организация","Всего {n} организации","Всего {n} организаций"],show_more_about_sight:"Подробнее",back_button:"Назад",n_floors:["{n} этаж","{n} этажа","{n} этажей"]},DG.Dictionary.ru),DG.Geoclicker.Handler.Default.Dictionary.en=DG.extend({apiErrorTitle:"Oops! Error detected.",apiErrorBody:"Our servers are not responding. We are doing our best to straighten them out. Please return to us in a few minutes.",we_have_not:"We haven't collected info about this place yet",noname:"No name","adm_div.place":"Place","adm_div.division":"Area","adm_div.settlement":"Village",street:"Street","adm_div.district":"District","adm_div.city":"City",go_to:"Directions to here",show_organization_in_building:["{n} organization total","{n} organizations total"],back_button:"Back",show_more_about_sight:"More information",n_floors:["{n} floor","{n} floors"]},DG.Dictionary.en),DG.Geoclicker.Handler.Default.Dictionary.cs=DG.extend({apiErrorTitle:"Chybička se&nbsp;vloudila",apiErrorBody:"Naše servery odmítají reagovat. Již nyní vynakládáme veškeré úsilí, abychom je přivedli k rozumu. Zkuste akci opakovat za několik minut.",we_have_not:"O tomto místě zatím nemáme informace",noname:"Bez názvu","adm_div.place":"Místo","adm_div.division":"Správní obvod","adm_div.settlement":"Obec",street:"Ulice","adm_div.district":"Městská část","adm_div.city":"Město",go_to:"Cesta sem",show_organization_in_building:["Celkem {n} organizace","Celkem {n} organizace","Celkem {n} organizací"],back_button:"Zpět",show_more_about_sight:"Více",n_floors:["{n} patro","{n} patra","{n} pater"]},DG.Dictionary.cs),DG.Geoclicker.Handler.Default.Dictionary.es=DG.extend({apiErrorTitle:"Vaya, ha ocurrido un error",apiErrorBody:"Nuestros servidores se niegan a responder. Ya nos estamos esforzando por hacerlos entrar en razón. Vuelva con nosotros pasados unos minutos.",we_have_not:"Todavía no hemos recopilado la información sobre este lugar",noname:"Sin nombre","adm_div.place":"Lugar","adm_div.division":"Comuna","adm_div.settlement":"Población",street:"Calle","adm_div.district":"Comuna","adm_div.city":"Ciudad",go_to:"Ir para allá",show_organization_in_building:["Total {n} organización","Total {n} organizaciones","Total {n} organizaciones"],show_more_about_sight:"Read more",back_button:"Atrás",n_floors:["{n} piso","{n} pisos"]},DG.Dictionary.es);var FirmCard=function(t,e){this._setOptions(e),this._firmContentObject={},this._schedule=new FirmCard.Schedule({localLang:this.options.lang,dict:this.dict}),this.render(t)};FirmCard.prototype={render:function(t){return t?(t!==this._firmId?(this._firmContentObject={},this._renderCardById(t)):this._toggleEventHandlers(),this._firmContentObject):void 0},getSchedule:function(){return this._schedule},getContainer:function(){return this._container},_renderCardById:function(t){var e=this;this.options.ajax(t).then(function(i){if(!i)return!1;var n=i.result.items;"undefined"!==n&&(e._firmData=n[0],e._convertWebsite(),e._firmId=t,e._renderFirmCard(),e._toggleEventHandlers())},function(t){e._renderError()})},_createFirmContainer:function(){var t=document.createElement("div");return t.setAttribute("id","dg-map-firm-full-"+this._firmId),t.setAttribute("class","dg-map-firm-full"),t},_getPaymentTypes:function(t){var e=[],i="general_payment_type";return t.attribute_groups?(t.attribute_groups.forEach(function(t){t.name||t.attributes.forEach(function(t){t.tag.substring(0,i.length)===i&&e.push(t.name)})}),e):e},_groupRubrics:function(t){var e={primary:[],additional:[]};return t.rubrics&&t.rubrics.length?(t.rubrics.forEach(function(t){e[t.kind].push(t)}),e):e},_convertWebsite:function(){this._firmData.contact_groups&&this._firmData.contact_groups.forEach(function(t){t.contacts&&t.contacts.forEach(function(t){"website"==t.type&&(t.url||(t.url=t.value))})})},_renderFirmCard:function(){var t,e,i,n,o,r,s,a=this._firmData,l=this._container=this._createFirmContainer();e=this._schedule.transform(a.schedule,{zoneOffset:this.options.timezoneOffset,apiLang:this.options.lang,localLang:this.options.lang}),i=this._schedule.forecast(e),r=this._getPaymentTypes(a),s=this._groupRubrics(a),t=this._buildFirmCardBody(this._getConfigFirmCardBody(a,e,i,r,s)),n=this._fillHeaderLinks(),o=this._fillFooterButtons(),this._firmContentObject.header=this.options.render("firmCardHeader",{firmName:a.name,links:n}),l.innerHTML=t,this._firmContentObject.tmpl=l,o.length&&(this._footerContainer=document.createElement("div"),this._footerContainer.innerHTML=this.options.render("popupFooterBtns",{btns:o}),this._firmContentObject.footer=this._footerContainer),this.options.onFirmReady&&this.options.onFirmReady(this._firmContentObject)},_renderError:function(){this._firmContentObject.header=this.options.render("popupHeader",{title:this.options.t("apiErrorTitle")}),this._firmContentObject.tmpl=this.options.t("apiErrorBody"),this.options.onFirmReady&&this.options.onFirmReady(this._firmContentObject)},_getConfigFirmCardBody:function(t,e,i,n,o){return[{tmpl:"firmCardAddr",data:{address:t.address_name,comment:t.address_comment}},{tmpl:"firmCardContacts",data:{groups:t.contact_groups}},{tmpl:"firmCardSchedule",data:{schedule:e,forecast:i}},{tmpl:"frimCardPayments",data:{payments:n}},{tmpl:"firmCardRubric",data:{rubrics:o}}]},_buildFirmCardBody:function(t){var e=this;return t.reduce(function(t,i){var n=e.options.render(i.tmpl,i.data);return t+n},"")},_fillFooterButtons:function(){var t=[];return this.options.backBtn&&t.push({name:"firm-card-back",label:this.dict.t(this.options.lang,"btnBack"),icon:!0}),this.options.showRouteSearch&&t.push({name:"goto",label:this.dict.t(this.options.lang,"btnFindWay"),icon:!0,href:this.options.gotoUrl}),this._firmData.links&&this._firmData.links.entrances&&this.options.showEntrance&&t.push({name:"show-entrance",label:this.dict.t(this.options.lang,"btnEntrance"),icon:!0}),t},_fillHeaderLinks:function(){var t,e,i=[],n=this._firmData.reviews;this._firmData.external_content&&this._firmData.external_content.forEach(function(e){e&&"booklet"==e.type&&(t=e)}),n&&n.is_reviewable&&(i.push({name:"flamp_stars",width:20*n.rating}),i.push({name:"flamp_reviews",label:this.dict.t(this.options.lang,"linkReviews",n.review_count?n.review_count:0),href:FirmCard.DataHelper.getFlampUrl(this._firmId)}));for(var o,r=this._firmData.external_content,s=0;s<r.length;s++)if("photo_album"==r[s].type&&"common"==r[s].subtype){o=r[s];break}return!this.options.isMobile&&o&&o.count&&this.options.showPhotos&&(e=L.Util.template(DG.config.photosLink,{id:this._firmId,domain:this.options.domain}),i.push({name:"photos",href:e,label:this.dict.t(this.options.lang,"linkPhoto",o.count)})),!this.options.isMobile&&t&&t.url&&this.options.showBooklet&&i.push({name:"booklet",href:t.url,label:this.dict.t(this.options.lang,"linkBooklet")}),i},_events:{"dg-popup__button_name_firm-card-back":function(){this.options.backBtn(),this._toggleEventHandlers(!0)},"dg-popup__button_name_show-entrance":function(){var t=new this.options.showEntrance({vectors:this._firmData.links.entrances[0].geometry.vectors});t.addTo(this.options.map),t.fitBounds(),this._toggleEventHandlers(!0)},"dg-schedule__today":function(){this._onToggleSchedule()}},_toggleEventHandlers:function(t){this.options.popup[t?"off":"on"]("click",this._onClick,this),this.options.map[t?"off":"on"]("popupclose",this._onClose,this)},_onClick:function(t){var e=t.originalEvent.target;for(var i in this._events)if(this._events.hasOwnProperty(i)&&e.className.indexOf(i)>-1)return DG.DomEvent.preventDefault(t.originalEvent),void this._events[i].call(this,e)},_onClose:function(t){this._toggleEventHandlers(!0)},_onToggleSchedule:function(){var t=this._container.querySelector(".dg-schedule__table"),e=this._container.querySelector(".dg-schedule__now"),i=this._container.querySelector(".dg-schedule__today"),n=" dg-schedule__today_shown_true";t&&("block"===t.style.display?(t.style.display="none",e.style.display="block",i.className=i.className.replace(n,"")):(e.style.display="none",t.style.display="block",i.className+=n),this.options.onToggle&&this.options.onToggle())},_setOptions:function(t){var e,t=t||{};this.options=t,t.lang=t.lang||"ru";for(e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e])},_hasTouch:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}},FirmCard.DataHelper={payMethods:["americanexpress","cash","dinersclub","goldcrown","internet","mastercard","noncash","visa"],_msgs:{},getFlampUrl:function(t){return DG.config.flampUrl.concat(t,"?",DG.config.flampGoogleAnalytics)},msg:function(t){return this._msgs.hasOwnProperty(t)?this._msgs[t]:(console&&console.log("Cant't find translation for '"+t+"'."),t.toString().replace("_"," "))},getProjectTime:function(t,e){var i,n;return i=e?new Date(e):new Date,t?(n=i.getTime()+6e4*i.getTimezoneOffset(),new Date(n+6e4*t)):i}},function(){FirmCard.List=function(t,e){this._firms={},this._setOptions(e),this._container=e&&e.container||document.createElement("ul"),this._container.setAttribute("class","dg-building-callout__list"),this._eventHandlersInited=!1,this._firmCard=this._createFirm(),this.renderList(t)},FirmCard.List.prototype={renderList:function(t){return t&&(this._toggleEventHandlers(),this.addFirms(t)),this.options.onListReady&&this.options.onListReady(this._container),this._container},_processFirms:function(t,e){if(t){var i="_"+e+"Firm";if(this._isArray(t))for(var n=0,o=t.length;o>n;n++)this[i](t[n]);else this[i](t)}},addFirms:function(t){this._processFirms(t,"add")},removeFirms:function(t){this._processFirms(t,"remove")},setLang:function(t){this.options.firmCard.lang=t},getLang:function(){return this.options.firmCard.lang},getContainer:function(){return this._container},clearList:function(){this._firms={},this._toggleEventHandlers(!0),this._clearContainer()},_removeFirm:function(t){return this._firms[t]?(this._container.removeChild(this._firms[t]),void delete this._firms[t]):!1},_addFirm:function(t){var e,i,n,o=this.options.firmlistItemTmpl;i={name:t.name,id:t.id.split("_").slice(0,1)},i.id in this._firms||(e=this._createListItem(),n=o?this.options.firmCard.render(o,{firm:i}):i.name,e.insertAdjacentHTML("beforeend",n),this._firms[i.id]=e,this._container.appendChild(e))},_createListItem:function(){var t=document.createElement("li");return t.setAttribute("class","dg-building-callout__list-item"),t},_isArray:function(t){return"[object Array]"==={}.toString.call(t)},_createFirm:function(t){return new FirmCard(t,this.options.firmCard)},_isEmptyObj:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},_events:{"dg-popup__link":function(t){var e=this._firmCard.render(t.id);this.options.firmCard[this._isEmptyObj(e)?"pasteLoader":"onFirmReady"](e),this.options.firmCard.onFirmClick&&this.options.firmCard.onFirmClick(),this._toggleEventHandlers(!0)},"dg-building-callout__list-item":function(t){t=t.children[0],this._events["dg-popup__link"].call(this,t)},"dg-popup__button_name_back":function(){this.options.firmCard.onShowLess(),this._toggleEventHandlers(!0)}},_toggleEventHandlers:function(t){this.options.firmCard.popup[t?"off":"on"]("click",this._onClick,this)},_onClick:function(t){var e=t.originalEvent.target;for(var i in this._events)if(this._events.hasOwnProperty(i)&&e.className.indexOf(i)>-1)return DG.DomEvent.preventDefault(t.originalEvent),void this._events[i].call(this,e)},_clearContainer:function(){for(var t=this._container;t.hasChildNodes();)t.removeChild(t.firstChild)},_setOptions:function(t){t||(t={}),this.options=t,this.options.firmCard||(this.options.firmCard={}),t.firmCard.lang||(this.options.firmCard.lang="ru");for(var e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e])}}}(),FirmCard.Schedule=function(t){return t=t||{},this.localLang=t.localLang||"ru",this.dict=t.dict,this},FirmCard.Schedule.prototype={setLang:function(t){return this.localLang=t||"ru",this},transform:function(t,e){function i(t,e){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}}function n(t){return t.charAt(0).toUpperCase()+t.slice(1)}function o(t){return t.substr(0,2)}function r(t){return t.substr(3,2)}function s(t){var e=+o(t)%24+"";return 1===e.length&&(e="0"+e),e+":"+r(t)}function a(t){return t%7}function l(t,e){return null!=t?null==e?t[t.length-1]:slice.call(t,Math.max(t.length-e,0)):void 0}function u(t,e){if(t===e)return!0;if(!(t instanceof Object&&e instanceof Object))return!1;if(t.constructor!==e.constructor)return!1;for(var i in t)if(t.hasOwnProperty(i)){if(!e.hasOwnProperty(i))return!1;if(t[i]!==e[i]){if("object"!=typeof t[i])return!1;if(!u(t[i],e[i]))return!1}}for(i in e)if(e.hasOwnProperty(i)&&!t.hasOwnProperty(i))return!1;return!0}function c(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),o=0,r=new Array(n);n>o;)r[o++]=t,t+=i;return r}function h(t){var e=Array.prototype.slice.call(arguments,1);return e.forEach(function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t}function d(t,e){return p(t.map(function(t,i,n){return{value:t,index:i,criteria:e.call(this,t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")}function p(t,e){var i,n=[];for(i=0;i<t.length;++i)n[i]=t[i][e];return n}function _(t){var e,i,n,s,a=[];if(!t||!t.working_hours)return[];for(var l=0;l<t.working_hours.length;l++)e=t.working_hours[l].from,i=t.working_hours[l].to,n=o(i)-o(e),s=r(i)-r(e),(0>n||0===n&&0>=s)&&(i=+o(i)+24+":"+r(i)),a[2*l]={time:e,type:"open"},a[2*l+1]={time:i,type:t.working_hours.length-1===l?"close":"lunch"};return a}function m(t){for(var e,i,n=[],s=[],l=G.indexOf(w),u=0;7>u;u++)i=a(l+u),e=_(t[G[i]]),e.forEach(function(t){var e=new Date(E);e.setDate(e.getDate()+u),e.setHours(o(t.time)),e.setMinutes(r(t.time));var i=e.getTime();n.push({ts:i,type:t.type}),n[n.length-1]&&n[n.length-2]&&n[n.length-1].ts===n[n.length-2].ts&&(n.pop(),n.pop()),n[n.length-1]&&n[n.length-2]&&n[n.length-1].ts<=E&&n[n.length-2].ts<=E&&(n[n.length-1].ts+=6048e5,n[n.length-2].ts+=6048e5)});for(n=d(n,function(t){return t.ts}),u=0;u<n.length;)n[u+1]&&n[u].ts===n[u+1].ts?u++:s.push(n[u].ts),u++;return 2===s.length&&s[1]-s[0]===6048e5?[]:n}function f(t,e,i){if(1===e&&t>N)return R(z,"tommorow");if(e>1)switch(i){case 0:return R(z,"nextSun");case 1:return R(z,"nextMon");case 2:return R(z,"nextTue");case 3:return R(z,"nextWed");case 4:return R(z,"nextThu");case 5:return R(z,"nextFri");case 6:return R(z,"nextSat")}}function g(t,e){var i,n=864e5,o=new Date(t.ts);return i=Math.round((o-e)/n),"open"===t.type&&o.getHours()<1&&i++,i}function v(e){var i,n,o=[];C.now={},n=m(t),n.length||(C.always=!0,C.now.open=!0);for(var r=0;r<n.length;r++)if(E>=(n[r-1]&&n[r-1].ts||0)&&E<n[r].ts){var a=Math.floor((n[r].ts-E)/36e5),u=Math.floor((n[r].ts-E)/6e4-60*a),c=new Date(E),h="open"!==n[r].type,d=g(n[r],c);u=10*Math.floor(u/10)?10*Math.floor(u/10):5,C.now.open=h,C.now.lunch=!!(n[r-1]&&"lunch"===n[r-1].type||"lunch"===l(n).type),C.will={willType:n[r].type,d:d,h:a,m:u};var v=new Date(n[r].ts);C.will.when=f(a,d,v.getDay());var y=new Date(n[r].ts),L=y.getHours(),b=y.getMinutes();10>L&&(L="0"+L),10>b&&(b="0"+b),C.will.till=L+":"+b}if(e){for(i=p(_(e),"time"),r=2;r<i.length;r+=2)o.push({from:i[r-1],to:i[r]});k=s(i[0]),P=s(i[i.length-1]),k===P?C.today={alltime:!0,alltimeStr:R(z,"worksAroundTheClock"),from:"00:00",to:"24:00"}:C.today={from:k,to:P},o.length>0&&(C.lunch=o,C.lunchStr=R(z,"lunch"))}}function y(){for(var e=[],i=!1,n=0;7>n;n++){var o=G[n],r=0;if(e[n]={},t[o]){for(var a=t[o],l=p(_(a),"time"),u=[],d=2;d<l.length;d+=2)i=!0,u.push({from:l[d-1],to:l[d]});r=Math.max(l.length/2,r),e[n]={from:s(l[0]),to:s(l[l.length-1]),lunch:u}}o===w&&(e[n].active=!0),e[n].key=O[n]}return e.forEach(function(t){t.lunch&&h(t.lunch,c(1,r))}),{table:e,hasLunch:i}}function L(t,e){var i,o={dayList:[],lunch:[]},r=[];if(t&&t.working_hours&&t.working_hours.length){i=p(_(t),"time"),
i.forEach(function(t,e){0===e?o.from=s(t):e===i.length-1?o.to=s(t):r.push(s(t))});for(var l=0;l<r.length;l+=2)o.lunch.push({from:r[l],to:r[l+1],lunchStr:n(R(z,"lunch"))});"00:00"==o.from&&"00:00"==o.to&&(o.to="24:00"),t.round_the_clock&&(o.alltime=!0,o.alltimeStr=R(z,"worksAroundTheClock"))}else o.holiday=!0;var c=[0,0,0,0,0,0,0],h=0;return G.forEach(function(i,n){if(u(e[i],t)||!e[i]&&null===t)o.dayList.push(T[n]),c[a(n+B)]=1,h++;else{if(h>2){for(var r=o.dayList.pop(),s=1;h-1>s;s++)o.dayList.pop();o.dayList[o.dayList.length-1]+=" — "+r}h=0}}),o.budni=u(A,c),o.everyday=1===Math.min.apply(Math,c),o.holiday&&(o.holidayStr=R(z,"restDay",o.dayList.length).slice(2)),o.dayList=o.dayList.join(", "),o.dayList=o.dayList.charAt(0).toUpperCase()+o.dayList.slice(1),o}function b(t,e){for(var i=[],n=t.length-1;n>=0;n--)i.push(L(t[n],e));return i}if(t){e=e||{};for(var w,D,k,P,x=e.zoneOffset||0,C={},E=e.now||FirmCard.DataHelper.getProjectTime(x).getTime(),G=[],O=[],T=[],S=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],M=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],z=e.localLang||this.localLang,A=e.localWorkingDays||[0,1,1,1,1,1,0],B=e.firstdayOffset||1,N=e.minHoursToDisplayClosure||4,R=i(this.dict.t,this.dict),j=0;7>j;j++)G[j]=S[j],O[j]=this.dict.t(z,S[j].toLowerCase()),T[j]=this.dict.t(z,M[j]);w=S[(new Date(E).getDay()-B)%7],D=t[w],v(D);var U=[],I=0,H=0,Z=[];if(Object.keys(t).forEach(function(e){t[e]&&t[e].working_hours&&(I++,u(t[e],l(U))||U.push(t[e]))}),H=U.length,7>I&&H++,H>2)C.week=y(t);else if(1===H)C.week={evently:[L(t[G[0]],t)]};else{for(j=0;H>j;j++)if(Z[j]=0,U[j])for(var F=p(_(U[j]),"time"),W=0;W<F.length;W+=2){var V=o(F[W+1])+r(F[W+1])/60-(o(F[W])+r(F[W])/60);Z[j]+=V}else U[j]=null;var q=d(U,function(t,e){return Z[e]});C.week={evently:b(q,t)}}return C.comment=t.comment,C.week&&C.week.evently&&1===C.week.evently.length&&(C.everyday=C.week.evently[0].everyday),C}},forecast:function(t,e){var i,n,o="",r={},s=e&&e.maxHours||1;return t?t.always?{today:{text:this.dict.t(this.localLang,"aroundTheClock")},open:!0}:(t.will&&t.will.h<s&&(t.will.h&&(o+=this.dict.t(this.localLang,"nHours",t.will.h)+" "),t.will.m&&(o+=this.dict.t(this.localLang,"nMins",t.will.m))),t.today?(r.text=this.dict.t(this.localLang,"today"),t.everyday&&(r.text=this.dict.t(this.localLang,"everyday")),r.from=t.today.from,r.to=t.today.to,r.lunch=t.lunch,r.lunch&&(r.lunchStr=this.dict.t(this.localLang,"lunch"))):r.text=this.dict.t(this.localLang,"todayIsRestDay"),t.always?(r.text=this.dict.t(this.localLang,"aroundTheClock"),i=!0):t.now&&(i=t.now.open,n=i?t.will&&"lunch"===t.will.willType?t.will&&t.will.h<s?this.dict.t(this.localLang,"_in")+" "+this.dict.t(this.localLang,"nMins",o)+this.dict.t(this.localLang,"isClosingOnDinner"):this.dict.t(this.localLang,"isOpen"):t.will.h<s?this.dict.t(this.localLang,"closeIn")+this.dict.t(this.localLang,"nMins",o):this.dict.t(this.localLang,"isOpen"):t.will&&t.will.when?this.dict.t(this.localLang,"open")+t.will.when:t.now&&t.now.lunch?t.will.h<s?this.dict.t(this.localLang,"Lunch")+this.dict.t(this.localLang,"openIn")+this.dict.t(this.localLang,"nMins",o):this.dict.t(this.localLang,"Lunch")+this.dict.t(this.localLang,"openAt")+t.will.till:t.will&&t.will.h<s?this.dict.t(this.localLang,"openIn")+this.dict.t(this.localLang,"nMins",o):this.dict.t(this.localLang,"openAt")+t.will.till),{today:r,now:n,open:i,week:t.week,comment:t.comment,everyday:t.everyday}):{}}},FirmCard.prototype.dict={t:function(t,e,i){var n,o,r,s=!1;return"undefined"==typeof this[t]&&(t="ru"),o=this[t][e],(s="undefined"!=typeof o)?(n=s?o:e,i!==undefined&&(i=parseInt(i,10),i=isNaN(i)?0:i,r=this[t].pluralRules(i),n=i+" "+o[r]),n?n:e):e},ru:{pluralRules:function(t){return t%10===1&&t%100!==11?0:t%10>=2&&4>=t%10&&t%10%1===0&&(12>t%100||t%100>14)?1:t%10===0||t%10>=5&&9>=t%10&&t%10%1===0||t%100>=11&&14>=t%100&&t%100%1===0?2:void 0},btnBack:"Назад",btnFindWay:"Проехать сюда",btnEntrance:"Найти вход",linkReviews:["отзыв","отзыва","отзывов"],linkPhoto:["фото","фото","фото"],linkBooklet:"Буклет",tommorow:"завтра",afterTommorow:"послезавтра",afterWeek:"через неделю",nextSun:"в воскресенье",nextMon:"в понедельник",nextTue:"во вторник",nextWed:"в среду",nextThu:"в четверг",nextFri:"в пятницу",nextSat:"в субботу",willOpen:"откроется",willClose:"закроется",isOpen:"Открыто",openTill:"Открыто до ",closeIn:"Закроется через ",openAt:"Откроется в ",openIn:"Откроется через ",open:"Откроется ",nHours:["час","часа","часов"],nMins:["минуту","минуты","минут"],lunch:"обед",Lunch:"Обед. ",workingDays:"Рабочие дни",weekdays:"Будние дни",restDay:["выходной","выходные","выходные"],reviewsOnFlamp:"Отзывы на Флампе",writeReviewOnFlamp:"Написать отзыв на Флампе",payment:"оплата",everyday:"Ежедневно c",worksAroundTheClock:"Работает круглосуточно",aroundTheClock:"Круглосуточно",knowMore:"узнать больше",toClose:"до закрытия",monday:"понедельник",tuesday:"вторник",wednesday:"среда",thursday:"четверг",friday:"пятница",saturday:"суббота",sunday:"воскресенье",mon:"пон",tue:"втр",wed:"срд",thu:"чтв",fri:"птн",sat:"сбт",sun:"вск",toLunch:"до обеда",today:"Сегодня",lessThenHour:"менее часа",youCouldLate:"вы можете не успеть",workingTime:"рабочее время",showAllOrgInRubric:"Показать все организации рубрики",todayIsRestDay:"Сегодня выходной",internet:"Оплата через Интернет",noncash:"Безналичный расчет",goldcrown:"Золотая Корона",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Наличный расчет",americanexpress:"American Express",hour:"час",less:"менее",_in:"Через",isClosingOnDinner:" закрывается на обед"},it:{pluralRules:function(t){return 1===t?0:1},btnBack:"Indietro",btnFindWay:"Come arrivare ",btnEntrance:"Trova l'ingresso",linkReviews:["recensione","recensioni"],linkPhoto:["fotografia","fotografie"],linkBooklet:"Sull'azienda",tommorow:"domani",afterTommorow:"dopodomani",afterWeek:"tra una settimana",nextSun:"la domenica",nextMon:"il lunedi",nextTue:"il martedì",nextWed:"il mercoledì",nextThu:"il giovedi",nextFri:"il venerdì",nextSat:"il sabato",willOpen:"apre",willClose:"ciuso",isOpen:"Aperto",openTill:"Aperto fino alle ",closeIn:"Chiude tra ",openAt:"Apre alle ",openIn:"Apre tra ",open:"Apre ",nHours:["ora","ore"],nMins:["minuto","minuti"],lunch:"pausa pranzo",Lunch:"Pausa pranzo. ",workingDays:"Giorni feriali",weekdays:"Giorni feriali",restDay:["chiusura","chiusura"],reviewsOnFlamp:"Recensioni su Flamp",writeReviewOnFlamp:"Scrivi una recensione su Flamp",payment:"pagamento",everyday:"Ogni giorno dalole",worksAroundTheClock:"Operativo 24 ore su 24",aroundTheClock:"24 ore su 24",knowMore:"ulteriori informazioni",toClose:"fino alla chiusura",monday:"lunedi",tuesday:"martedì",wednesday:"mercoledì",thursday:"giovedi",friday:"venerdì",saturday:"sabato",sunday:"domenica",mon:"lun",tue:"mar",wed:"mer",thu:"gio",fri:"ven",sat:"sab",sun:"dom",toLunch:"fino alla pausa pranzo",today:"Oggi",lessThenHour:"meno di un'ora",youCouldLate:"affrettarsi, chiusura imminente",workingTime:"orario di lavoro",showAllOrgInRubric:"Visualizza tutte le aziende della categoria",todayIsRestDay:"oggi chiuso",internet:"Pagamento on-line",noncash:"Pagamento non in contanti",goldcrown:"Zolotaja Korona",dinersclub:"Diners Club",mastercard:"MasterCard",maestrocard:"MaestroCard",visa:"Visa",cash:"Pagamento in contanti",americanexpress:"American Express",hour:"un'ora",less:"meno di",_in:"Tra",isClosingOnDinner:"chiude per pausa pranzo"},en:{pluralRules:function(t){return 1===t?0:1},btnBack:"Back",btnFindWay:"Get here",btnEntrance:"Find entrance",linkReviews:["review","reviews"],linkPhoto:["photo","photos"],linkBooklet:"About company",tommorow:"tomorrow",afterTommorow:"the day after tomorrow",afterWeek:"in a week",nextSun:"on Sunday",nextMon:"on Monday",nextTue:"on Tuesday",nextWed:"on Wednesday",nextThu:"on Thursday",nextFri:"on Friday",nextSat:"on Saturday",willOpen:"opens ",willClose:"closes",isOpen:"Open",openTill:"Open till ",closeIn:"Closes in ",openAt:"Opens at ",openIn:"Opens in ",open:"Opens ",nHours:["hour","hours"],nMins:["minute","minutes"],lunch:"lunch break",Lunch:"Lunch break. ",workingDays:"Working days",weekdays:"Weekdays",restDay:["day off","days off"],reviewsOnFlamp:"Reviews on Flamp",writeReviewOnFlamp:"Write a review on Flamp",payment:"payment",everyday:"Daily from",worksAroundTheClock:"Open 24 hours",aroundTheClock:"24h",knowMore:"see also",toClose:"until closing",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sunday:"Sunday",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat",sun:"Sun",toLunch:"until lunch",today:"Today",lessThenHour:"less then one hour",youCouldLate:"you might be late",workingTime:"working hours",showAllOrgInRubric:"Show all organizations in the category",todayIsRestDay:"closed today",internet:"Online",noncash:" No-cash",goldcrown:"Golden Crown",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Cash",americanexpress:"American Express",hour:"hour",less:"less",_in:"In",isClosingOnDinner:"will be closing for lunch"},cs:{pluralRules:function(t){return 1===t?0:t>=2&&4>=t?1:2},btnBack:"Zpět",btnFindWay:"Jet sem",btnEntrance:"Hledat vstup",linkReviews:["recenze","recenze","recenzí"],linkPhoto:["fotografie","fotografie","fotografií"],linkBooklet:"Leták",tommorow:"zítra",afterTommorow:"pozítří",afterWeek:"za týden",nextSun:"v neděli",nextMon:"v pondělí",nextTue:"v úterý",nextWed:"ve středu",nextThu:"ve čtvrtek",nextFri:"v pátek",nextSat:"v sobotu",willOpen:"otevře se",willClose:"zavře se",isOpen:"Otevřeno",openTill:"Otevřeno do ",closeIn:"Zavře se za ",openAt:"Otevře se v ",openIn:"Otevře se za ",open:"Otevře se ",nHours:["hodinu","hodiny","hodin"],nMins:["minutu","minuty","minut"],lunch:"polední přestávka",Lunch:"Polední přestávka. ",workingDays:"Všední dny",weekdays:"Všední dny",restDay:["zavřeno","zavřeno"],reviewsOnFlamp:"Recenze na Flampu",writeReviewOnFlamp:"Napsat recenzi na Flampu",payment:"platba",everyday:"Denně od ",worksAroundTheClock:"Pracuje nonstop",aroundTheClock:"Nonstop",knowMore:"dozvědět se více",toClose:"do uzavření",monday:"pondělí",tuesday:"úterý",wednesday:"středa",thursday:"čtvrtek",friday:"pátek",saturday:"sobota",sunday:"neděle",mon:"po",tue:"út",wed:"st",thu:"čt",fri:"pá",sat:"so",sun:"ne",toLunch:"do polední přestávky",today:"Dnes",lessThenHour:"méně než hodinu",youCouldLate:"nemusíte to stihnout",workingTime:"pracovní doba",showAllOrgInRubric:"Zobrazit všechny organizace v rubrice",todayIsRestDay:"Dnes je zavřeno",internet:"Platba prostřednictvím Internetu",noncash:"Bezhotovostní platba",goldcrown:"Zolotaja Korona",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Platba hotově",americanexpress:"American Express",hour:"hodinu",less:"méně",_in:"Za",isClosingOnDinner:"začíná polední přestávka"},es:{pluralRules:function(t){return 1===t?0:t>=2&&4>=t?1:2},btnBack:"Atrás",btnFindWay:"Ir para allá",btnEntrance:"Buscar acceso",linkReviews:["comentario","comentarios","comentarios"],linkPhoto:["foto","fotos","fotos"],linkBooklet:"Folleto",tommorow:"mañana",afterTommorow:"pasado mañana",afterWeek:"en una semana más",nextSun:"el domingo",nextMon:"el lunes",nextTue:"el martes",nextWed:"el miércoles",nextThu:"el jueves",nextFri:"el viernes",nextSat:"el sábado",willOpen:"se abrirá",willClose:"se cerrará",isOpen:"Abierto",openTill:"Abierto hasta ",closeIn:"Se cerrará dentro de ",openAt:"Se abrirá el ",openIn:"Se abrirá dentro de ",open:"Se abrirá ",nHours:["hora","horas","horas"],nMins:["minuto","minutos","minutos"],lunch:"hora de colación",Lunch:"Hora de colación. ",workingDays:"Días laborables",weekdays:"Días laborables",restDay:["cerrado","cerrado"],reviewsOnFlamp:"Comentarios en Flamp",writeReviewOnFlamp:"Escribir un comentario en Flamp",payment:"pago",everyday:"Cada día desde",worksAroundTheClock:"Abierto las 24 horas",aroundTheClock:"24 horas",knowMore:"para saber más",toClose:"hasta el cierre",monday:"lunes",tuesday:"martes",wednesday:"miércoles",thursday:"jueves",friday:"viernes",saturday:"sábado",sunday:"domingo",mon:"lun",tue:"mar",wed:"mié",thu:"jue",fri:"vie",sat:"sáb",sun:"dom",toLunch:"antes de la hora de colación",today:"Hoy",lessThenHour:"menos de una hora",youCouldLate:"puede ser que no alcanzas a llegar",workingTime:"horario de trabajo",showAllOrgInRubric:"Mostrar todas las empresas de la categoría",todayIsRestDay:"Hoy cerrado",internet:"Pago por Internet",noncash:"Pago sin efectivo",goldcrown:"Zolotaya Korona",dinersclub:"Diners Club",mastercard:"Mastercard",maestrocard:"MaestroCard",visa:"Visa",cash:"Pago en efectivo",americanexpress:"American Express",hour:"hora",less:"menos de",_in:"Dentro de",isClosingOnDinner:"se cierra por hora de colación"}},DG.Traffic=DG.TileLayer.extend({options:{period:0,disableLabel:!1},statics:{Dictionary:{}},initialize:function(t){this._tileUrl=DG.config.protocol+DG.config.trafficTileServer,this._metaUrl=DG.config.protocol+DG.config.trafficMetaServer,this._timeUrl=DG.config.protocol+DG.config.trafficTimestampServer,this._updateInterval=DG.config.trafficLayerUpdateInterval,this._layersOptions={errorTileUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",subdomains:"012345679",maxNativeZoom:18,detectRetina:DG.config.detectRetina,minZoom:DG.config.trafficLayerMinZoom},t=DG.setOptions(this,DG.extend(t||{},this._layersOptions)),t.timestampString=t.period?"":"?"+(new Date).getTime(),this._metaLayer=DG.Meta.layer(null,{detectRetina:t.detectRetina,maxNativeZoom:t.maxNativeZoom,dataFilter:DG.bind(this._processData,this),minZoom:t.minZoom}),this._isDg=!0,this._onTimer=DG.bind(this._onTimer,this),DG.TileLayer.prototype.initialize.call(this,this._tileUrl,t)},onAdd:function(t){this._updateLayerProject(),t.addLayer(this._metaLayer).on("projectchange projectleave",this._onMapProjectChange,this),this.options.disableLabel||(this._metaLayer.on(this._layerEventsListeners,this),this._labelHelper=DG.label()),this._updateInterval&&(this._updateTimer=setInterval(this._onTimer,this._updateInterval)),DG.TileLayer.prototype.onAdd.call(this,t)},onRemove:function(t){clearInterval(this._updateTimer),t.removeLayer(this._metaLayer).off("projectchange projectleave",this._onMapProjectChange,this),this.options.disableLabel||(this._metaLayer.off(this._layerEventsListeners,this),this._map.removeLayer(this._labelHelper),this._labelHelper=null),DG.TileLayer.prototype.onRemove.call(this,t)},update:function(){var t=this;this._getTimestampString().then(function(e){t.options.timestampString="?"+e},function(){t.options.timestampString="?"+(new Date).getTime()}).then(function(){t.fire("update",{timestamp:t.options.timestampString}),t._layerEventsListeners.mouseout.call(t),t._metaLayer.getOrigin().setURL(t._prepareMetaURL(),t),t.redraw()})},getSubdomain:function(){return this._layersOptions.subdomains[Math.floor(Math.random()*this._layersOptions.subdomains.length)]},_getTimestampString:function(){return DG.ajax(DG.Util.template(this._timeUrl,DG.extend({s:this.getSubdomain(),projectCode:this._map.projectDetector.getProject().code},this.options||{})),{type:"get"})},_onTimer:function(){0===this.options.period&&this.update()},_processData:function(t,e){var i=this._map,n=e.scaleBy(this.getTileSize()),o={};return DG.Util.isArray(t)?(t[1].forEach(function(t){this[t.graph_id]=t.speed_text},o),t[0].map(function(t){var e=DG.Wkt.toGeoJSON(t.geometry[0].object[0]);return e.coordinates[0]=e.coordinates[0].map(function(t){return i.project([t[1],t[0]]).round().subtract(n)}),{id:t.graph_id,speed:o[t.graph_id],geometry:e}})):[]},_prepareMetaURL:function(){return DG.Util.template(this._metaUrl,DG.extend({x:"{x}",y:"{y}",z:"{z}",s:"{s}"},this.options))},_updateLayerProject:function(){var t=this._map.projectDetector.getProject();DG.setOptions(this,t&&t.traffic?{projectCode:t.code,bounds:t.latLngBounds,minZoom:Math.max(t.minZoom,this._layersOptions.minZoom),maxZoom:t.maxZoom}:{maxZoom:0,minZoom:0}),this._metaLayer.getOrigin().setURL(this._prepareMetaURL())},_onMapProjectChange:function(){this._updateLayerProject(),this.redraw()},_layerEventsListeners:{mouseover:function(t){this._setCursor("pointer"),this._labelHelper&&t.meta.speed&&this._labelHelper.setPosition(t.latlng).setContent(t.meta.speed+" "+this.t("speed_unit_km_h")).addTo(this._map)},mouseout:function(){this._setCursor(""),this._labelHelper&&this._map.removeLayer(this._labelHelper)},mousemove:function(t){this._labelHelper&&this._labelHelper.setPosition(t.latlng)}},_setCursor:function(t){this._map.getContainer().style.cursor=t}}),DG.Traffic.include(DG.Locale),DG.traffic=function(t){return new DG.Traffic(t)},DG.Traffic.Dictionary.ru={speed_unit_km_h:"км/ч"},DG.Traffic.Dictionary.it={speed_unit_km_h:"km/h"},DG.Traffic.Dictionary.cs={speed_unit_km_h:"km/h"},DG.Traffic.Dictionary.es={speed_unit_km_h:"km/h"},DG.Traffic.Dictionary.en={speed_unit_km_h:"km/h"},DG.Control.Traffic=DG.RoundControl.extend({options:{position:"topright",iconClass:"traffic"},statics:{Dictionary:{}},initialize:function(t){this._trafficClass="dg-traffic-control",this._controlHideClass="dg-control-round_is-hidden_true",DG.setOptions(this,t),DG.extend(this,{_active:!1,_trafficLayer:null}).on(this._controlEvents,this)},_controlEvents:{add:function(){this._trafficLayer=DG.traffic(),this._map.on("zoomend projectchange projectleave",this._updateControlVisibility,this)},click:function(){this._active=!this._active,this._active?(this.setState("active"),this._showTraffic()):(this.setState(""),this._hideTraffic())},remove:function(){this.off(this._controlEvents,this),this._map.off("zoomend projectchange projectleave",this._updateControlVisibility,this),this._active&&(this._map.removeLayer(this._trafficLayer),this._active=!1),this._trafficLayer=null}},_showTraffic:function(){this._updateTrafficScore(),this._map.addLayer(this._trafficLayer)},_hideTraffic:function(){this._handleDom("remove"),this._map.removeLayer(this._trafficLayer)},_handleDom:function(t,e){var i=this._link;i.innerHTML=e||"",DG.DomUtil[t+"Class"](i,this._trafficClass),DG.DomUtil[t+"Class"](i,this._trafficClass+"_color_"+this._scoreRate)},_getTrafficColor:function(t){var e="green";return t>7?e="red":t>4&&(e="yellow"),e},_updateControlVisibility:function(){var t=this._map.projectDetector.getProject(),e=t&&t.traffic,i=this._map.getZoom()<DG.config.trafficLayerMinZoom||!e?"addClass":"removeClass";DG.DomUtil[i](this._container,this._controlHideClass),this._active&&e&&this._updateTrafficScore()},_updateTrafficScore:function(){var t=this;this._getTrafficScore().then(function(e){e=parseInt(e,10),t._scoreRate=t._getTrafficColor(e),t._handleDom("add",e)})},_getTrafficScore:function(){var t=DG.Util.template(DG.config.protocol+DG.config.trafficScoreServer,{s:this._trafficLayer.getSubdomain(),projectCode:this._map.projectDetector.getProject().code});return DG.ajax(t,{type:"get"})},_renderTranslation:function(){this._link.title=this.t("button_title")}}),DG.control.traffic=function(t){return new DG.Control.Traffic(t)},DG.Map.mergeOptions({trafficControl:!1}),DG.Map.addInitHook(function(){this.options.trafficControl&&(this.trafficControl=DG.control.traffic(this.options.trafficControl),this.addControl(this.trafficControl))}),DG.Control.Traffic.Dictionary.ru={button_title:"Пробки"},DG.Control.Traffic.Dictionary.it={button_title:"Colonna"},DG.Control.Traffic.Dictionary.cs={button_title:"Zácpy"},DG.Control.Traffic.Dictionary.es={button_title:"Taco"},DG.Control.Traffic.Dictionary.en={button_title:"Traffic"},DG.Ruler=DG.Layer.extend({options:{editable:!0},includes:[DG.Locale],statics:{Dictionary:{}},initialize:function(t,e){DG.Util.setOptions(this,e),this._layers={back:null,middle:null,front:null,mouse:null},this._points=[],this._layersContainer=DG.featureGroup(),Object.keys(this._layers).forEach(function(t){this._layersContainer.addLayer(this._layers[t]=DG.featureGroup())},this),this._reset(),DG.Browser.mobile?(delete this._lineMouseEvents.mouseover,delete this._lineMouseEvents.mouseout,delete this._lineMouseEvents.mousemove):delete this._lineMouseEvents.click,t&&t.length&&this.setLatLngs(t)},onAdd:function(t){this._map=t.on("langchange",this._updateDistance,this),this._map.getPane("rulerLabelPane")||this._map.createPane("rulerLabelPane"),this._map.getPane("rulerEventPane")||this._map.createPane("rulerEventPane"),this._layersContainer.addTo(this._map),this._points.length&&(this._layers.mouse.fire("layeradd"),this._updateDistance()),this._layers.mouse.on(this._lineMouseEvents,this)},onRemove:function(t){t.off("langchange",this._updateDistance,this).removeLayer(this._layersContainer),this._layers.mouse.off(this._lineMouseEvents,this),this._reset()},getTotalDistance:function(){return this._calcDistance()},spliceLatLngs:function(t){var e=this._points.length,i=t>=0?Math.min(t,e):e-t,n=Array.prototype.splice.apply(this._points,arguments).map(function(t){return this._layers.mouse.removeLayer(t),t.off().getLatLng()},this),o=this._points.length;if(o){for(var r=i;o>r;r++)this._points[r]instanceof DG.Ruler.LayeredMarker||(this._points[r]=this._createPoint(this._points[r],this.options.iconStyles.large).on(this._pointEvents,this).once("add",this._addCloseHandler,this).addTo(this._layers.mouse,this._layers)),r&&!this._points[r-1]._legs&&this._addLegs(this._points[r-1]),this._points[r].setPointStyle(this.options.iconStyles[r&&o-1>r?"small":"large"]),this._points[r]._pos=r;this._removeLegs(this._points[o-1]),e>0&&o>e&&this._points[e-1].collapse(),this._points[i]&&this._updateLegs(this._points[i]),i>1&&this._points[i-1].setPointStyle(this.options.iconStyles.small),this._updateDistance(),this._normalizeRulerPoints()}return DG.Browser.touch&&this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),this._fireChangeEvent(),n},addLatLng:function(t){var e=this._points[this._points.length-1]||null;return t=DG.latLng(t),e&&(t=this._normalizeLatLng(t,e.getLatLng())),this.spliceLatLngs(this._points.length,0,t),this},getLatLngs:function(){return this._points.map(function(t){return t.getLatLng()})},setLatLngs:function(t){var e=t.slice();return e.unshift(0,this._points.length),this.spliceLatLngs.apply(this,e),this},_reset:function(){DG.extend(this,{_lineMarkerHelper:null,_morphingNow:!1})},_lineMouseEvents:{click:function(t){var e=t.layer;if(e instanceof DG.Marker&&e._pos!==this._points.length-1)this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),e.setText(this._getFormatedDistance(e)),this._lineMarkerHelper=e;else if(e instanceof DG.Path&&this.options.editable){var i=t.latlng,n=e._point._pos+1;this.spliceLatLngs(n,0,i)}},mouseover:function(t){var e=t.layer;if(e._hovered=!0,!this._morphingNow)if(e instanceof DG.Marker&&e._pos!==this._points.length-1)e.setText(this._getFormatedDistance(e));else if(e instanceof DG.Path&&!this._lineMarkerHelper){var i=e._point;this._lineMarkerHelper=this._addRunningLabel(this._nearestPoint(i._legs.middle,t.latlng),i)}},mouseout:function(t){var e=t.layer,i=t.originalEvent;e._hovered=!1,this._morphingNow||e._pos===this._points.length-1||(e instanceof DG.Marker?(!i.relatedTarget||i.relatedTarget!==e.querySelector("container")&&i.relatedTarget.parentNode!==e.querySelector("container"))&&e.collapse():this._removeRunningLabel())},mousemove:function(t){if(!this._morphingNow&&this._lineMarkerHelper){var e=t.layer._point,i=this._nearestPoint(e._legs.middle,t.latlng);this._lineMarkerHelper.setLatLng(i).setText(this._getFormatedDistance(e,e.getLatLng().distanceTo(i)))}},layeradd:function(){Object.keys(this._layers).forEach(function(t){this._layers[t].bringToFront()},this)}},_fireChangeEvent:function(){this.fire("changed",{latlngs:this.getLatLngs()})},_addRunningLabel:function(t,e){var i=this._createPoint(t).addTo(this._layers.mouse,this._layers);return this._map.getPane("rulerLabelPane").appendChild(i._icon),i.setText(this._getFormatedDistance(e,e.getLatLng().distanceTo(t)))},_removeRunningLabel:function(){this._lineMarkerHelper&&(this._layers.mouse.removeLayer(this._lineMarkerHelper),this._lineMarkerHelper=null)},_insertPointInLine:function(t){var e,i=this._lineMarkerHelper.getLatLng(),n=t.target._point._pos+1;if(L.Browser.ie){var o=t.originalEvent.target||t.originalEvent.srcElement,r=o.parentNode;r.appendChild(o)}L.DomEvent.stopPropagation(t.originalEvent),this.spliceLatLngs(n,0,i),e=this._points[n],e.setText(this._getFormatedDistance(e)),setTimeout(function(){if(document.createEvent){var t=document.createEvent("MouseEvents");t.initMouseEvent("mouseup",!1,!1,document.defaultView,1,0,0,0,0,!1,!1,!1,!1,1,e._icon),document.dispatchEvent(t),t=document.createEvent("MouseEvents"),t.initMouseEvent("mousedown",!1,!1,document.defaultView,1,0,0,0,0,!1,!1,!1,!1,1,e._icon),e._icon.dispatchEvent(t)}else e._icon.fireEvent("onMouseUp",DG.extend(document.createEventObject(),{button:1,bubbles:!1,cancelable:!1})),e._icon.fireEvent("onMouseDown",DG.extend(document.createEventObject(),{button:1,bubbles:!1,cancelable:!1}))},0),this._removeRunningLabel(),this._updateLegs(e)},_nearestPoint:function(t,e){for(var i,n,o=this,r=this._project(e),s=t.getLatLngs().map(function(t){return o._project(t)}),a=0;a<s.length-1;a++){var l=DG.LineUtil.pointToSegmentDistance(r,s[a],s[a+1]);(i===undefined||i>l)&&(i=l,n=a)}var u=DG.LineUtil.closestPointOnSegment(r,s[n],s[n+1]);return this._unproject(u)},_addCloseHandler:function(t){t.target.on("click",this._deletePoint,this).querySelector("remove-link").style.display="inline-block"},_createPoint:function(t,e){var i=e?e:this.options.iconStyles.large,n={};return Object.keys(i).forEach(function(e){n[e]=DG.circleMarker(t,i[e])}),DG.Ruler.layeredMarker(t,{layers:n,draggable:this.options.editable})},_normalizeLatLng:function(t,e){for(var i=t.lng<e.lng?360:-360,n=t.lng;Math.abs(n-e.lng)>180;)n+=i;return DG.latLng(t.lat,n)},_normalizeRulerPoints:function(t){t=t||this._points[0];var e,i,n,o,r,s=this,a=t._pos,l=[];for(e=a+1;e<this._points.length;e++)i=this._points[e],n=this._points[e-1],o=i.getLatLng(),r=this._normalizeLatLng(o,n.getLatLng()),r.equals(o)||(i.setLatLng(r),l.push(e));for(e=a-1;e>=0;e--)i=this._points[e],n=this._points[e+1],o=i.getLatLng(),r=this._normalizeLatLng(o,n.getLatLng()),r.equals(o)||(i.setLatLng(r),l.push(e));l.sort().reduce(function(t,e){var i=t&&t===e-1;return s._updateLegs(s._points[e],i),e},null)},_pointEvents:{drag:function(t){var e=t.target;this._normalizeRulerPoints(e),DG.Browser.touch||e===this._points[this._points.length-1]||e.setText(this._getFormatedDistance(e)),this._updateLegs(e),this._updateDistance()},dragend:function(t){var e=t.target;this._morphingNow=!1,e._hovered||e===this._points[this._points.length-1]||e.collapse(),this._fireChangeEvent()},dragstart:function(){DG.Browser.touch&&this._lineMarkerHelper&&this._lineMarkerHelper.collapse(),this._morphingNow=!0}},_deletePoint:function(t){var e=t.originalEvent,i=e.target||e.srcElement;"dg-ruler__label-remove-link"!==i.className&&"dg-ruler__remove-link-overlay"!==i.className||(DG.DomEvent.stop(t.originalEvent),this.spliceLatLngs(t.target._pos,1))},_degToRad:function(t){return Math.PI/180*t},_radToDeg:function(t){return 180/Math.PI*t},_project:function(t){return this._map?this._map.project(t):DG.CRS.EPSG3857.latLngToPoint(t,1)},_unproject:function(t){return this._map?this._map.unproject(t):DG.CRS.EPSG3857.pointToLatLng(t,1)},_calcAngle:function(t,e,i){e=this._normalizeLatLng(e,t),i=this._normalizeLatLng(i,t),t=this._project(t),e=this._project(e),i=this._project(i);var n=e.x-t.x,o=i.x-t.x,r=e.y-t.y,s=i.y-t.y,a=n*o+r*s,l=Math.sqrt(n*n+r*r),u=Math.sqrt(o*o+s*s);return Math.acos(a/(l*u))},_calcMidPoint:function(t,e){var i=this._degToRad(t.lng),n=this._degToRad(t.lat),o=this._degToRad(e.lng),r=this._degToRad(e.lat),s=Math.acos(Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos(i-o)),a=.5,l=Math.sin((1-a)*s)/Math.sin(s),u=Math.sin(a*s)/Math.sin(s),c=l*Math.cos(n)*Math.cos(i)+u*Math.cos(r)*Math.cos(o),h=l*Math.cos(n)*Math.sin(i)+u*Math.cos(r)*Math.sin(o),d=l*Math.sin(n)+u*Math.sin(r),p=Math.atan2(d,Math.sqrt(c*c+h*h)),_=Math.atan2(h,c);return DG.latLng(this._radToDeg(p),this._radToDeg(_))},_adaptiveSample:function(t,e,i,n){if(i>9)return[];n=n||this._calcMidPoint(t,e);var o=this._calcMidPoint(t,n),r=this._calcMidPoint(n,e),s=this._calcAngle(o,n,t),a=this._calcAngle(n,t,e),l=this._calcAngle(r,n,e),u=3.1;if(s>u&&a>u&&l>u)return[];var c=[];return c=c.concat(this._adaptiveSample(t,n,i+1,o)),c.push(n),c=c.concat(this._adaptiveSample(n,e,i+1,r))},_calcGreatCircle:function(t,e){if(e=this._normalizeLatLng(e,t),t.equals(e,1))return[t,e];if(180==Math.abs(e.lng-t.lng)){var i=t.lat+e.lat>0?90:-90;return[t,DG.latLng(i,t.lng),DG.latLng(i,e.lng),e]}var n=[];n.push(t),n=n.concat(this._adaptiveSample(t,e,0)),n.push(e);for(var o=1;o<n.length;o++)n[o]=this._normalizeLatLng(n[o],n[o-1]);return n},_addLegs:function(t){var e=this.options.pathStyles,i=this._calcGreatCircle(t.getLatLng(),this._points[t._pos+1].getLatLng());t._legs={},Object.keys(e).forEach(function(n){t._legs[n]=DG.polyline(i,e[n]).addTo(this._layers[n])},this),t._legs.mouse._point=t.once("remove",this._clearRemovingPointLegs,this),this.options.editable&&!DG.Browser.mobile&&t._legs.mouse.on("mousedown",this._insertPointInLine,this),this._map&&this._layers.mouse.addLayer(t._legs.mouse)},_clearRemovingPointLegs:function(t){this._removeLegs(t.target)},_removeLegs:function(t){t._legs&&(Object.keys(t._legs).forEach(function(e){this._layers[e].removeLayer(t._legs[e])},this),t._legs=null)},_updateLegs:function(t,e){var i,n=t.getLatLng(),o=this._points[t._pos-1],r=this._points[t._pos+1],s=this;o&&!e&&(i=s._calcGreatCircle(o.getLatLng(),n),Object.keys(o._legs).forEach(function(t){o._legs[t].setLatLngs(i)})),r&&(i=s._calcGreatCircle(n,r.getLatLng()),Object.keys(t._legs).forEach(function(e){t._legs[e].setLatLngs(i)}))},_calcDistance:function(t,e){for(var i=e?e:0,n=t?t._pos:this._points.length-1,o=0;n>o;o++)i+=this._points[o].getLatLng().distanceTo(this._points[o+1].getLatLng());return i},_getFormatedDistance:function(){var t=this._calcDistance.apply(this,arguments),e="m";return t>1e3?(t/=1e3,e="km",t>1e3?(t=t.toFixed(),t=t.slice(0,-3)+" "+t.slice(-3)):t=t.toFixed(2).split(".").join(this.t("delimiter"))):t=Math.round(t),[t||0," ",this.t(e)].join("")},_updateDistance:function(){this._map&&this._points.length&&this._points[this._points.length-1].setText(this._getFormatedDistance())}}),DG.ruler=function(t,e){return new DG.Ruler(t,e)},DG.Ruler.LayeredMarker=DG.Marker.extend({options:{draggable:!1,keyboard:!1,riseOnHover:!0,iconHTML:['<img class="dg-ruler__label-spacer" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="26" height="26" />','<div class="dg-ruler__label-container">','    <div class="dg-ruler__point"></div>','    <span class="dg-ruler__label-distance">0 км</span>','    <span class="dg-ruler__label-remove-link"></span>','    <div class="dg-ruler__remove-link-overlay"></div>',"</div>"].join("\n")},statics:{domClass:"dg-ruler__label"},addTo:function(t,e){return Object.keys(this._layers).forEach(function(t){e[t].addLayer(this._layers[t])},this),this._viewport=e,DG.Marker.prototype.addTo.call(this.on("move",this._onMove),t)},onRemove:function(t){return Object.keys(this._layers).forEach(function(t){this._viewport[t].removeLayer(this._layers[t])},this),this.off("move",this._onMove),this._viewport=null,this._style=null,DG.Marker.prototype.onRemove.call(this,t)},setText:function(t){return this._iconCollapsed&&this.expand(),this._iconNodes.label.innerHTML=t,this},setPointStyle:function(t){return this._style!==t&&Object.keys(this._style=t).forEach(function(e){this._layers[e].setStyle(t[e])},this),this},expand:function(){return this._iconCollapsed=!1,this._iconNodes.container.style.display="block",this._iconNodes.spacer.style.display="none",this},collapse:function(){return this._iconCollapsed=!0,this._iconNodes.container.style.display="none",this._iconNodes.spacer.style.display="block",this},querySelector:function(t){return this._icon.querySelector("."+DG.Ruler.LayeredMarker.domClass+"-"+t)},_onMove:function(t){var e=t.latlng;
Object.keys(this._layers).forEach(function(t){this._layers[t].setLatLng(e)},this)},_initIcon:function(){DG.Marker.prototype._initIcon.call(this),this._iconCollapsed=!0,this._icon.style.width="",this._iconNodes={label:this.querySelector("distance"),spacer:this.querySelector("spacer"),container:this.querySelector("container")}},_setPos:function(t){L.DomUtil.setPosition(this._icon,t),this._shadow&&L.DomUtil.setPosition(this._shadow,t)},_afterInit:function(){this._layers=this.options.layers||null,this.options.icon=DG.divIcon({className:DG.Ruler.LayeredMarker.domClass,iconSize:[26,26],iconAnchor:[13,13],html:this.options.iconHTML})}}),DG.Ruler.LayeredMarker.addInitHook("_afterInit"),DG.Ruler.layeredMarker=function(t,e){return new DG.Ruler.LayeredMarker(t,e)};var rulerRenderer=DG.svg({pane:"rulerLabelPane"});DG.Ruler.mergeOptions({pathStyles:{back:{color:"#fff",opacity:1,weight:12,pointerEvents:"none",noClip:!0,renderer:rulerRenderer,smoothFactor:0},middle:{color:"#0da5d5",opacity:1,weight:4,pointerEvents:"none",noClip:!0,renderer:rulerRenderer,smoothFactor:0},mouse:{color:"#fff",opacity:DG.Browser.vml?.1:0,weight:DG.Browser.touch?40:20,pointerEvents:"painted",noClip:!0,renderer:DG.svg({pane:"rulerEventPane"}),smoothFactor:0}},iconStyles:{large:{back:{color:"#fff",opacity:1,fillColor:"#fff",fillOpacity:1,weight:1,radius:13,renderer:rulerRenderer},middle:{color:"#0da5d5",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:1,radius:9,renderer:rulerRenderer},front:{color:"#fff",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:4,radius:5,renderer:rulerRenderer}},small:{back:{color:"#fff",opacity:1,fillColor:"#fff",fillOpacity:1,weight:1,radius:9,renderer:rulerRenderer},middle:{color:"#0da5d5",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:1,radius:5,renderer:rulerRenderer},front:{color:"#fff",opacity:1,fillColor:"#0da5d5",fillOpacity:1,weight:4,radius:2,renderer:rulerRenderer}}}}),DG.Ruler.Dictionary.ru={km:"км",m:"м",delimiter:","},DG.Ruler.Dictionary.it={km:"km",m:"m",delimiter:","},DG.Ruler.Dictionary.cs={km:"km",m:"m",delimiter:","},DG.Ruler.Dictionary.es={km:"km",m:"m",delimiter:","},DG.Ruler.Dictionary.en={km:"km",m:"m",delimiter:"."},DG.Control.Ruler=DG.RoundControl.extend({options:{position:"topright",iconClass:"ruler"},statics:{Dictionary:{}},initialize:function(t){DG.setOptions(this,t),DG.extend(this,{_active:!1,_drawingHelper:null,_geoclickerNeedRestore:!1}).on(this._controlEvents,this)},_controlEvents:{add:function(){this._drawingHelper=DG.ruler([])},click:function(){this._active=!this._active,this._active?(this.setState("active"),this._startDrawing()):(this.setState(""),this._finishDrawing())},remove:function(){this.off(this._controlEvents,this),this._active&&(this._map.removeLayer(this._drawingHelper),this._active=!1),this._drawingHelper=null}},_startDrawing:function(){this._map.addLayer(this._drawingHelper).on("click",this._handleMapClick,this),this._map.fire("rulerstart")},_finishDrawing:function(){this._map.off("click",this._handleMapClick,this).removeLayer(this._drawingHelper),this._drawingHelper.setLatLngs([]),this._map.fire("rulerend")},_handleMapClick:function(t){this._drawingHelper.addLatLng(t.latlng)},_renderTranslation:function(){this._link.title=this.t("button_title")}}),DG.control.ruler=function(t){return new DG.Control.Ruler(t)},DG.Map.mergeOptions({rulerControl:!1}),DG.Map.addInitHook(function(){this.options.rulerControl&&(this.rulerControl=DG.control.ruler(this.options.rulerControl),this.addControl(this.rulerControl))}),DG.Control.Ruler.Dictionary.ru={button_title:"Линейка"},DG.Control.Ruler.Dictionary.it={button_title:"Righello"},DG.Control.Ruler.Dictionary.cs={button_title:"Pravítko"},DG.Control.Ruler.Dictionary.es={button_title:"Regla"},DG.Control.Ruler.Dictionary.en={button_title:"Ruler"},function(t){function e(t,e){return t.w('<div class="dg-attribution__copyright"><ul class="dg-attribution__links"><li class="dg-attribution__link-item">').x(e.get(["osm"],!1),e,{block:i},{}).w('<a href="').f(e.get(["copyright_apilink"],!1),e,"h").w('" target="_blank" class="dg-attribution__link">').nx(e.get(["osm"],!1),e,{block:n},{}).f(e.get(["API_2GIS"],!1),e,"h").w('</a></li><li class="dg-attribution__link-item"><a href="').f(e.get(["copyright_license"],!1),e,"h").w('" target="_blank" class="dg-attribution__link">').f(e.get(["license_agreement"],!1),e,"h").w('</a></li></ul><a href="').f(e.get(["copyright_logo"],!1),e,"h").w('" target="_blank" class="dg-attribution__logo-url"></a></div>')}function i(t,e){return t.w('© <a href="http://www.openstreetmap.org/copyright" target="_blank" class="dg-attribution__link">OpenStreetMap contributors</a>, ')}function n(t,e){return t.f(e.get(["work_on"],!1),e,"h").w(" ")}return t.register("DGAttribution/copyright",e),e.__dustBody=!0,i.__dustBody=!0,n.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.w('<div class="dg-map-geoclicker__purpose dg-map-geoclicker__purpose_type_').f(e.get(["type"],!1),e,"h").w('">').f(e.get(["purpose"],!1),e,"h").w("</div>").s(e.get(["drilldown"],!1),e,{block:i},{})}function i(t,e){return t.w('<div class="dg-map-geoclicker__drilldown">').f(e.get(["drilldown"],!1),e,"h").w("</div>")}return t.register("DGGeoclicker/cityarea",e),e.__dustBody=!0,i.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.w('<address class="dg-firm-card__address dg-firm-card__icon">').f(e.get(["address"],!1),e,"h").s(e.get(["comment"],!1),e,{block:i},{}).w("</address>")}function i(t,e){return t.w('<span class="dg-firm-card__comment">&mdash; ').f(e.getPath(!0,[]),e,"h").w("</span>")}return t.register("DGGeoclicker/firmCardAddr",e),e.__dustBody=!0,i.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.s(e.get(["groups"],!1),e,{block:i},{})}function i(t,e){return t.s(e.get(["contacts"],!1),e,{block:n},{})}function n(t,e){return t.h("select",e,{block:o},{key:e.get(["type"],!1),type:"string"},"h")}function o(t,e){return t.h("eq",e,{block:r},{value:"phone",type:"string"},"h").h("eq",e,{block:a},{value:"fax",type:"string"},"h").h("eq",e,{block:u},{value:"website",type:"string"},"h").h("eq",e,{block:c},{value:"email",type:"string"},"h")}function r(t,e){return t.w('<div class="dg-firm-card__phone dg-firm-card__icon"><span class="dg-firm-card__phone-num">').f(e.get(["text"],!1),e,"h").s(e.get(["comment"],!1),e,{block:s},{}).w("</span></div>")}function s(t,e){return t.w('<span class="dg-firm-card__comment" title="').f(e.getPath(!0,[]),e,"h").w('">&mdash;&nbsp;&nbsp;').f(e.getPath(!0,[]),e,"h").w("</span>")}function a(t,e){return t.w('<div class="dg-firm-card__phone dg-firm-card__icon"><span class="dg-firm-card__phone-num">').f(e.get(["text"],!1),e,"h").s(e.get(["comment"],!1),e,{block:l},{}).w("</span></div>")}function l(t,e){return t.w('<span class="dg-firm-card__comment" title="').f(e.getPath(!0,[]),e,"h").w('">&mdash;&nbsp;&nbsp;').f(e.getPath(!0,[]),e,"h").w("</span>")}function u(t,e){return t.w('<div class="dg-firm-card__link dg-firm-card__site dg-firm-card__icon"><a href="').f(e.get(["url"],!1),e,"h").w('" target="_blank" class="dg-link_scheme_dark dg-firm-card__sitelink">').f(e.get(["text"],!1),e,"h").w("</a></div>")}function c(t,e){return t.w('<div class="dg-firm-card__link dg-firm-card__email dg-firm-card__icon"><a href="mailto:').f(e.get(["value"],!1),e,"h").w('">').f(e.get(["value"],!1),e,"h").w("</a></div>")}return t.register("DGGeoclicker/firmCardContacts",e),e.__dustBody=!0,i.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,a.__dustBody=!0,l.__dustBody=!0,u.__dustBody=!0,c.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.w('<div class="dg-popup__header-title dg-popup__header-title_for_firmcard" title="').f(e.get(["firmName"],!1),e,"h").w('">').f(e.get(["firmName"],!1),e,"h").w("</div>").x(e.get(["links"],!1),e,{block:i},{})}function i(t,e){return t.w('<div class="dg-popup__header-links">').s(e.get(["links"],!1),e,{block:n},{}).w("</div>")}function n(t,e){return t.h("eq",e,{"else":o,block:a},{key:l,value:"flamp_stars",type:"string"},"h")}function o(t,e){return t.w('<a class="dg-popup__header-link dg-popup__link dg-popup__link_type_').f(e.get(["name"],!1),e,"h").w('"').x(e.get(["href"],!1),e,{"else":r,block:s},{}).w(">").f(e.get(["label"],!1),e,"h").w("</a>")}function r(t,e){return t.w('href="javascript:void(0)"')}function s(t,e){return t.w("href=").f(e.get(["href"],!1),e,"h").w(' target="_blank"')}function a(t,e){return t.w('<div class="dg-popup__rating"><div class="dg-popup__rating-stars" style="width: ').f(e.get(["width"],!1),e,"h").w('%"></div></div>')}function l(t,e){return t.f(e.get(["name"],!1),e,"h")}return t.register("DGGeoclicker/firmCardHeader",e),e.__dustBody=!0,i.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,a.__dustBody=!0,l.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.s(e.get(["rubrics"],!1),e,{block:i},{})}function i(t,e){return t.w('<section class="dg-firm-card__rubrics">').x(e.get(["primary"],!1),e,{block:n},{}).x(e.get(["additional"],!1),e,{block:r},{}).w("</section>")}function n(t,e){return t.w('<ul class="dg-firm-card__rubrics-list dg-firm-card__rubrics-list_type_primary">').s(e.get(["primary"],!1),e,{block:o},{}).w("</ul>")}function o(t,e){return t.w('<li class="dg-firm-card__rubrics-list-item">').f(e.get(["name"],!1),e,"h").w("</li>")}function r(t,e){return t.w('<ul class="dg-firm-card__rubrics-list dg-firm-card__rubrics-list_type_additional">').s(e.get(["additional"],!1),e,{block:s},{}).w("</ul>")}function s(t,e){return t.w('<li class="dg-firm-card__rubrics-list-item">').f(e.get(["name"],!1),e,"h").w("</li>")}return t.register("DGGeoclicker/firmCardRubric",e),e.__dustBody=!0,i.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.w('<div class="dg-firm-card__schedule dg-schedule dg-schedule_open_').x(e.getPath(!1,["forecast","open"]),e,{"else":i,block:n},{}).w(" dg-schedule_works-everyday_").x(e.getPath(!1,["schedule","everyday"]),e,{"else":o,block:r},{}).w('">').x(e.get(["schedule"],!1),e,{block:s},{}).w("</div>")}function i(t,e){return t.w("false")}function n(t,e){return t.w("true")}function o(t,e){return t.w("false")}function r(t,e){return t.w("true")}function s(t,e){return t.x(e.getPath(!1,["forecast","today"]),e,{block:a},{}).s(e.getPath(!1,["forecast","now"]),e,{block:h},{}).nx(e.getPath(!1,["schedule","everyday"]),e,{block:p},{})}function a(t,e){return t.w('<div class="dg-schedule__today"><div class="dg-schedule__today-inner">').f(e.getPath(!1,["forecast","today","text"]),e,"h").w("&nbsp;").x(e.getPath(!1,["forecast","today","from"]),e,{block:l},{}).x(e.getPath(!1,["schedule","lunch"]),e,{block:u},{}).w("</div></div>")}function l(t,e){return t.f(e.getPath(!1,["forecast","today","from"]),e,"h").w("&ndash;").f(e.getPath(!1,["forecast","today","to"]),e,"h")}function u(t,e){return t.w(",&nbsp;").f(e.getPath(!1,["forecast","today","lunchStr"]),e,"h").w("&nbsp;").s(e.getPath(!1,["schedule","lunch"]),e,{block:c},{})}function c(t,e){return t.f(e.get(["from"],!1),e,"h").w("&ndash;").f(e.get(["to"],!1),e,"h")}function h(t,e){return t.w('<div class="dg-schedule__now"><span class="dg-schedule__now-text">').f(e.getPath(!0,[]),e,"h").s(e.getPath(!1,["schedule","comment"]),e,{block:d},{}).w("</span></div>")}function d(t,e){return t.w(", ").f(e.getPath(!0,[]),e,"h")}function p(t,e){return t.x(e.getPath(!1,["schedule","week"]),e,{block:_},{})}function _(t,e){return t.x(e.getPath(!1,["schedule","week","evently"]),e,{block:m},{}).x(e.getPath(!1,["schedule","week","table"]),e,{block:D},{})}function m(t,e){return t.w('<div class="dg-schedule__table">').s(e.getPath(!1,["schedule","week","evently"]),e,{block:f},{}).w("</div>")}function f(t,e){return t.w('<div class="dg-schedule__string">').x(e.get(["alltime"],!1),e,{block:g},{}).x(e.get(["everyday"],!1),e,{"else":v,block:y},{}).x(e.get(["holiday"],!1),e,{"else":L,block:w},{}).w("</div>")}function g(t,e){return t.f(e.get(["alltimeStr"],!1),e,"h")}function v(t,e){return t.f(e.get(["dayList"],!1),e,"h")}function y(t,e){return t.f(e.getPath(!1,["forecast","today","text"]),e,"h")}function L(t,e){return t.w('<span class="schedule__string-time">&nbsp;').f(e.get(["from"],!1),e,"h").w("&ndash;").f(e.get(["to"],!1),e,"h").w("</span>").s(e.get(["lunch"],!1),e,{block:b},{})}function b(t,e){return t.w("<p>").f(e.get(["lunchStr"],!1),e,"h").w('&mdash;<span class="schedule__string-time">').f(e.get(["from"],!1),e,"h").w("&ndash;").f(e.get(["to"],!1),e,"h").w("</span></p>")}function w(t,e){return t.w('&nbsp;&mdash;<span class="schedule__string-time">&nbsp;').f(e.get(["holidayStr"],!1),e,"h").w("</span>")}function D(t,e){return t.w('<div><div class="dg-schedule__table"><div class="dg-schedule__tc dg-schedule__tc_pre"><div class="dg-schedule__day-name">&nbsp;</div><div class="dg-schedule__table-clock dg-schedule__td"></div>').x(e.getPath(!1,["schedule","week","hasLunch"]),e,{block:k},{}).w("</div>").s(e.getPath(!1,["schedule","week","table"]),e,{block:P},{}).w("</div>  </div>")}function k(t,e){return t.w('<div class="dg-schedule__table-lunch dg-schedule__td"></div>')}function P(t,e){return t.h("if",e,{block:x},{cond:C},"h").w('<div class="dg-schedule__tc').x(e.get(["active"],!1),e,{block:E},{}).w('"><div class="dg-schedule__day-name">').f(e.get(["key"],!1),e,"h").w('</div><div class="dg-schedule__td">').x(e.get(["from"],!1),e,{"else":G,block:O},{}).w("</div>").s(e.get(["lunch"],!1),e,{block:T},{}).w("</div> ").h("if",e,{block:z},{cond:A},"h")}function x(t,e){return t.w('<span class="dg-schedule__table-cell-group">')}function C(t,e){return t.w("(").f(e.get(["$idx"],!1),e,"h").w(" == ").f(e.get(["$len"],!1),e,"h").w(" - 2)")}function E(t,e){return t.w(" dg-schedule__tc_active_true")}function G(t,e){return t.w("&ndash;")}function O(t,e){return t.f(e.get(["from"],!1),e,"h").w(" ").f(e.get(["to"],!1),e,"h")}function T(t,e){return t.w('<div class="dg-schedule__td">').x(e.get(["from"],!1),e,{"else":S,block:M},{}).w("</div>")}function S(t,e){return t.w("&ndash;")}function M(t,e){return t.f(e.get(["from"],!1),e,"h").w(" ").f(e.get(["to"],!1),e,"h")}function z(t,e){return t.w("</span>")}function A(t,e){return t.w("(").f(e.get(["$idx"],!1),e,"h").w(" == ").f(e.get(["$len"],!1),e,"h").w(")")}return t.register("DGGeoclicker/firmCardSchedule",e),e.__dustBody=!0,i.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,a.__dustBody=!0,l.__dustBody=!0,u.__dustBody=!0,c.__dustBody=!0,h.__dustBody=!0,d.__dustBody=!0,p.__dustBody=!0,_.__dustBody=!0,m.__dustBody=!0,f.__dustBody=!0,g.__dustBody=!0,v.__dustBody=!0,y.__dustBody=!0,L.__dustBody=!0,b.__dustBody=!0,w.__dustBody=!0,D.__dustBody=!0,k.__dustBody=!0,P.__dustBody=!0,x.__dustBody=!0,C.__dustBody=!0,E.__dustBody=!0,G.__dustBody=!0,O.__dustBody=!0,T.__dustBody=!0,S.__dustBody=!0,M.__dustBody=!0,z.__dustBody=!0,A.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.w('<a id="').f(e.getPath(!1,["firm","id"]),e,"h").w('" class="dg-popup__link" href="#">').f(e.getPath(!1,["firm","name"]),e,"h").w("</a>")}return t.register("DGGeoclicker/firmlistItem",e),e.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.x(e.get(["payments"],!1),e,{block:i},{})}function i(t,e){return t.w('<section class="dg-firm-card__aa"><ul class="dg-firm-card__aa-list">').s(e.get(["payments"],!1),e,{block:n},{}).w("</ul></section>")}function n(t,e){return t.w('<li class="dg-firm-card__aa-list-item">').f(e.getPath(!0,[]),e,"h").w("</li>")}return t.register("DGGeoclicker/frimCardPayments",e),e.__dustBody=!0,i.__dustBody=!0,n.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.s(e.get(["address"],!1),e,{block:i},{}).s(e.get(["purpose"],!1),e,{block:r},{}).s(e.get(["attractions"],!1),e,{block:s},{})}function i(t,e){return t.w('<address class="dg-map-geoclicker__address">').s(e.getPath(!1,["address","header"]),e,{block:n},{}).s(e.getPath(!1,["address","drilldown"]),e,{block:o},{}).w("</address>")}function n(t,e){return t.w('<div class="dg-map-geoclicker__address-header">').f(e.getPath(!0,[]),e,"h").w("</div>")}function o(t,e){return t.w('<div class="dg-map-geoclicker__address-drilldown">').f(e.getPath(!0,[]),e,"h").w("</div>")}function r(t,e){return t.w('<div class="dg-map-geoclicker__purpose">').f(e.getPath(!0,[]),e,"h").w("</div>")}function s(t,e){return t.w('<div class="dg-map-geoclicker__purpose dg-map-geoclicker__purpose_type_sight">').f(e.getPath(!0,[]),e,"h").w("</div>")}return t.register("DGGeoclicker/house",e),e.__dustBody=!0,i.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.w('<div class="dg-preloader dg-preloader_scheme_regular dg-preloader_animation_').x(e.get(["anim"],!1),e,{"else":i,block:n},{}).x(e.get(["small"],!1),e,{block:o},{}).w('"></div>')}function i(t,e){return t.w("false")}function n(t,e){return t.w("true")}function o(t,e){return t.w(" dg-preloader_size_small")}return t.register("DGGeoclicker/loader",e),e.__dustBody=!0,i.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.w('<div class="dg-popup__footer-title"><a class="dg-popup__show-less-house-link" href="javascript:void(0)">').f(e.get(["hideFirmsText"],!1),e,"h").w("</a></div>")}return t.register("DGGeoclicker/popupFooter",e),e.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.x(e.get(["btns"],!1),e,{block:i},{})}function i(t,e){return t.w('<footer class="dg-popup__footer-buttons">').s(e.get(["btns"],!1),e,{block:n},{}).w("</footer>")}function n(t,e){return t.w('<div class="dg-popup__footer-button-wrapper"><a class="dg-popup__button_name_').f(e.get(["name"],!1),e,"h").w(" dg-popup__footer-button").x(e.get(["icon"],!1),e,{block:o},{}).w('"').x(e.get(["href"],!1),e,{"else":r,block:s},{}).w(">").f(e.get(["label"],!1),e,"h").w("</a></div>")}function o(t,e){return t.w(" dg-popup__footer-icon-button")}function r(t,e){return t.w('href="javascript:void(0)"')}function s(t,e){return t.w("href=").f(e.get(["href"],!1),e,"h").w(' target="_blank"')}return t.register("DGGeoclicker/popupFooterBtns",e),e.__dustBody=!0,i.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.s(e.get(["title"],!1),e,{block:i},{})}function i(t,e){return t.w('<div class="dg-popup__header-title">').f(e.getPath(!0,[]),e,"h").w("</div>")}return t.register("DGGeoclicker/popupHeader",e),e.__dustBody=!0,i.__dustBody=!0,e}(dust),function(t){function e(t,e){return t.s(e.get(["purpose"],!1),e,{block:i},{}).s(e.get(["address"],!1),e,{block:n},{}).s(e.get(["description"],!1),e,{block:s},{})}function i(t,e){return t.w('<div class="dg-map-geoclicker__purpose dg-map-geoclicker__purpose_type_sight">').f(e.getPath(!0,[]),e,"h").w("</div>")}function n(t,e){return t.w('<address class="dg-map-geoclicker__address">').s(e.getPath(!1,["address","header"]),e,{block:o},{}).s(e.getPath(!1,["address","drilldown"]),e,{block:r},{}).w("</address>")}function o(t,e){return t.w('<div class="dg-map-geoclicker__address-header">').f(e.getPath(!0,[]),e,"h").w("</div>")}function r(t,e){return t.w('<div class="dg-map-geoclicker__address-drilldown">').f(e.getPath(!0,[]),e,"h").w("</div>")}function s(t,e){return t.w('<div class="dg-map-geoclicker__sight-description">').f(e.getPath(!0,[]),e,"h").w("</div>").s(e.get(["showMoreText"],!1),e,{block:a},{})}function a(t,e){return t.w('<a class="dg-map-geoclicker__show-more-sights-link" href="javascript:void(0)">').f(e.getPath(!0,[]),e,"h").w("</a>")}return t.register("DGGeoclicker/sight",e),e.__dustBody=!0,i.__dustBody=!0,n.__dustBody=!0,o.__dustBody=!0,r.__dustBody=!0,s.__dustBody=!0,a.__dustBody=!0,e}(dust),DG.fallbackProjectsList=JSON.parse('[{"name":"Dubai. Sharjah. Ajman","flags":{"public_transport":true,"metro":true,"road_network":true,"flamp":false},"domain":"ae","bounds":"POLYGON((54.86679 24.763287,55.680597 24.763287,55.680597 25.51707,54.86679 25.51707,54.86679 24.763287))","zoom_level":{"min":9,"max":18},"code":"dubai","country_code":"ae","id":"99","type":"region","time_zone":{"name":"Asia/Dubai","offset":240}},{"name":"Lefkosia","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"domain":"com.cy","bounds":"POLYGON((33.268751 35.031957,33.444017 35.031957,33.444017 35.198771,33.268751 35.198771,33.268751 35.031957))","zoom_level":{"min":11,"max":19},"code":"nicosia","country_code":"cy","id":"104","type":"region","time_zone":{"name":"Asia/Nicosia","offset":180}},{"name":"Lemesos","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"domain":"com.cy","bounds":"POLYGON((32.818314 34.543829,33.190735 34.543829,33.190735 34.770361,32.818314 34.770361,32.818314 34.543829))","zoom_level":{"min":11,"max":19},"code":"limassol","country_code":"cy","id":"93","type":"region","time_zone":{"name":"Asia/Nicosia","offset":180}},{"name":"Praha","flags":{"public_transport":true,"metro":true,"road_network":true,"flamp":false},"domain":"cz","bounds":"POLYGON((14.215528 49.934897,14.715245 49.934897,14.715245 50.181086,14.215528 50.181086,14.215528 49.934897))","zoom_level":{"min":10,"max":18},"code":"praha","country_code":"cz","id":"92","type":"region","time_zone":{"name":"Europe/Prague","offset":120}},{"name":"Santiago","flags":{"public_transport":true,"metro":true,"road_network":true,"flamp":false},"domain":"cl","bounds":"POLYGON((-70.857156 -33.665691,-70.477276 -33.665691,-70.477276 -33.293334,-70.857156 -33.293334,-70.857156 -33.665691))","zoom_level":{"min":9,"max":19},"code":"santiago","country_code":"cl","id":"101","type":"region","time_zone":{"name":"America/Santiago","offset":-180}},{"name":"Venezia e Padova","flags":{"public_transport":true,"metro":false,"road_network":false,"flamp":false},"domain":"it","bounds":"POLYGON((11.355023 45.071338,12.61199 45.071338,12.61199 45.733677,11.355023 45.733677,11.355023 45.071338))","zoom_level":{"min":9,"max":18},"code":"padova","country_code":"it","id":"66","type":"region","time_zone":{"name":"Europe/Rome","offset":120}},{"name":"Абакан","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((91.144335 53.569076,91.826689 53.569076,91.826689 53.901599,91.144335 53.901599,91.144335 53.569076))","zoom_level":{"min":9,"max":18},"code":"abakan","country_code":"ru","id":"69","type":"region","time_zone":{"name":"Asia/Krasnoyarsk","offset":420}},{"name":"Алматы","flags":{"metro":true,"public_transport":true,"flamp":false,"traffic":true,"road_network":true},"domain":"kz","bounds":"POLYGON((76.715991 43.108051,77.1084 43.108051,77.1084 43.469093,76.715991 43.469093,76.715991 43.108051))","zoom_level":{"min":9,"max":18},"code":"almaty","country_code":"kz","id":"67","type":"region","time_zone":{"name":"Asia/Qyzylorda","offset":360}},{"name":"Альметьевск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((52.20155 54.796869,52.478673 54.796869,52.478673 54.949956,52.20155 54.949956,52.20155 54.796869))","zoom_level":{"min":9,"max":18},"code":"almetevsk","country_code":"ru","id":"108","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Армавир","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((40.8594 44.721791,41.322578 44.721791,41.322578 45.249444,40.8594 45.249444,40.8594 44.721791))","zoom_level":{"min":9,"max":18},"code":"armawir","country_code":"ru","id":"106","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Архангельск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((39.458118 64.284305,41.321175 64.284305,41.321175 64.829966,39.458118 64.829966,39.458118 64.284305))","zoom_level":{"min":9,"max":18},"code":"arkhangelsk","country_code":"ru","id":"49","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Астана","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"domain":"kz","bounds":"POLYGON((71.168047 50.934375,71.882791 50.934375,71.882791 51.371885,71.168047 51.371885,71.168047 50.934375))","zoom_level":{"min":9,"max":18},"code":"astana","country_code":"kz","id":"68","type":"region","time_zone":{"name":"Asia/Qyzylorda","offset":360}},{"name":"Астрахань","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((47.863046 46.241258,48.185812 46.241258,48.185812 46.511418,47.863046 46.511418,47.863046 46.241258))","zoom_level":{"min":9,"max":18},"code":"astrakhan","country_code":"ru","id":"8","type":"region","time_zone":{"name":"Europe/Astrakhan","offset":240}},{"name":"Барнаул","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((83.445791 53.158598,84.087935 53.158598,84.087935 53.486716,83.445791 53.486716,83.445791 53.158598))","zoom_level":{"min":9,"max":18},"code":"barnaul","country_code":"ru","id":"4","type":"region","time_zone":{"name":"Asia/Barnaul","offset":420}},{"name":"Белгород","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((36.419278 50.489654,36.729779 50.489654,36.729779 50.701271,36.419278 50.701271,36.419278 50.489654))","zoom_level":{"min":9,"max":18},"code":"belgorod","country_code":"ru","id":"46","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Бийск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((84.568894 51.899905,85.492485 51.899905,85.492485 52.646705,84.568894 52.646705,84.568894 51.899905))","zoom_level":{"min":9,"max":18},"code":"biysk","country_code":"ru","id":"20","type":"region","time_zone":{"name":"Asia/Barnaul","offset":420}},{"name":"Бишкек","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"domain":"kg","bounds":"POLYGON((74.4117 42.785866,74.882811 42.785866,74.882811 43.081251,74.4117 43.081251,74.4117 42.785866))","zoom_level":{"min":9,"max":18},"code":"bishkek","country_code":"kg","id":"112","type":"region","time_zone":{"name":"Asia/Bishkek","offset":360}},{"name":"Благовещенск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((127.345035 50.223461,127.764413 50.223461,127.764413 50.601634,127.345035 50.601634,127.345035 50.223461))","zoom_level":{"min":9,"max":18},"code":"blagoveshensk","country_code":"ru","id":"52","type":"region","time_zone":{"name":"Asia/Yakutsk","offset":540}},{"name":"Братск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((101.059738 55.929923,102.059777 55.929923,102.059777 56.502619,101.059738 56.502619,101.059738 55.929923))","zoom_level":{"min":9,"max":18},"code":"bratsk","country_code":"ru","id":"51","type":"region","time_zone":{"name":"Asia/Irkutsk","offset":480}},{"name":"Брянск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((34.115433 53.138522,34.604425 53.138522,34.604425 53.431556,34.115433 53.431556,34.115433 53.138522))","zoom_level":{"min":9,"max":18},"code":"bryansk","country_code":"ru","id":"62","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Великий Новгород","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((31.131394 58.460419,31.514694 58.460419,31.514694 58.683631,31.131394 58.683631,31.131394 58.460419))","zoom_level":{"min":9,"max":18},"code":"v_novgorod","country_code":"ru","id":"77","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Владивосток","flags":{"metro":false,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((131.558591 42.803446,132.343685 42.803446,132.343685 43.61615,131.558591 43.61615,131.558591 42.803446))","zoom_level":{"min":9,"max":18},"code":"vladivostok","country_code":"ru","id":"25","type":"region","time_zone":{"name":"Asia/Vladivostok","offset":600}},{"name":"Владимир","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((40.165193 56.02824,40.695168 56.02824,40.695168 56.46782,40.165193 56.46782,40.165193 56.02824))","zoom_level":{"min":9,"max":18},"code":"vladimir","country_code":"ru","id":"59","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Волгоград","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((43.970587 48.314123,44.930866 48.314123,44.930866 48.92667,43.970587 48.92667,43.970587 48.314123))","zoom_level":{"min":9,"max":18},"code":"volgograd","country_code":"ru","id":"33","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Вологда","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((39.608303 59.150523,40.07794 59.150523,40.07794 59.337288,39.608303 59.337288,39.608303 59.150523))","zoom_level":{"min":9,"max":18},"code":"vologda","country_code":"ru","id":"78","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Воронеж","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((38.991159 51.475591,39.613084 51.475591,39.613084 51.910994,38.991159 51.910994,38.991159 51.475591))","zoom_level":{"min":9,"max":18},"code":"voronezh","country_code":"ru","id":"31","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Горно-Алтайск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((85.48461 51.249215,86.458369 51.249215,86.458369 52.15649,85.48461 52.15649,85.48461 51.249215))","zoom_level":{"min":9,"max":18},"code":"gornoaltaysk","country_code":"ru","id":"27","type":"region","time_zone":{"name":"Asia/Barnaul","offset":420}},{"name":"Днепропетровск","flags":{"metro":true,"has_net_booklet":true,"public_transport":true,"flamp":false,"traffic":true,"road_network":true},"domain":"ua","bounds":"POLYGON((34.737733 48.341385,35.296754 48.341385,35.296754 48.687967,34.737733 48.687967,34.737733 48.341385))","zoom_level":{"min":9,"max":18},"code":"dnepropetrovsk","country_code":"ua","id":"105","type":"region","time_zone":{"name":"Europe/Kiev","offset":180}},{"name":"Донецк","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"domain":"ua","bounds":"POLYGON((37.510512 47.795769,38.246188 47.795769,38.246188 48.189925,37.510512 48.189925,37.510512 47.795769))","zoom_level":{"min":9,"max":18},"code":"donetsk","country_code":"ua","id":"79","type":"region","time_zone":{"name":"Europe/Kiev","offset":180}},{"name":"Екатеринбург","flags":{"metro":true,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((59.714357 56.586369,60.943224 56.586369,60.943224 57.036097,59.714357 57.036097,59.714357 56.586369))","zoom_level":{"min":9,"max":18},"code":"ekaterinburg","country_code":"ru","id":"9","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Иваново","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((40.797585 56.891313,41.189405 56.891313,41.189405 57.089556,40.797585 57.089556,40.797585 56.891313))","zoom_level":{"min":9,"max":18},"code":"ivanovo","country_code":"ru","id":"65","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Ижевск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((52.931947 56.667543,53.495625 56.667543,53.495625 57.057889,52.931947 57.057889,52.931947 56.667543))","zoom_level":{"min":9,"max":18},"code":"izhevsk","country_code":"ru","id":"41","type":"region","time_zone":{"name":"Europe/Samara","offset":240}},{"name":"Иркутск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((103.618853 51.710443,104.970807 51.710443,104.970807 52.64955,103.618853 52.64955,103.618853 51.710443))","zoom_level":{"min":9,"max":18},"code":"irkutsk","country_code":"ru","id":"11","type":"region","time_zone":{"name":"Asia/Irkutsk","offset":480}},{"name":"Йошкар-Ола","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((47.572432 56.507529,48.153297 56.507529,48.153297 56.761482,47.572432 56.761482,47.572432 56.507529))","zoom_level":{"min":9,"max":18},"code":"yoshkarola","country_code":"ru","id":"70","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Казань","flags":{"metro":true,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((48.29118 55.566624,49.535477 55.566624,49.535477 55.998533,48.29118 55.998533,48.29118 55.566624))","zoom_level":{"min":9,"max":18},"code":"kazan","country_code":"ru","id":"21","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Калининград","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((19.839082 54.534137,20.663516 54.534137,20.663516 55.055519,19.839082 55.055519,19.839082 54.534137))","zoom_level":{"min":9,"max":18},"code":"kaliningrad","country_code":"ru","id":"40","type":"region","time_zone":{"name":"Europe/Kaliningrad","offset":120}},{"name":"Калуга","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((35.894812 54.321024,36.482233 54.321024,36.482233 54.768523,35.894812 54.768523,35.894812 54.321024))","zoom_level":{"min":9,"max":18},"code":"kaluga","country_code":"ru","id":"61","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Каменск-Уральский","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((61.715751 56.275445,62.260467 56.275445,62.260467 56.57552,61.715751 56.57552,61.715751 56.275445))","zoom_level":{"min":9,"max":18},"code":"k_uralskiy","country_code":"ru","id":"109","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Караганда","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"domain":"kz","bounds":"POLYGON((72.860052 49.64993,73.41063 49.64993,73.41063 50.132623,72.860052 50.132623,72.860052 49.64993))","zoom_level":{"min":9,"max":18},"code":"karaganda","country_code":"kz","id":"84","type":"region","time_zone":{"name":"Asia/Qyzylorda","offset":360}},{"name":"Кемерово","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((85.906046 55.209146,86.327501 55.209146,86.327501 55.534428,85.906046 55.534428,85.906046 55.209146))","zoom_level":{"min":9,"max":18},"code":"kemerovo","country_code":"ru","id":"5","type":"region","time_zone":{"name":"Asia/Krasnoyarsk","offset":420}},{"name":"Киев","flags":{"public_transport":true,"metro":true,"road_network":true,"flamp":false},"domain":"ua","bounds":"POLYGON((30.210468 50.190165,31.039178 50.190165,31.039178 50.636093,30.210468 50.636093,30.210468 50.190165))","zoom_level":{"min":9,"max":18},"code":"kiev","country_code":"ua","id":"107","type":"region","time_zone":{"name":"Europe/Kiev","offset":180}},{"name":"Киров","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((49.036766 58.400486,49.947791 58.400486,49.947791 58.797004,49.036766 58.797004,49.036766 58.400486))","zoom_level":{"min":9,"max":18},"code":"kirov","country_code":"ru","id":"58","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Комсомольск-на-Амуре","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((136.772704 50.189815,137.258493 50.189815,137.258493 50.721413,136.772704 50.721413,136.772704 50.189815))","zoom_level":{"min":9,"max":18},"code":"komsomolsk","country_code":"ru","id":"94","type":"region","time_zone":{"name":"Asia/Vladivostok","offset":600}},{"name":"Кострома","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((40.721432 57.675732,41.151865 57.675732,41.151865 57.924383,40.721432 57.924383,40.721432 57.675732))","zoom_level":{"min":9,"max":18},"code":"kostroma","country_code":"ru","id":"34","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Краснодар","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((38.650083 44.943556,39.378568 44.943556,39.378568 45.265918,38.650083 45.265918,38.650083 44.943556))","zoom_level":{"min":9,"max":18},"code":"krasnodar","country_code":"ru","id":"23","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Красноярск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((92.126846 55.811406,93.59929 55.811406,93.59929 56.309712,92.126846 56.309712,92.126846 55.811406))","zoom_level":{"min":9,"max":18},"code":"krasnoyarsk","country_code":"ru","id":"7","type":"region","time_zone":{"name":"Asia/Krasnoyarsk","offset":420}},{"name":"Курган","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((65.154662 55.368657,65.48286 55.368657,65.48286 55.530326,65.154662 55.530326,65.154662 55.368657))","zoom_level":{"min":9,"max":18},"code":"kurgan","country_code":"ru","id":"10","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Курск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((35.889369 51.556799,36.435346 51.556799,36.435346 51.842787,35.889369 51.842787,35.889369 51.556799))","zoom_level":{"min":9,"max":18},"code":"kursk","country_code":"ru","id":"73","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Ленинск-Кузнецкий","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((85.750103 54.179404,86.502903 54.179404,86.502903 54.774252,85.750103 54.774252,85.750103 54.179404))","zoom_level":{"min":9,"max":18},"code":"lenkuz","country_code":"ru","id":"86","type":"region","time_zone":{"name":"Asia/Novokuznetsk","offset":420}},{"name":"Липецк","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((39.37448 52.490547,39.82336 52.490547,39.82336 52.719879,39.37448 52.719879,39.37448 52.490547))","zoom_level":{"min":9,"max":18},"code":"lipetsk","country_code":"ru","id":"56","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Магнитогорск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((58.523119 53.229865,59.504226 53.229865,59.504226 53.927025,58.523119 53.927025,58.523119 53.229865))","zoom_level":{"min":9,"max":18},"code":"magnitogorsk","country_code":"ru","id":"26","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Махачкала","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"domain":"ru","bounds":"POLYGON((47.188601 42.792384,47.735875 42.792384,47.735875 43.172712,47.188601 43.172712,47.188601 42.792384))","zoom_level":{"min":9,"max":18},"code":"makhachkala","country_code":"ru","id":"113","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Миасс и Златоуст","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((59.522638 54.888868,60.259069 54.888868,60.259069 55.280896,59.522638 55.280896,59.522638 54.888868))","zoom_level":{"min":9,"max":18},"code":"miass","country_code":"ru","id":"87","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Москва","flags":{"metro":true,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((36.758963 55.104013,38.225024 55.104013,38.225024 56.109465,36.758963 56.109465,36.758963 55.104013))","zoom_level":{"min":9,"max":18},"code":"moscow","country_code":"ru","id":"32","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Мурманск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((32.701158 68.761065,33.225325 68.761065,33.225325 69.064879,32.701158 69.064879,32.701158 68.761065))","zoom_level":{"min":9,"max":18},"code":"murmansk","country_code":"ru","id":"96","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Набережные Челны","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((51.711425 55.536675,52.62818 55.536675,52.62818 55.865183,51.711425 55.865183,51.711425 55.536675))","zoom_level":{"min":9,"max":18},"code":"nabchelny","country_code":"ru","id":"29","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Находка","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((132.750811 42.659764,133.248191 42.659764,133.248191 42.91071,132.750811 42.91071,132.750811 42.659764))","zoom_level":{"min":10,"max":18},"code":"nahodka","country_code":"ru","id":"82","type":"region","time_zone":{"name":"Asia/Vladivostok","offset":600}},{"name":"Нижневартовск","flags":{"metro":false,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((75.922257 60.851181,77.028582 60.851181,77.028582 61.190935,75.922257 61.190935,75.922257 60.851181))","zoom_level":{"min":9,"max":18},"code":"nizhnevartovsk","country_code":"ru","id":"12","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Нижний Новгород","flags":{"metro":true,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((43.297073 56.072236,44.254811 56.072236,44.254811 56.477411,43.297073 56.477411,43.297073 56.072236))","zoom_level":{"min":9,"max":18},"code":"n_novgorod","country_code":"ru","id":"19","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Нижний Тагил","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((59.763185 57.749299,60.347887 57.749299,60.347887 58.091707,59.763185 58.091707,59.763185 57.749299))","zoom_level":{"min":9,"max":18},"code":"ntagil","country_code":"ru","id":"45","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Новокузнецк","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((86.510624 53.497554,87.463657 53.497554,87.463657 54.122366,86.510624 54.122366,86.510624 53.497554))","zoom_level":{"min":9,"max":18},"code":"novokuznetsk","country_code":"ru","id":"6","type":"region","time_zone":{"name":"Asia/Novokuznetsk","offset":420}},{"name":"Новороссийск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((36.936306 44.305963,38.655728 44.305963,38.655728 45.222751,36.936306 45.222751,36.936306 44.305963))","zoom_level":{"min":9,"max":18},"code":"novorossiysk","country_code":"ru","id":"74","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Новосибирск","flags":{"metro":true,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((82.308326 54.38699,83.710544 54.38699,83.710544 55.397846,82.308326 55.397846,82.308326 54.38699))","zoom_level":{"min":9,"max":18},"code":"novosibirsk","country_code":"ru","id":"1","type":"region","time_zone":{"name":"Asia/Novosibirsk","offset":360}},{"name":"Норильск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((85.986318 69.242435,88.551918 69.242435,88.551918 69.559455,85.986318 69.559455,85.986318 69.242435))","zoom_level":{"min":9,"max":18},"code":"norilsk","country_code":"ru","id":"76","type":"region","time_zone":{"name":"Asia/Krasnoyarsk","offset":420}},{"name":"Ноябрьск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((74.30478 63.018251,76.263372 63.018251,76.263372 63.880857,74.30478 63.880857,74.30478 63.018251))","zoom_level":{"min":9,"max":18},"code":"noyabrsk","country_code":"ru","id":"103","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Одесса","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"domain":"ua","bounds":"POLYGON((30.512168 46.253422,30.911286 46.253422,30.911286 46.656718,30.512168 46.656718,30.512168 46.253422))","zoom_level":{"min":9,"max":18},"code":"odessa","country_code":"ua","id":"14","type":"region","time_zone":{"name":"Europe/Kiev","offset":180}},{"name":"Омск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((72.844079 54.78445,73.771665 54.78445,73.771665 55.41764,72.844079 55.41764,72.844079 54.78445))","zoom_level":{"min":9,"max":18},"code":"omsk","country_code":"ru","id":"2","type":"region","time_zone":{"name":"Asia/Omsk","offset":360}},{"name":"Оренбург","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((54.920411 51.663479,55.496231 51.663479,55.496231 51.935975,54.920411 51.935975,54.920411 51.663479))","zoom_level":{"min":9,"max":18},"code":"orenburg","country_code":"ru","id":"48","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Орёл","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((35.85417 52.838995,36.315298 52.838995,36.315298 53.103739,35.85417 53.103739,35.85417 52.838995))","zoom_level":{"min":9,"max":18},"code":"orel","country_code":"ru","id":"71","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Павлодар","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"domain":"kz","bounds":"POLYGON((76.661799 52.006361,77.161213 52.006361,77.161213 52.439519,76.661799 52.439519,76.661799 52.006361))","zoom_level":{"min":9,"max":18},"code":"pavlodar","country_code":"kz","id":"111","type":"region","time_zone":{"name":"Asia/Qyzylorda","offset":360}},{"name":"Пенза","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((44.795477 53.065566,45.35881 53.065566,45.35881 53.349257,44.795477 53.349257,44.795477 53.065566))","zoom_level":{"min":9,"max":18},"code":"penza","country_code":"ru","id":"42","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Пермь","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((55.610475 57.685995,56.66204 57.685995,56.66204 58.243911,55.610475 58.243911,55.610475 57.685995))","zoom_level":{"min":9,"max":18},"code":"perm","country_code":"ru","id":"16","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Петрозаводск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((34.093364 61.691472,34.70885 61.691472,34.70885 61.959477,34.093364 61.959477,34.093364 61.691472))","zoom_level":{"min":9,"max":18},"code":"petrozavodsk","country_code":"ru","id":"80","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Петропавловск-Камчатский","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((158.195687 52.855708,159.025519 52.855708,159.025519 53.349662,158.195687 53.349662,158.195687 52.855708))","zoom_level":{"min":9,"max":18},"code":"p_kamchatskiy","country_code":"ru","id":"95","type":"region","time_zone":{"name":"Asia/Kamchatka","offset":720}},{"name":"Псков","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((28.1635 57.727138,28.491531 57.727138,28.491531 57.889106,28.1635 57.889106,28.1635 57.727138))","zoom_level":{"min":9,"max":18},"code":"pskov","country_code":"ru","id":"90","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Пятигорск (КМВ)","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((42.596866 43.807998,43.530679 43.807998,43.530679 44.305202,42.596866 44.305202,42.596866 43.807998))","zoom_level":{"min":9,"max":18},"code":"minvody","country_code":"ru","id":"89","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Ростов-на-Дону","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((39.356627 47.053314,39.924838 47.053314,39.924838 47.368152,39.356627 47.368152,39.356627 47.053314))","zoom_level":{"min":9,"max":18},"code":"rostov","country_code":"ru","id":"24","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Рязань","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((39.402002 54.487343,39.992113 54.487343,39.992113 54.882191,39.402002 54.882191,39.402002 54.487343))","zoom_level":{"min":9,"max":18},"code":"ryazan","country_code":"ru","id":"44","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Самара","flags":{"metro":true,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((49.777726 53.03905,50.524471 53.03905,50.524471 53.713386,49.777726 53.713386,49.777726 53.03905))","zoom_level":{"min":9,"max":18},"code":"samara","country_code":"ru","id":"18","type":"region","time_zone":{"name":"Europe/Samara","offset":240}},{"name":"Санкт-Петербург","flags":{"metro":true,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((29.41089 59.535262,31.027971 59.535262,31.027971 60.292561,29.41089 60.292561,29.41089 59.535262))","zoom_level":{"min":9,"max":18},"code":"spb","country_code":"ru","id":"38","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Саранск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((44.867017 53.984632,45.511721 53.984632,45.511721 54.301976,44.867017 54.301976,44.867017 53.984632))","zoom_level":{"min":9,"max":18},"code":"saransk","country_code":"ru","id":"85","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Саратов","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((45.730611 51.353163,46.314773 51.353163,46.314773 51.699809,45.730611 51.699809,45.730611 51.353163))","zoom_level":{"min":9,"max":18},"code":"saratov","country_code":"ru","id":"43","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Смоленск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((31.755002 54.687875,32.268673 54.687875,32.268673 54.889311,31.755002 54.889311,31.755002 54.687875))","zoom_level":{"min":9,"max":18},"code":"smolensk","country_code":"ru","id":"63","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Сочи","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((38.93648 43.36325,40.488511 43.36325,40.488511 44.35483,38.93648 44.35483,38.93648 43.36325))","zoom_level":{"min":9,"max":18},"code":"sochi","country_code":"ru","id":"30","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Ставрополь","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((41.658117 44.89293,42.324115 44.89293,42.324115 45.269558,41.658117 45.269558,41.658117 44.89293))","zoom_level":{"min":9,"max":18},"code":"stavropol","country_code":"ru","id":"57","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Старый Оскол","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((37.744862 51.246862,37.982166 51.246862,37.982166 51.377938,37.744862 51.377938,37.744862 51.246862))","zoom_level":{"min":10,"max":18},"code":"staroskol","country_code":"ru","id":"60","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Стерлитамак","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((55.805672 53.302876,56.13283 53.302876,56.13283 53.736987,55.805672 53.736987,55.805672 53.302876))","zoom_level":{"min":9,"max":18},"code":"sterlitamak","country_code":"ru","id":"54","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Сургут","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((72.38176 60.977161,73.797164 60.977161,73.797164 61.408288,72.38176 61.408288,72.38176 60.977161))","zoom_level":{"min":9,"max":18},"code":"surgut","country_code":"ru","id":"39","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Сыктывкар","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((50.431525 61.570342,51.275081 61.570342,51.275081 61.922985,50.431525 61.922985,50.431525 61.570342))","zoom_level":{"min":9,"max":18},"code":"syktyvkar","country_code":"ru","id":"72","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Тамбов","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((41.268899 52.561316,41.602492 52.561316,41.602492 52.841816,41.268899 52.841816,41.268899 52.561316))","zoom_level":{"min":9,"max":18},"code":"tambov","country_code":"ru","id":"81","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Тверь","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((35.531082 56.665594,36.3143 56.665594,36.3143 57.017546,35.531082 57.017546,35.531082 56.665594))","zoom_level":{"min":9,"max":18},"code":"tver","country_code":"ru","id":"47","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Тобольск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((68.027461 58.061137,68.630591 58.061137,68.630591 58.337205,68.027461 58.337205,68.027461 58.061137))","zoom_level":{"min":9,"max":18},"code":"tobolsk","country_code":"ru","id":"97","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Тольятти","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((48.961827 53.028211,49.796735 53.028211,49.796735 53.708125,48.961827 53.708125,48.961827 53.028211))","zoom_level":{"min":9,"max":18},"code":"togliatti","country_code":"ru","id":"22","type":"region","time_zone":{"name":"Europe/Samara","offset":240}},{"name":"Томск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((84.768656 56.348026,85.246532 56.348026,85.246532 56.595694,84.768656 56.595694,84.768656 56.348026))","zoom_level":{"min":9,"max":18},"code":"tomsk","country_code":"ru","id":"3","type":"region","time_zone":{"name":"Asia/Omsk","offset":360}},{"name":"Тула","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((37.414045 53.899539,38.421585 53.899539,38.421585 54.318543,37.414045 54.318543,37.414045 53.899539))","zoom_level":{"min":9,"max":18},"code":"tula","country_code":"ru","id":"36","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Тюмень","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((65.213221 56.397678,66.690851 56.397678,66.690851 57.26989,65.213221 57.26989,65.213221 56.397678))","zoom_level":{"min":9,"max":18},"code":"tyumen","country_code":"ru","id":"13","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Улан-Удэ","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((107.358424 51.691351,107.990789 51.691351,107.990789 52.056483,107.358424 52.056483,107.358424 51.691351))","zoom_level":{"min":9,"max":18},"code":"ulanude","country_code":"ru","id":"37","type":"region","time_zone":{"name":"Asia/Irkutsk","offset":480}},{"name":"Ульяновск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((48.031111 54.105046,48.774421 54.105046,48.774421 54.470724,48.031111 54.470724,48.031111 54.105046))","zoom_level":{"min":9,"max":18},"code":"ulyanovsk","country_code":"ru","id":"55","type":"region","time_zone":{"name":"Europe/Ulyanovsk","offset":240}},{"name":"Уссурийск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((131.749241 43.708079,132.142052 43.708079,132.142052 43.971877,131.749241 43.971877,131.749241 43.708079))","zoom_level":{"min":9,"max":18},"code":"ussuriysk","country_code":"ru","id":"83","type":"region","time_zone":{"name":"Asia/Vladivostok","offset":600}},{"name":"Усть-Каменогорск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":false},"domain":"kz","bounds":"POLYGON((82.444837 49.857959,82.805717 49.857959,82.805717 50.059192,82.444837 50.059192,82.444837 49.857959))","zoom_level":{"min":9,"max":18},"code":"ustkam","country_code":"kz","id":"91","type":"region","time_zone":{"name":"Asia/Qyzylorda","offset":360}},{"name":"Уфа","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((55.71509 54.478524,56.312416 54.478524,56.312416 54.957284,55.71509 54.957284,55.71509 54.478524))","zoom_level":{"min":9,"max":18},"code":"ufa","country_code":"ru","id":"17","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Хабаровск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((134.873582 48.288578,135.259036 48.288578,135.259036 48.607104,134.873582 48.607104,134.873582 48.288578))","zoom_level":{"min":9,"max":18},"code":"khabarovsk","country_code":"ru","id":"35","type":"region","time_zone":{"name":"Asia/Vladivostok","offset":600}},{"name":"Харьков","flags":{"metro":true,"has_net_booklet":true,"public_transport":true,"flamp":false,"road_network":true},"domain":"ua","bounds":"POLYGON((36.031103 49.835534,36.481687 49.835534,36.481687 50.125456,36.031103 50.125456,36.031103 49.835534))","zoom_level":{"min":9,"max":18},"code":"kharkov","country_code":"ua","id":"110","type":"region","time_zone":{"name":"Europe/Kiev","offset":180}},{"name":"Чебоксары","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((46.989585 55.980845,47.60576 55.980845,47.60576 56.342026,46.989585 56.342026,46.989585 55.980845))","zoom_level":{"min":9,"max":18},"code":"cheboksary","country_code":"ru","id":"53","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}},{"name":"Челябинск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"traffic":true,"road_network":true},"domain":"ru","bounds":"POLYGON((61.185486 54.990462,61.74458 54.990462,61.74458 55.319826,61.185486 55.319826,61.185486 54.990462))","zoom_level":{"min":9,"max":18},"code":"chelyabinsk","country_code":"ru","id":"15","type":"region","time_zone":{"name":"Asia/Yekaterinburg","offset":300}},{"name":"Чита","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((113.102113 51.926502,113.639184 51.926502,113.639184 52.186114,113.102113 52.186114,113.102113 51.926502))","zoom_level":{"min":9,"max":18},"code":"chita","country_code":"ru","id":"64","type":"region","time_zone":{"name":"Asia/Chita","offset":540}},{"name":"Южно-Сахалинск","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((142.44768 46.583209,142.971757 46.583209,142.971757 47.515634,142.44768 47.515634,142.44768 46.583209))","zoom_level":{"min":9,"max":18},"code":"yuzhnosakhalinsk","country_code":"ru","id":"88","type":"region","time_zone":{"name":"Asia/Sakhalin","offset":660}},{"name":"Якутск","flags":{"metro":false,"has_net_booklet":true,"public_transport":true,"flamp":true,"road_network":true},"domain":"ru","bounds":"POLYGON((129.525802 61.800501,129.992303 61.800501,129.992303 62.187831,129.525802 62.187831,129.525802 61.800501))","zoom_level":{"min":9,"max":18},"code":"yakutsk","country_code":"ru","id":"50","type":"region","time_zone":{"name":"Asia/Yakutsk","offset":540}},{"name":"Ярославль","flags":{"public_transport":true,"metro":false,"road_network":true,"flamp":true},"domain":"ru","bounds":"POLYGON((39.717841 57.519309,40.012883 57.519309,40.012883 57.776199,39.717841 57.776199,39.717841 57.519309))","zoom_level":{"min":9,"max":18},"code":"yaroslavl","country_code":"ru","id":"28","type":"region","time_zone":{"name":"Europe/Moscow","offset":180}}]'),
DG.config={host:null,port:3e3,defaultSkin:"dark",defaultLang:"ru",trafficLayerMinZoom:10,trafficLayerUpdateInterval:3e5,ppnotLink:"http://2gis.{domain}/{projectCode}/center/{center}/zoom/{zoom}/routeTab/rsType/{rsType}/to/{point}╎{name}",photosLink:"http://2gis.{domain}/photos/{id}",poiLayerMinZoom:11,detectRetina:!0,webApiKey:"ruregt3044",webApiVersion:"2.0",regionListFields:"items.bounds,items.zoom_level,items.time_zone,items.code,items.flags,items.country_code,items.domain",firmInfoFields:"items.reviews,items.photos,items.links,items.external_content",geoAdditionalFields:"items.geometry.selection,items.links,items.adm_div,items.address,items.floors,items.description",geoclickerCatalogApiKey:"ruregt3044",projectLeaveMaxZoom:13,flampUrl:"http://flamp.ru/r/",flampGoogleAnalytics:"utm_source=api2gis&utm_medium=api&utm_campaign=geoclicker",gaCode:"UA-38243181-2",protocol:"http:",baseUrl:"//maps.api.2gis.ru/2.0",tileServer:"//tile{s}.maps.2gis.com/tiles?x={x}&y={y}&z={z}&v=1",trafficTileServer:"//traffic{s}.maps.2gis.com/{projectCode}/traffic/{z}/{x}/{y}/speed/{period}/{timestampString}",trafficMetaServer:"//meta{s}.maps.2gis.com/{projectCode}/meta/{z}/{x}/{y}/graph_speed/{period}/{timestampString}",trafficTimestampServer:"//traffic{s}.maps.2gis.com/{projectCode}/meta/speed/time/",trafficScoreServer:"//traffic{s}.maps.2gis.com/{projectCode}/meta/score/0/",poiMetaServer:"//tile{s}.maps.2gis.com/?x={x}&y={y}&z={z}&v=1&type=poi",webApiServer:"//catalog.api.2gis.ru",analytics:"//maps.api.2gis.ru/analytics/track-user.png",googleAnalytics:"//www.google-analytics.com/analytics.js",loadProjectListTimeout:5e3}}(this,document);